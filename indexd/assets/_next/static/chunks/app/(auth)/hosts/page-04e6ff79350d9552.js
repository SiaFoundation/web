(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3162],{49126:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>G});var t=s(54568),a=s(2720),i=s(7620),n=s(45711),r=s(50257),c=s(37968),o=s(61242),d=s(48432),u=s(45027),m=s(84684),j=s(79423);function x(e){let{hosts:l}=e,s=(0,o.Aq)(),n=(0,m.ej)(),r=(0,i.useCallback)(async()=>{let{error:e}=await s.put({payload:{hostKeys:l.map(e=>"publicKey"in e?e.publicKey:e.original.publicKey),reason:"blocked by user"}});e?(0,a.el3)({title:"Error blocking hosts",body:e}):(0,a.VE1)({title:"Blocked ".concat((0,d.td)(l.length,"host"))}),await n(e=>e.startsWith(u.qQ))},[l,s,n]);return(0,t.jsxs)(a.$nd,{onClick:r,children:[(0,t.jsx)(j.mC5,{}),"Block ",1===l.length?"host":"hosts"]})}function h(e){let{hosts:l}=e,s=(0,o.SK)(),n=(0,m.ej)(),r=(0,i.useCallback)(async()=>{await (0,a.qBJ)(l.map(e=>s.delete({params:{hostkey:"publicKey"in e?e.publicKey:e.original.publicKey}})),{toastError:e=>{let{successCount:l,errorCount:s,totalCount:t}=e;return{title:"Unblocked ".concat((0,d.td)(l,"host")),body:"Error unblocking ".concat(s,"/").concat(t," of total hosts.")}},toastSuccess:e=>{let{totalCount:l}=e;return{title:"Unblocked ".concat((0,d.td)(l,"host"))}}}),await n(e=>e.startsWith(u.qQ))},[l,s,n]);return(0,t.jsxs)(a.$nd,{onClick:r,children:[(0,t.jsx)(j.d5v,{}),"Unblock ",1===l.length?"host":"hosts"]})}var g=s(92517),b=s(80870);function y(){let e=(0,a.i$h)("hostList"),[l,s]=(0,a.QPA)("hostsPanelId");return{...e,panelId:l,setPanelId:s}}var p=s(78633),f=s(79513);function v(){let{panelId:e,setPanelId:l}=y(),s=(0,b.K)(e),o=(0,i.useMemo)(()=>{var e;return s.data&&(null==(e=s.data)?void 0:e.location.countryCode)!=="unknown"?{id:s.data.id,publicKey:s.data.publicKey,location:s.data.location,v2Settings:s.data.settings,usable:s.data.usable}:null},[s]);return(0,t.jsx)(a.BQi,{data:s,loading:(0,t.jsx)(f.P,{withMap:!0,withActions:!0,onClose:()=>l(void 0)}),notFound:(0,t.jsx)(c.w,{heading:null,children:(0,t.jsx)("div",{className:"flex justify-center pt-[50px]",children:(0,t.jsx)(a.EYj,{color:"subtle",children:"Host not found"})})}),loaded:s=>{var i,d;return(0,t.jsxs)(c.w,{onClose:()=>l(void 0),heading:s?(0,t.jsx)(p.R,{heading:(0,t.jsx)(a.EYj,{size:"18",weight:"medium",ellipsis:!0,children:(null==(i=s.location)?void 0:i.countryCode)?(0,t.jsx)("span",{className:"pr-1",children:(0,t.jsx)(a.J93,{countryCode:null==(d=s.location)?void 0:d.countryCode})}):null}),value:s.addresses[0].address,label:"host"}):null,actions:s?s.blocked?(0,t.jsx)(h,{hosts:[s]}):(0,t.jsx)(x,{hosts:[s]}):null,children:[(0,t.jsx)(a.hz$,{hosts:o?[o]:[],activeHost:o,onHostMapClick:()=>null,scale:180,mapClassName:"-mt-[20px]"},e),(0,t.jsx)(g.V,{heading:"Addresses",children:(0,t.jsx)("div",{className:"flex flex-col gap-2",children:s.addresses.map(e=>(0,t.jsx)(r.B,{label:e.protocol,value:(0,t.jsx)(a.Zjd,{value:e.address,maxLength:24})},e.address+e.protocol))})}),(0,t.jsx)(g.V,{heading:"Usability",children:(0,t.jsx)(n.fz,{usable:s.usable,usability:s.usability,className:"w-full overflow-hidden flex-wrap"})})]})}})}var P=s(39263);function N(e){let{table:l}=e,{setPanelId:s}=y(),n=(0,i.useMemo)(()=>l.isSelection?l.selectedRows:l.rows,[l.isSelection,l.selectedRows,l.rows]),r=(0,P.V)({hosts:n.map(e=>e.original)});return(0,t.jsx)(c.w,{customCloseAction:l.isSelection?(0,t.jsx)(a.$nd,{onClick:()=>l.setRowSelection({}),children:"Clear selection"}):null,actions:l.isSelection?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{hosts:n}),(0,t.jsx)(h,{hosts:n})]}):null,heading:(0,t.jsx)(a.EYj,{size:"18",weight:"medium",children:l.isSelection?"Selected hosts (".concat(n.length,")"):l.isFiltered?"Filtered hosts (".concat(n.length,")"):"All hosts"}),children:(0,t.jsx)(a.hz$,{hosts:r,activeHost:null,onHostMapClick:e=>s(e),scale:180,mapClassName:"-mt-[20px]"})})}var k=s(16326),C=s(65473);function E(){let{columnFilters:e,setColumnFilters:l}=y();return(0,t.jsx)(C.h,{id:"usable",labelPositive:"Usable",labelNegative:"Unusable",columnFilters:e,setColumnFilters:l})}function F(){let{columnFilters:e,setColumnFilters:l}=y();return(0,t.jsx)(C.h,{id:"blocked",labelPositive:"Blocked",labelNegative:"Not Blocked",columnFilters:e,setColumnFilters:l})}var S=s(68340),A=s(71564);let w=[(0,S.p)(),{id:"publicKey",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,className:"justify-start",children:"Public Key"})},cell:e=>{let{row:l}=e;return(0,t.jsx)(a.Zjd,{maxLength:100,value:l.original.id,type:"hostPublicKey"})},meta:{...A.pC}},{id:"usable",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,className:"justify-start",filter:(0,t.jsx)(E,{}),children:"Usable"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(a.m_M,{content:l.original.usable?"host is usable":"host is unusable",children:l.original.usable?(0,t.jsx)(j.Voo,{className:"text-green-500"}):(0,t.jsx)(j.g$$,{className:"text-red-500"})}),(0,t.jsx)(n.fz,{usable:l.original.usable,usability:l.original.usability})]})},meta:{...A.xl,filterLabelPositive:"Usable",filterLabelNegative:"Unusable"}},{id:"blocked",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,className:"justify-start",filter:(0,t.jsx)(F,{}),children:"Blocked"})},cell:e=>{let{row:l}=e,s=l.original.blocked;return(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(a.m_M,{content:s?"host is blocked":"host is not blocked",children:s?(0,t.jsx)(j.g$$,{className:"text-red-500"}):(0,t.jsx)(j.Voo,{className:"text-neutral-300 dark:text-neutral-500"})}),s&&(0,t.jsx)(a.Exy,{size:"small",className:"ml-1",children:l.original.blockedReason})]})},meta:{className:"justify-start",...A.RQ,filterLabelPositive:"Blocked",filterLabelNegative:"Not Blocked"}},{id:"acceptingContracts",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Accepting Contracts"})},cell:e=>{let{row:l}=e;return(0,t.jsx)("div",{className:"flex items-center justify-end gap-1",children:(0,t.jsx)(n.Wd,{status:l.original.usability.acceptingContracts?"usable":"unusable",name:"accepting contracts"})})},meta:{className:"justify-end",...A.E}},{id:"uptime",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Uptime"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.uptime?"usable":"unusable",name:"recent uptime"}),(0,t.jsx)(a.EYj,{children:l.original.displayFields.uptime})]})},meta:{className:"justify-end",...A.E}},{id:"location",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Location"})},cell:e=>{let{row:l}=e;return"unknown"===l.original.location.countryCode?(0,t.jsx)("div",{className:"py-1",children:(0,t.jsx)(a.EYj,{color:"verySubtle",children:"-"})}):(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsx)("span",{role:"img","aria-label":l.original.displayFields.countryName,children:l.original.displayFields.countryFlag}),(0,t.jsx)(a.EYj,{className:"ml-1",children:l.original.location.countryCode})]})},meta:{className:"justify-end",...A.E}},{id:"totalStorage",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Total Storage"})},cell:e=>{let{row:l}=e;return(0,t.jsx)(a.EYj,{children:l.original.displayFields.totalStorage})},meta:{className:"justify-end",...A.E}},{id:"remainingStorage",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Remaining Storage"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.displayFields.remainingStorageUsability,name:"storage"}),(0,t.jsx)(a.EYj,{children:l.original.displayFields.remainingStorage})]})},meta:{className:"justify-end",...A.E}},{id:"storagePrice",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Price Storage"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.storagePrice?"usable":"unusable",name:"storage price"}),(0,t.jsx)(a.Pni,{...l.original.displayFields.storagePrice})]})},meta:{className:"justify-end",...A.E}},{id:"ingressPrice",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Ingress/TB"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.ingressPrice?"usable":"unusable",name:"ingress price"}),(0,t.jsx)(a.Pni,{...l.original.displayFields.ingressPrice})]})},meta:{className:"justify-end",...A.E}},{id:"egressPrice",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Egress/TB"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.egressPrice?"usable":"unusable",name:"egress price"}),(0,t.jsx)(a.Pni,{...l.original.displayFields.egressPrice})]})},meta:{className:"justify-end",...A.E}},{id:"freeSectorPrice",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Free Sector Price"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.freeSectorPrice?"usable":"unusable",name:"free sector price"}),(0,t.jsx)(a.Pni,{...l.original.displayFields.freeSectorPrice})]})},meta:{className:"justify-end",...A.E}},{id:"maxContractDuration",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Max Contract Duration"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.maxContractDuration?"usable":"unusable",name:"max contract duration"}),(0,t.jsx)(a.EYj,{children:l.original.displayFields.maxContractDuration})]})},meta:{className:"justify-end",...A.sz}},{id:"maxCollateral",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Max Collateral"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.maxCollateral?"usable":"unusable",name:"max collateral"}),(0,t.jsx)(a.Pni,{...l.original.displayFields.maxCollateral})]})},meta:{className:"justify-end",...A.E}},{id:"protocolVersion",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Protocol Version"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.protocolVersion?"usable":"unusable",name:"protocol version"}),(0,t.jsx)(a.EYj,{children:l.original.displayFields.protocolVersion})]})},meta:{className:"justify-end",...A.E}},{id:"priceValidity",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Price Validity"})},cell:e=>{let{row:l}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)(n.Wd,{status:l.original.usability.priceValidity?"usable":"unusable",name:"price validity"}),(0,t.jsx)(a.EYj,{children:l.original.displayFields.priceValidity})]})},meta:{className:"justify-end",...A.XK}},{id:"release",header:e=>{let{table:l,column:s}=e;return(0,t.jsx)(k.A,{table:l,column:s,children:"Release"})},cell:e=>{let{row:l}=e;return(0,t.jsx)(a.EYj,{children:l.original.displayFields.release})},meta:{className:"justify-end",minWidth:160,maxWidth:160}}];var K=s(97944),B=s(46826),W=s(81477),U=s(45614);function V(e){switch(e.id){case"usable":return e.value?"Usable":"Unusable";case"blocked":return e.value?"Blocked":"Not Blocked";case"activecontracts":return e.value?"Active Contracts":"No Active Contracts";default:return""}}let $={namespace:"hosts/filterUsable",label:"Hosts filter by usable"},L=[{id:"usable",value:!0},{id:"usable",value:!1}];function Y(e){let{select:l,currentPage:s}=e;return(0,t.jsx)(U.L$,{currentPage:s,commandPage:$,children:L.map(e=>(0,t.jsx)(U.n7,{currentPage:s,commandPage:$,onSelect:()=>{l(e)},children:V(e)},e.id+e.value))})}let M={namespace:"hosts/filterBlocked",label:"Hosts filter by blocked"},H=[{id:"blocked",value:!0},{id:"blocked",value:!1}];function Q(e){let{select:l,currentPage:s}=e;return(0,t.jsx)(U.L$,{currentPage:s,commandPage:M,children:H.map(e=>(0,t.jsx)(U.n7,{currentPage:s,commandPage:M,onSelect:()=>{l(e)},children:V(e)},e.id+e.value))})}let z={namespace:"hosts/filterActiveContracts",label:"Hosts filter by active contracts"},R=[{id:"activecontracts",value:!0},{id:"activecontracts",value:!1}];function _(e){let{select:l,currentPage:s}=e;return(0,t.jsx)(U.L$,{currentPage:s,commandPage:z,children:R.map(e=>(0,t.jsx)(U.n7,{currentPage:s,commandPage:z,onSelect:()=>{l(e)},children:V(e)},e.id+e.value))})}function I(e){let{currentPage:l,select:s}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y,{currentPage:l,select:s}),(0,t.jsx)(Q,{currentPage:l,select:s}),(0,t.jsx)(_,{currentPage:l,select:s})]})}let q={namespace:"hosts",label:"Hosts"};function D(e){let{currentPage:l,parentPage:s,pushPage:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Iu,{currentPage:l,parentPage:s,commandPage:q,onSelect:()=>{a($)},children:$.label}),(0,t.jsx)(U.Iu,{currentPage:l,parentPage:s,commandPage:q,onSelect:()=>{a(M)},children:M.label}),(0,t.jsx)(U.Iu,{currentPage:l,parentPage:s,commandPage:q,onSelect:()=>{a(z)},children:z.label})]})}function O(e){let{currentPage:l,parentPage:s,pushPage:a,beforeSelect:n,afterSelect:r}=e,{addColumnFilter:c}=y(),o=(0,i.useCallback)(e=>{n&&n(),c(e),r&&r()},[c,n,r]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{parentPage:s,currentPage:l,pushPage:a,select:o}),(0,t.jsx)(I,{currentPage:l,select:o})]})}var T=s(86151);function J(){let{columnFilters:e,removeColumnFilter:l,removeLastColumnFilter:s}=y();return(0,t.jsx)(T.W,{name:"hosts",columnFilters:e,removeColumnFilter:l,removeLastColumnFilter:s,getFilterLabel:V,children:e=>{let{currentPage:l,beforeSelect:s,afterSelect:a,pushPage:i}=e;return(0,t.jsx)(O,{currentPage:l,beforeSelect:s,afterSelect:a,pushPage:i})}})}function Z(){let{panelId:e,setPanelId:l,columnFilters:s,setColumnFilters:n,columnSorts:r,setColumnSorts:c,offset:d,limit:u,setOffset:j,setLimit:x}=y(),h=(0,i.useCallback)(e=>{l(e)},[l]),g=function(){let e=(0,B.O)(),{columnFilters:l,offset:s,limit:t}=y(),n=(0,i.useMemo)(()=>{var e,a,i;let n={offset:s,limit:t},r=null==(e=l.find(e=>"usable"===e.id))?void 0:e.value;void 0!==r&&(n.usable=r);let c=null==(a=l.find(e=>"blocked"===e.id))?void 0:a.value;void 0!==c&&(n.blocked=c);let o=null==(i=l.find(e=>"activecontracts"===e.id))?void 0:i.value;return void 0!==o&&(n.activecontracts=o),n},[l,s,t]),r=(0,o.As)({params:n}),c=(0,a.sAn)(),{settings:d}=(0,m.IQ)();return(0,a.sEt)({hosts:r},l=>{let{hosts:s}=l;return s.map(l=>{var s,t;let a=null==(t=e.data)||null==(s=t.find(e=>e.publicKey===l.publicKey))?void 0:s.location;return(0,K.d)({host:l,location:a,currencyDisplay:d.currencyDisplay,exchange:c.currency&&c.rate&&{currency:c.currency,rate:c.rate}})})},{offset:s,filters:l})}(),b=(0,a.uIQ)({dataset:g,columns:w,columnFilters:s,columnSorts:r,setColumnSorts:c,setColumnFilters:n,offset:d,limit:u,onRowClick:h,setOffset:j,setLimit:x});return(0,t.jsx)(W.P,{table:(0,t.jsx)(a.bQt,{...b,header:(0,t.jsx)(J,{}),noneOnPage:(0,t.jsx)(a.GB$,{message:"No hosts on this page, reset pagination to continue."}),noneYet:(0,t.jsx)(a.QOE,{message:"There are no hosts in the database."}),noneMatchingFilters:(0,t.jsx)(a.hpd,{message:"No hosts matching filters."}),error:(0,t.jsx)(a.qq6,{message:"Error loading hosts. Please try again later."})}),panel:e?(0,t.jsx)(v,{}):(0,t.jsx)(N,{table:b})})}function G(){return(0,t.jsx)(Z,{})}},66743:(e,l,s)=>{Promise.resolve().then(s.bind(s,49126))}},e=>{e.O(0,[9085,9030,5764,6017,2826,7421,8820,224,2550,5465,9589,751,7722,1144,4082,6712,1551,2273,9557,4114,7939,5312,1213,947,2991,8900,6322,1893,3995,2720,1319,587,18,7358],()=>e(e.s=66743)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5462],{14317:(e,r,i)=>{Promise.resolve().then(i.bind(i,95212))},44358:(e,r,i)=>{"use strict";i.d(r,{sG:()=>S,UK:()=>j});var t=i(54568),n=i(7620),a=i(83445),o=i(34475),s=i(92348);let c={wantedContracts:void 0,periodWeeks:void 0,renewWindowWeeks:void 0,maxEgressPriceTB:void 0,maxIngressPriceTB:void 0,maxStoragePriceTBMonth:void 0,minCollateral:void 0,minProtocolVersion:void 0,pinnedCurrency:"",shouldPinMaxStoragePrice:!1,maxStoragePriceTBMonthPinned:void 0,shouldPinMaxEgressPrice:!1,maxEgressPriceTBPinned:void 0,shouldPinMaxIngressPrice:!1,maxIngressPriceTBPinned:void 0,shouldPinMinCollateral:!1,minCollateralPinned:void 0};function l(e){let{contracts:r,hosts:i,pricePinning:t}=e;return{...function(e){let r=new s.A((0,o.bu)(e.period));return{periodWeeks:r,renewWindowWeeks:new s.A((0,o.bu)(e.renewWindow)),wantedContracts:new s.A(e.wantedContracts)}}(r),...{maxStoragePriceTBMonth:(0,o.V$)((0,o.GG)(new s.A(i.maxStoragePrice)),6),maxIngressPriceTB:(0,o.V$)((0,o.BH)(new s.A(i.maxIngressPrice)),6),maxEgressPriceTB:(0,o.V$)((0,o.BH)(new s.A(i.maxEgressPrice)),6),minCollateral:(0,o.V$)(new s.A(i.minCollateral),6),minProtocolVersion:i.minProtocolVersion.join(".")},...{pinnedCurrency:t.currency,shouldPinMaxStoragePrice:!!t.maxStoragePrice,maxStoragePriceTBMonthPinned:new s.A(t.maxStoragePrice),shouldPinMaxIngressPrice:!!t.maxIngressPrice,maxIngressPriceTBPinned:new s.A(t.maxIngressPrice),shouldPinMaxEgressPrice:!!t.maxEgressPrice,maxEgressPriceTBPinned:new s.A(t.maxEgressPrice),shouldPinMinCollateral:!!t.minCollateral,minCollateralPinned:new s.A(t.minCollateral)}}}var d=i(26109),u=i(46682),g=i(62435);function m(e){let{contracts:r,hosts:i,pricePinning:t}=e;return!!r.data&&!r.error&&!!i.data&&!i.error&&!!t.data&&!t.error&&e}var h=i(61938);function p(e){let r=e.watch("pinnedCurrency"),{rate:i}=(0,a.Q7e)({currency:r||void 0});return{rate:i,pinnedCurrency:r}}function P(){var e,r,i;let t=(0,a.OrM)({config:{swr:{revalidateOnFocus:!1}}}),c=null==(e=t.data)?void 0:e.v2Settings.prices.storagePrice,l=null==(r=t.data)?void 0:r.v2Settings.prices.ingressPrice,d=null==(i=t.data)?void 0:i.v2Settings.prices.egressPrice,u=(0,n.useMemo)(()=>c?new s.A((0,o.GG)((0,o.V$)(c)).toFixed(0)):void 0,[c]),g=(0,n.useMemo)(()=>l?new s.A((0,o.BH)((0,o.V$)(l)).toFixed(0)):void 0,[l]),m=(0,n.useMemo)(()=>d?new s.A((0,o.BH)((0,o.V$)(d)).toFixed(0)):void 0,[d]);return(0,n.useMemo)(()=>u&&g&&m?{storageMedian:u,ingressMedian:g,egressMedian:m}:{},[u,g,m])}function x(e){let{form:r,fields:i}=e,{storageMedian:n}=P();return(0,t.jsx)(t.Fragment,{children:n&&(0,t.jsx)(a.jQb,{type:"siacoin",label:"Network median price",tip:"Data provided by SiaScan.",decimalsLimit:0,value:(0,o.zh)(n),onClick:()=>{(0,a.ve2)({form:r,fields:i,name:"maxStoragePriceTBMonth",value:n,options:!0})}})})}function v(e){let{form:r,fields:i}=e,{storageMedian:n}=P(),{rate:s}=p(r);return(0,t.jsx)(t.Fragment,{children:n&&s&&(0,t.jsx)(a.jQb,{type:"siacoin",label:"Network median price",tip:"Data provided by SiaScan.",decimalsLimit:0,value:(0,o.zh)(n),onClick:()=>{(0,a.ve2)({form:r,fields:i,name:"maxStoragePriceTBMonthPinned",value:n.times(s),options:!0})}})})}function f(e){let{form:r,fields:i}=e,{ingressMedian:n}=P();return(0,t.jsx)(t.Fragment,{children:n&&(0,t.jsx)(a.jQb,{type:"siacoin",label:"Network median price",tip:"Data provided by SiaScan.",decimalsLimit:0,value:(0,o.zh)(n),onClick:()=>{(0,a.ve2)({form:r,fields:i,name:"maxIngressPriceTB",value:n,options:!0})}})})}function y(e){let{form:r,fields:i}=e,{rate:n}=p(r),{ingressMedian:s}=P();return(0,t.jsx)(t.Fragment,{children:s&&n&&(0,t.jsx)(a.jQb,{type:"siacoin",label:"Network median price",tip:"Data provided by SiaScan.",decimalsLimit:0,value:(0,o.zh)(s),onClick:()=>{(0,a.ve2)({form:r,fields:i,name:"maxIngressPriceTBPinned",value:s.times(n),options:!0})}})})}function w(e){let{form:r,fields:i}=e,{egressMedian:n}=P();return(0,t.jsx)(t.Fragment,{children:n&&(0,t.jsx)(a.jQb,{type:"siacoin",label:"Network median price",tip:"Data provided by SiaScan.",decimalsLimit:0,value:(0,o.zh)(n),onClick:()=>{(0,a.ve2)({form:r,fields:i,name:"maxEgressPriceTB",value:n,options:!0})}})})}function M(e){let{form:r,fields:i}=e,{rate:n}=p(r),{egressMedian:s}=P();return(0,t.jsx)(t.Fragment,{children:s&&n&&(0,t.jsx)(a.jQb,{type:"siacoin",label:"Network median price",tip:"Data provided by SiaScan.",decimalsLimit:0,value:(0,o.zh)(s),onClick:()=>{(0,a.ve2)({form:r,fields:i,name:"maxEgressPriceTBPinned",value:s.times(n),options:!0})}})})}function b(e,r){return(i,t)=>!t[e]||(r?r(i,t):!!i||"required")}let C=(0,n.createContext)({}),j=()=>(0,n.useContext)(C);function S(e){let{children:r}=e,i=function(){let{hosts:e,contracts:r,pricePinning:i,resources:p}=function(){let e=(0,u.aE)({config:{swr:{refreshInterval:(0,o.Po)(1)}}}),r=(0,u.eY)({config:{swr:{refreshInterval:(0,o.Po)(1)}}}),i=(0,u.R7)({config:{swr:{refreshInterval:(0,o.Po)(1)}}});return{resources:(0,n.useMemo)(()=>({contracts:{data:e.data,error:e.error},hosts:{data:r.data,error:r.error},pricePinning:{data:i.data,error:i.error}}),[e.data,e.error,r.data,r.error,i.data,i.error]),contracts:e,hosts:r,pricePinning:i}}(),{form:P,fields:C}=function(){let e=(0,h.mN)({mode:"all",defaultValues:c}),r=e.watch("maxStoragePriceTBMonth"),i=e.watch("maxEgressPriceTB"),a=e.watch("maxIngressPriceTB");return{form:e,fields:(0,n.useMemo)(()=>({wantedContracts:{type:"number",category:"contracts",title:"Wanted contracts",description:(0,t.jsx)(t.Fragment,{children:"The number of contracts you would like to have."}),units:"contracts",validation:{required:"required"}},periodWeeks:{type:"number",category:"contracts",title:"Period",description:(0,t.jsx)(t.Fragment,{children:"The length of the storage contracts."}),units:"weeks",suggestion:new s.A(6),suggestionTip:"Typically 6 weeks.",validation:{required:"required"}},renewWindowWeeks:{type:"number",category:"contracts",title:"Renew window",description:(0,t.jsx)(t.Fragment,{children:"The number of weeks prior to contract expiration that Sia will attempt to renew your contracts."}),units:"weeks",decimalsLimit:6,suggestion:new s.A(2),suggestionTip:"Typically 2 weeks.",validation:{required:"required"}},shouldPinMaxStoragePrice:{title:"",description:"",type:"boolean",category:"pricing",validation:{}},maxStoragePriceTBMonth:{category:"pricing",type:"siacoin",title:"Max storage price",description:(0,t.jsx)(t.Fragment,{children:"The max allowed price a host is allowed to charge to store 1 TB worth of data per month. Choose whether to set the price in siacoin per TB per month or to pin the siacoin price to a fixed fiat value per TB per month."}),units:"SC/TB/month",decimalsLimitSc:6,validation:{required:"required"},after:e=>{let{form:r,fields:i}=e;return(0,t.jsx)(x,{form:r,fields:i})}},maxStoragePriceTBMonthPinned:{title:"",description:"",units:"/TB/month",type:"fiat",category:"pricing",validation:{validate:{required:b("shouldPinMaxStoragePrice",(e,r)=>!r.shouldPinMaxStoragePrice||!!e||"required"),currency:b("shouldPinMaxStoragePrice",(e,r)=>!!r.pinnedCurrency||"must select a pinned currency"),range:b("shouldPinMaxStoragePrice",(e,r)=>!r.shouldPinMaxStoragePrice||(null==e?void 0:e.gt(0))||"must be greater than 0")}},after:e=>{let{form:r,fields:i}=e;return(0,t.jsx)(v,{form:r,fields:i})}},shouldPinMaxIngressPrice:{title:"",description:"",type:"boolean",category:"pricing",validation:{}},maxIngressPriceTB:{category:"pricing",type:"siacoin",title:"Max ingress price",description:(0,t.jsx)(t.Fragment,{children:"The max allowed price a host is allowed to charge for uploading 1 TB worth of data. Choose whether to set the price in siacoin per TB or to pin the siacoin price to a fixed fiat value per TB."}),units:"SC/TB",decimalsLimitSc:6,validation:{required:"required"},after:e=>{let{form:r,fields:i}=e;return(0,t.jsx)(f,{form:r,fields:i})}},maxIngressPriceTBPinned:{title:"",description:"",units:"/TB",type:"fiat",category:"pricing",validation:{validate:{required:b("shouldPinMaxIngressPrice",(e,r)=>!r.shouldPinMaxIngressPrice||!!e||"required"),currency:b("shouldPinMaxIngressPrice",(e,r)=>!!r.pinnedCurrency||"must select a pinned currency"),range:b("shouldPinMaxIngressPrice",(e,r)=>!r.shouldPinMaxIngressPrice||(null==e?void 0:e.gt(0))||"must be greater than 0")}},after:e=>{let{form:r,fields:i}=e;return(0,t.jsx)(y,{form:r,fields:i})}},shouldPinMaxEgressPrice:{title:"",description:"",type:"boolean",category:"pricing",validation:{}},maxEgressPriceTB:{category:"pricing",type:"siacoin",title:"Max egress price",description:(0,t.jsx)(t.Fragment,{children:"The max allowed price to download 1 TB. Choose whether to set the price in siacoin per TB or to pin the siacoin price to a fixed fiat value per TB."}),units:"SC/TB",decimalsLimitSc:6,validation:{required:"required"},after:e=>{let{form:r,fields:i}=e;return(0,t.jsx)(w,{form:r,fields:i})}},maxEgressPriceTBPinned:{title:"",description:"",units:"/TB",type:"fiat",category:"pricing",validation:{validate:{required:b("shouldPinMaxEgressPrice",(e,r)=>!r.shouldPinMaxEgressPrice||!!e||"required"),currency:b("shouldPinMaxEgressPrice",(e,r)=>!!r.pinnedCurrency||"must select a pinned currency"),range:b("shouldPinMaxEgressPrice",(e,r)=>!r.shouldPinMaxEgressPrice||(null==e?void 0:e.gt(0))||"must be greater than 0")}},after:e=>{let{form:r,fields:i}=e;return(0,t.jsx)(M,{form:r,fields:i})}},shouldPinMinCollateral:{title:"",description:"",type:"boolean",category:"pricing",validation:{}},minCollateral:{category:"pricing",type:"siacoin",title:"Min collateral",description:(0,t.jsx)(t.Fragment,{children:"The min allowed collateral a contract must have. Choose whether to set the collateral in siacoin or to pin the collateral to a fixed fiat value."}),units:"SC",decimalsLimitSc:6,validation:{required:"required"}},minCollateralPinned:{title:"",description:"",type:"fiat",category:"pricing",validation:{validate:{required:b("shouldPinMinCollateral",(e,r)=>!r.shouldPinMinCollateral||!!e||"required"),currency:b("shouldPinMinCollateral",(e,r)=>!!r.pinnedCurrency||"must select a pinned currency"),range:b("shouldPinMinCollateral",(e,r)=>!r.shouldPinMinCollateral||(null==e?void 0:e.gt(0))||"must be greater than 0")}}},pinnedCurrency:{category:"pricing",title:"Pinned currency",description:"Currency to use for fields where price pinning is enabled.",type:"select",options:[...d.Ib.map(e=>{let{id:r,label:i}=e;return{label:i,value:r}}),{label:"none",value:""}],validation:{required:"required"}},minProtocolVersion:{category:"other",type:"text",title:"Min protocol version",description:"The minimum protocol version to accept contracts.",validation:{validate:{version:e=>!e||/^[0-9]+\.[0-9]+\.[0-9]+$/.test(e)||"invalid version"}}}}),[]),maxStoragePriceTBMonth:r,maxEgressPriceTB:i,maxIngressPriceTB:a}}(),j=(0,n.useMemo)(()=>{let e=m(p);if(e)return l({hosts:e.hosts.data,contracts:e.contracts.data,pricePinning:e.pricePinning.data})},[p]),S=(0,n.useMemo)(()=>(function(e){let{contracts:r,hosts:i,pricePinning:t}=e;return!!(r.error||i.error||t.error)})(p),[p]),T=(0,n.useCallback)(async()=>{let t=await e.mutate(),n=await r.mutate(),o=await i.mutate();if(!t||!n||!o)return void(0,a.el3)({title:"Error fetching settings"});P.reset(l({hosts:t,contracts:n,pricePinning:o}))},[P,e,r,i]);(0,a.wdL)({form:P,remoteValues:j}),(0,a.TEy)({form:P,remoteValues:j});let{changeCount:B}=(0,a.xSy)({form:P}),k=function(e){let{resources:r,revalidateAndResetForm:i}=e,t=(0,u.zL)(),s=(0,u.dW)(),c=(0,u.eX)(),l=(0,d.ej)();return(0,n.useCallback)(async e=>{let n=m(r);if(!n)return;let{payloads:u}=function(e){let{resources:r,values:i}=e,t={...r.contracts.data,wantedContracts:Math.round(i.wantedContracts.toNumber()),period:Math.round((0,o.VI)(i.periodWeeks.toNumber())),renewWindow:Math.round((0,o.VI)(i.renewWindowWeeks.toNumber()))};return{payloads:{contracts:t,hosts:{...r.hosts.data,maxStoragePrice:(0,o.zh)((0,o.eX)(i.maxStoragePriceTBMonth)).toString(),maxIngressPrice:(0,o.zh)((0,o.vE)(i.maxIngressPriceTB)).toString(),maxEgressPrice:(0,o.zh)((0,o.vE)(i.maxEgressPriceTB)).toString(),minCollateral:(0,o.zh)(i.minCollateral).toString(),minProtocolVersion:i.minProtocolVersion.split(".").map(Number)},pricePinning:{...r.pricePinning.data,currency:i.pinnedCurrency,maxStoragePrice:i.shouldPinMaxStoragePrice?i.maxStoragePriceTBMonthPinned.toNumber():0,maxEgressPrice:i.shouldPinMaxEgressPrice?i.maxEgressPriceTBPinned.toNumber():0,maxIngressPrice:i.shouldPinMaxIngressPrice?i.maxIngressPriceTBPinned.toNumber():0,minCollateral:i.shouldPinMinCollateral?i.minCollateralPinned.toNumber():0}}}}({resources:n,values:e}),h=[t.put({payload:u.contracts}),s.put({payload:u.hosts}),c.put({payload:u.pricePinning})],p=(await Promise.all(h)).find(e=>e.error);if(p)return void(0,a.el3)({title:"Error updating configuration",body:p.error});(0,a.VE1)({title:"Configuration has been saved"}),(async()=>{await (0,d.cb)(5e3),l(e=>e.startsWith(g.vb))})(),await i()},[r,t,s,c,i,l])}({resources:p,revalidateAndResetForm:T}),E=(0,a._2E)(C),I=(0,n.useMemo)(()=>P.handleSubmit(k,E),[P,k,E]),A=(0,n.useRef)(null),N=(0,n.useCallback)(async e=>{A.current&&(0,a.hwc)(A.current,e)},[]);return{onSubmit:I,revalidateAndResetForm:T,form:P,fields:C,changeCount:B,remoteError:S,configRef:A,takeScreenshot:N}}();return(0,t.jsx)(C.Provider,{value:i,children:r})}},46682:(e,r,i)=>{"use strict";i.d(r,{n:()=>u,SX:()=>c,P3:()=>s,aE:()=>g,zL:()=>m,eY:()=>h,dW:()=>p,R7:()=>P,eX:()=>x,KR:()=>l,NN:()=>d,vT:()=>v,iG:()=>f,YH:()=>y,Jz:()=>w});var t=i(26109),n=i(62435),a=i(98686),o=i(34475);function s(e){return(0,t.Av)({...e,route:n.dV})}function c(){let e=s({config:{swr:{revalidateOnFocus:!1}}});return(0,a.Ay)(e,()=>{var r;return(null==(r=e.data)?void 0:r.network)==="zen"?(0,o.Py)():(0,o.Nm)()},{refreshInterval:6e4,keepPreviousData:!0}).data||0}function l(e){return(0,t.yW)({...e,route:n.OD})}function d(e){return(0,t.Av)({...e,route:n.DM})}function u(e){return(0,t.Av)({...e,route:n.np})}function g(e){return(0,t.Av)({...e,route:n.kf})}function m(e){return(0,t.hz)({...e,route:n.bq})}function h(e){return(0,t.Av)({...e,route:n._M})}function p(e){return(0,t.hz)({...e,route:n.hN})}function P(e){return(0,t.Av)({...e,route:n.NR})}function x(e){return(0,t.hz)({...e,route:n.Ko})}function v(e){return(0,t.Av)({...e,route:n.Z})}function f(e){return(0,t.Av)({...e,route:n.ki})}function y(e){return(0,t.Av)({...e,route:n.s7})}function w(e){return(0,t.yW)({...e,route:n.V$})}},48230:(e,r,i)=>{"use strict";i.d(r,{i:()=>s});var t=i(54568),n=i(83445),a=i(46682),o=i(7620);function s(e){var r;let{size:i}=e,s=(0,a.zL)(),c=(0,a.aE)(),l=(0,o.useCallback)(()=>{var e;c.data&&s.put({payload:{...c.data,enabled:!(null==(e=c.data)?void 0:e.enabled)}})},[c.data,s]);return(0,t.jsx)(n.m_M,{content:"Enable or disable forming contracts and maintaining data.",children:(0,t.jsx)("div",{children:(0,t.jsx)(n.dOG,{size:i,checked:!!(null==(r=c.data)?void 0:r.enabled),onCheckedChange:l})})})}},62435:(e,r,i)=>{"use strict";i.d(r,{DM:()=>a,Ko:()=>m,NR:()=>g,OD:()=>n,V$:()=>x,Z:()=>h,_M:()=>d,bq:()=>l,dV:()=>t,hN:()=>u,kf:()=>c,ki:()=>p,np:()=>o,s7:()=>P,vb:()=>s});let t="/state",n="/syncer/connect",a="/txpool/recommendedfee",o="/contracts",s="/hosts",c="/settings/contracts",l="/settings/contracts",d="/settings/hosts",u="/settings/hosts",g="/settings/pricepinning",m="/settings/pricepinning",h="/wallet",p="/wallet/events",P="/wallet/pending",x="/wallet/send"},95212:(e,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>g});var t=i(54568),n=i(83445),a=i(31100),o=i(44358);function s(){let{takeScreenshot:e}=(0,o.UK)();return(0,t.jsxs)(n.rId,{trigger:(0,t.jsx)(n.$nd,{children:(0,t.jsx)(a.FJA,{})}),contentProps:{align:"end"},children:[(0,t.jsx)(n.lpj,{children:"Actions"}),(0,t.jsxs)(n._26,{onSelect:()=>{e({name:"config image",copy:!0})},children:[(0,t.jsx)(n.wO3,{children:(0,t.jsx)(a.vA0,{})}),"Copy image of configuration"]}),(0,t.jsxs)(n._26,{onSelect:()=>{e({name:"config",download:!0})},children:[(0,t.jsx)(n.wO3,{children:(0,t.jsx)(a.afm,{})}),"Download image of configuration"]})]})}var c=i(34475);function l(){let{onSubmit:e,changeCount:r,revalidateAndResetForm:i,form:l}=(0,o.UK)();return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[!!r&&(0,t.jsx)(n.EYj,{size:"12",color:"subtle",children:(0,c.td)(r,"change","changes")}),(0,t.jsx)(n.$nd,{tip:"Reset all changes",icon:"contrast",disabled:!r,onClick:i,children:(0,t.jsx)(a.ZxO,{})}),(0,t.jsx)(n.tWD,{children:(0,t.jsxs)(n.$nd,{tip:"Save all changes",variant:"accent",disabled:!l.formState.isDirty||l.formState.isSubmitting,onClick:e,children:[(0,t.jsx)(a.xfD,{}),"Save changes"]})}),(0,t.jsx)(s,{})]})}var d=i(48230);function u(){return(0,t.jsx)("div",{className:"pl-1",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(d.i,{size:"small"})})})}function g(e){let{children:r}=e;return(0,t.jsx)(n.VbM,{title:"Configuration",nav:(0,t.jsx)(u,{}),actions:(0,t.jsx)(l,{}),children:r})}}},e=>{e.O(0,[9085,9030,5764,6017,2826,7421,8820,224,2550,5465,9589,751,7722,4082,6712,1551,2273,9557,4114,7939,5312,1213,947,2991,8900,8149,2348,3445,587,1902,7358],()=>e(e.s=14317)),_N_E=e.O()}]);
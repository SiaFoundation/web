(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,860945,e=>{"use strict";var t=e.i(843476);e.i(387020);var s=e.i(1206);function a({label:e,value:a,variant:l="row"}){return"column"===l?(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(s.Text,{color:"verySubtle",size:"14",weight:"medium",className:"truncate",children:e}),(0,t.jsx)(s.Text,{color:"contrast",children:a})]}):(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("div",{className:"flex-1 flex justify-start items-center",children:(0,t.jsx)(s.Text,{color:"verySubtle",size:"14",weight:"medium",className:"truncate",children:e})}),(0,t.jsx)("div",{className:"flex-1 flex justify-end items-center",children:"string"==typeof a?a?(0,t.jsx)(s.Text,{className:"truncate",children:a}):(0,t.jsx)(s.Text,{color:"verySubtle",children:"-"}):a||(0,t.jsx)(s.Text,{color:"verySubtle",children:"-"})})]})}e.s(["InfoRow",()=>a])},370774,e=>{"use strict";var t=e.i(843476);e.i(387020);var s=e.i(217099),a=e.i(799163),l=e.i(226584),i=e.i(641331),r=e.i(926622),n=e.i(755337),o=e.i(271645),d=e.i(434480),c=e.i(1206),m=e.i(865085),u=e.i(706141),x=e.i(74045),h=e.i(623923);let j=[(0,x.selectColumn)(),{id:"id",header:({table:e,column:s})=>(0,t.jsx)(u.TableHeader,{table:e,column:s,className:"justify-start",children:"ID"}),cell:({row:e})=>(0,t.jsx)(m.ValueCopyable,{maxLength:100,value:e.original.id,label:"ID"}),meta:{className:"justify-start",...h.hashColumnWidth}},{id:"type",header:({table:e,column:s})=>(0,t.jsx)(u.TableHeader,{table:e,column:s,className:"justify-start",children:"Type"}),cell:({row:e})=>(0,t.jsx)(d.Badge,{children:e.original.type}),meta:{className:"justify-start",...h.smallColumnWidth}},{id:"severity",header:({table:e,column:s})=>(0,t.jsx)(u.TableHeader,{table:e,column:s,className:"justify-start",children:"Severity"}),cell:({row:e})=>(0,t.jsx)(d.Badge,{children:e.original.severity}),meta:{className:"justify-start",...h.smallColumnWidth}},{id:"message",header:({table:e,column:s})=>(0,t.jsx)(u.TableHeader,{table:e,column:s,className:"justify-start",children:"Message"}),cell:({row:e})=>(0,t.jsx)(c.Text,{children:e.original.message}),meta:{className:"justify-start",...h.smallColumnWidth}},{id:"timestamp",header:({table:e,column:s})=>(0,t.jsx)(u.TableHeader,{table:e,column:s,className:"justify-end",children:"Timestamp"}),cell:({row:e})=>(0,t.jsx)(c.Text,{children:e.original.displayFields.timestamp}),meta:{className:"justify-end",...h.timestampColumnWidth}}];var y=e.i(339173),g=e.i(33200),f=e.i(540491);e.i(519977);var p=e.i(219474);e.i(587154);var v=e.i(699221);function S({table:e}){let s=(0,o.useMemo)(()=>e.isSelection?e.selectedRows:e.rows,[e.isSelection,e.selectedRows,e.rows]),a=(0,p.useAdminAlertsDismiss)();return(0,t.jsx)(f.SidePanel,{heading:(0,t.jsx)(c.Text,{size:"18",weight:"medium",children:e.isSelection?`Selected alerts (${s.length})`:e.isFiltered?`Filtered alerts (${s.length})`:"All alerts"}),actions:e.isSelection?(0,t.jsxs)(y.Button,{onClick:async()=>{try{await a.post({payload:s.map(e=>e.id)}),(0,g.triggerSuccessToast)({title:"Alerts dismissed"}),e.setRowSelection({})}catch(e){console.error(e),(0,g.triggerErrorToast)({title:"Failed to dismiss alerts"})}},children:[(0,t.jsx)(v.Checkmark16,{}),"Dismiss alerts"]}):null,customCloseAction:e.isSelection?(0,t.jsx)(y.Button,{onClick:()=>e.setRowSelection({}),children:"Clear selection"}):null,children:(0,t.jsx)(c.Text,{color:"subtle",className:"flex justify-center pt-[50px]",children:"No information on alerts yet"})})}var b=e.i(489842),T=e.i(530875),N=e.i(885116),w=e.i(279969);function C(){let e=(0,N.useDataTableParams)("alertList"),[t,s]=(0,w.useParamStr)("alertsPanelId");return{...e,panelId:t,setPanelId:s}}var R=e.i(929232),A=e.i(860945);function P(e){return e.data?.type==="lostSectors"?"Lost sectors":"Unknown"}var D=e.i(750560);function k(e){let t=e.data&&"hostKeys"in e.data?"lostSectors":"unknown",s="lostSectors"===t?{type:"lostSectors",hostKeys:e.data?.hostKeys,hint:e.data?.hint}:{type:"unknown",...e.data};return{id:e.id,severity:e.severity,message:e.message,type:t,data:s,timestamp:e.timestamp,displayFields:{timestamp:Intl.DateTimeFormat("en-US",{dateStyle:"short",timeStyle:"short"}).format(new Date(e.timestamp))}}}var I=e.i(756894);function F(){let{panelId:e,setPanelId:s}=C(),a=(0,p.useAdminAlertsDismiss)(),l=(0,p.useAdminAlert)({disabled:!e,params:{id:e}}),i=(0,T.useRemoteData)({alert:l},({alert:e})=>k(e));return(0,t.jsx)(b.RemoteDataStates,{data:i,loading:(0,t.jsx)(I.SidePanelSkeleton,{withActions:!0,onClose:()=>s(void 0)}),notFound:(0,t.jsx)(f.SidePanel,{heading:null,children:(0,t.jsx)("div",{className:"flex justify-center pt-[50px]",children:(0,t.jsx)(c.Text,{color:"subtle",children:"Alert not found"})})}),loaded:e=>(0,t.jsxs)(f.SidePanel,{onClose:()=>s(void 0),heading:(0,t.jsx)(D.SidePanelHeadingCopyable,{heading:(0,t.jsx)(c.Text,{size:"18",weight:"medium",ellipsis:!0,children:P(e)}),value:e.id,label:"alert"}),actions:(0,t.jsxs)(y.Button,{onClick:async()=>{try{await a.post({payload:[e.id]}),s(void 0),(0,g.triggerSuccessToast)({title:"Alert dismissed"})}catch(e){console.error(e),(0,g.triggerErrorToast)({title:"Failed to dismiss alert"})}},variant:"red",children:[(0,t.jsx)(v.Checkmark16,{}),"Dismiss alert"]}),children:[(0,t.jsx)(R.SidePanelSection,{heading:"Info",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(A.InfoRow,{label:"Type",value:(0,t.jsx)(d.Badge,{children:P(e)})}),(0,t.jsx)(A.InfoRow,{label:"Severity",value:e.severity}),(0,t.jsx)(A.InfoRow,{label:"Message",value:e.message}),(0,t.jsx)(A.InfoRow,{label:"Timestamp",value:e.displayFields.timestamp}),e.data&&"unknown"===e.data.type&&(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)(A.InfoRow,{label:"Data",value:JSON.stringify(e.data)})}),e.data&&"lostSectors"===e.data.type&&(0,t.jsx)(A.InfoRow,{variant:"column",label:"Hint",value:e.data.hint})]})}),e.data&&"lostSectors"===e.data.type&&(0,t.jsx)(R.SidePanelSection,{heading:"Host keys",children:(0,t.jsx)("div",{className:"flex flex-col gap-2",children:e.data.hostKeys.map(e=>(0,t.jsx)(A.InfoRow,{label:"Host Key",value:(0,t.jsx)(m.ValueCopyable,{value:e,type:"hostPublicKey"})},e))})})]})})}var H=e.i(367887),B=e.i(66084);function K(){let{offset:e,limit:d,setOffset:c,setLimit:m,panelId:u,setPanelId:x,columnFilters:h,setColumnFilters:y,columnSorts:g,setColumnSorts:f}=C(),v=(0,o.useCallback)(e=>{x(e)},[x]),b=function(){let{limit:e,offset:t}=C(),s=(0,p.useAdminAlerts)({params:{limit:e,offset:t}});return(0,H.useRemoteDataset)({alerts:s},({alerts:e})=>e.map(k),{offset:t})}(),T=(0,r.useDataTable)({dataset:b,columns:j,columnFilters:h,setColumnFilters:y,columnSorts:g,setColumnSorts:f,offset:e,limit:d,onRowClick:v,setOffset:c,setLimit:m});return(0,t.jsx)(B.Layout,{table:(0,t.jsx)(s.DataTable,{...T,localStorage:"indexd/alerts",noneOnPage:(0,t.jsx)(n.StateNoneOnPage,{message:"No alerts on this page, reset pagination to continue."}),noneYet:(0,t.jsx)(i.StateNoneYet,{message:"There are currently no alerts."}),noneMatchingFilters:(0,t.jsx)(a.StateNoneMatching,{message:"No alerts matching filters."}),error:(0,t.jsx)(l.StateError,{message:"Error loading alerts. Please try again later."})}),panel:u?(0,t.jsx)(F,{}):(0,t.jsx)(S,{table:T})})}function M(){return(0,t.jsx)(K,{})}e.s(["default",()=>M],370774)}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{42040:(e,s,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/hosts",function(){return l(99200)}])},43083:(e,s,l)=>{"use strict";l.d(s,{I:()=>d});var t=l(6029),n=l(59617),o=l(4968),a=l(55729),i=l(18449),c=l(32708),r=l(5265);function d(e){let{multiSelect:s,publicKeys:l}=e,{openConfirmDialog:d}=(0,i.sp)(),u=(0,r.k)(),x=(0,a.useCallback)(async()=>{await u([],l),s.deselectAll()},[u,s,l]);return(0,t.jsxs)(n.$nd,{"aria-label":"remove host public keys from allowlist",tip:"Remove host public keys from allowlist",onClick:()=>{d({title:"Remove ".concat((0,c.td)(s.selectionCount,"host")," from allowlist"),action:"Remove from allowlist",variant:"accent",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to remove"," ",(0,c.td)(s.selectionCount,"host public key")," from the allowlist?"]})}),onConfirm:x})},children:[(0,t.jsx)(o.puB,{}),"Remove hosts from allowlist"]})}},64844:(e,s,l)=>{"use strict";l.d(s,{b:()=>d});var t=l(6029),n=l(59617),o=l(4968),a=l(55729),i=l(18449),c=l(32708),r=l(5265);function d(e){let{multiSelect:s,publicKeys:l}=e,{openConfirmDialog:d}=(0,i.sp)(),u=(0,r.k)(),x=(0,a.useCallback)(async()=>{u(l,[]),s.deselectAll()},[u,s,l]);return(0,t.jsxs)(n.$nd,{"aria-label":"add host public keys to allowlist",tip:"Add host public keys to allowlist",onClick:()=>{d({title:"Add ".concat((0,c.td)(s.selectionCount,"host")," to allowlist"),action:"Add to allowlist",variant:"accent",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to add"," ",(0,c.td)(s.selectionCount,"host public key")," to the allowlist?"]})}),onConfirm:x})},children:[(0,t.jsx)(o.puB,{}),"Add hosts to allowlist"]})}},98497:(e,s,l)=>{"use strict";l.d(s,{s:()=>r});var t=l(6029),n=l(59617),o=l(4968),a=l(56523),i=l(55729),c=l(32708);function r(e){let{multiSelect:s,publicKeys:l}=e,r=(0,a.FF)(),d=(0,i.useCallback)(async()=>{await (0,n.qBJ)(l.map(e=>r.post({params:{hostkey:e},payload:{timeout:(0,c.DM)(30)}})),{toastError:e=>{let{successCount:s,errorCount:l,totalCount:t}=e;return{title:"Rescanning ".concat((0,c.td)(s,"host")),body:"Error starting rescan for ".concat(l,"/").concat(t," of total hosts.")}},toastSuccess:e=>{let{totalCount:s}=e;return{title:"Rescanning ".concat((0,c.td)(s,"host"))}},after:()=>{s.deselectAll()}})},[s,l,r]);return(0,t.jsx)(n.$nd,{"aria-label":"rescan selected hosts",tip:"Rescan selected hosts",onClick:d,children:(0,t.jsx)(o.PcB,{})})}},99200:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>K});var t=l(6029),n=l(59617),o=l(71518),a=l(4968),i=l(80698);function c(){let{datasetState:e}=(0,o.z)();return"noneOnPage"===e?(0,t.jsx)(n.GB$,{}):"error"===e?(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(n.EYj,{children:(0,t.jsx)(a.YA5,{className:"scale-[200%]"})}),(0,t.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching hosts."})]}):"noneMatchingFilters"===e?(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(n.EYj,{children:(0,t.jsx)(a.oio,{className:"scale-[200%]"})}),(0,t.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"No hosts matching filters."})]}):"noneYet"===e?(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(n.EYj,{children:(0,t.jsx)(a.jjT,{className:"scale-[200%]"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,t.jsxs)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:["There are currently no hosts in the database. Make sure"," ",(0,t.jsx)(n.CyN,{children:"renterd"})," can access the network and make sure peers are being discovered."]}),(0,t.jsx)(n.z9$,{href:i.J.node.index,children:"View peers"})]})]}):null}var r=l(29698),d=l(74416),u=l(69008);function x(){let{gpu:e,settings:s}=(0,r.IQ)(),{setCmd:l,activeHost:a,onHostMapClick:i,hostsWithLocation:c}=(0,o.z)();return s.siascan&&!e.shouldRender?null:(0,t.jsxs)("div",{className:"w-full h-full",children:[(0,t.jsx)(d.q,{activeHost:(null==a?void 0:a.location)?a:void 0,hosts:c,onHostClick:i,onMount:e=>{l(e)}}),(0,t.jsxs)("div",{className:"absolute top-5 left-6 flex flex-col gap-1",children:[(0,t.jsx)(n.P1Q,{color:u.VH.activeAndUsable.colorHex,label:"Active contract & usable",size:"12"}),(0,t.jsx)(n.P1Q,{color:u.VH.activeAndUnusable.colorHex,label:"Active contract & unusable",size:"12"}),(0,t.jsx)(n.P1Q,{color:u.VH.potentialHost.colorHex,label:"No active contract",size:"12"})]})]})}var h=l(28811);function m(){let{datasetPage:e,activeHost:s,visibleColumns:l,limit:a,datasetState:i,tableContext:r,viewMode:d}=(0,o.z)();return(0,t.jsxs)("div",{className:"relative flex flex-col overflow-hidden h-full w-full",children:[(0,t.jsx)("div",{className:(0,h.cx)("absolute h-[70%] w-full","map"===d?"block":"invisible","transition-all"),children:(0,t.jsx)(x,{})}),(0,t.jsx)("div",{className:(0,h.cx)("absolute overflow-hidden transition-all w-full","duration-300","overflow-hidden"),style:{bottom:0,height:"map"===d?e&&e.length?400-Math.max((2-e.length)*100,0):400:"100%"},children:(0,t.jsx)(n.FKN,{className:"z-0",id:"scroll-hosts",children:(0,t.jsx)("div",{className:(0,h.cx)("map"===d?"pb-6 px-6":"p-6","min-w-fit"),children:(0,t.jsx)(n.XIK,{testId:"hostsTable",focusId:null==s?void 0:s.publicKey,focusColor:s?(0,u.BL)(s).colorName:void 0,isLoading:"loading"===i,emptyState:(0,t.jsx)(c,{}),context:r,pageSize:a,data:e,columns:l,rowSize:"default"})})})})]})}var p=l(20820),j=l(18449),f=l(30947);function b(){let{configurableColumns:e,toggleColumnVisibility:s,setColumnsVisible:l,setColumnsHidden:i,resetDefaultColumnVisibility:c,visibleColumnIds:r}=(0,o.z)(),d=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),u=e.filter(e=>"autopilot"===e.category).map(e=>({label:e.label,value:e.id})),x=e.filter(e=>"v2Settings"===e.category).map(e=>({label:e.label,value:e.id})),h=e.filter(e=>"priceTable"===e.category).map(e=>({label:e.label,value:e.id})),m=e.filter(e=>"hostSettings"===e.category).map(e=>({label:e.label,value:e.id}));return(0,t.jsxs)(n.AMh,{trigger:(0,t.jsxs)(n.$nd,{tip:"Configure view",tipAlign:"end",children:[(0,t.jsx)(a.s7Y,{}),"View",(0,t.jsx)(a.NNJ,{})]}),contentProps:{align:"end",className:"!max-w-md !h-[400px]"},children:[(0,t.jsxs)(n.iy7,{children:[(0,t.jsx)(n.JU7,{children:"Display properties"}),(0,t.jsx)(n.DF3,{children:(0,t.jsx)(n.$nd,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),c()},children:(0,t.jsx)(a.ZxO,{})})})]}),(0,t.jsx)(n.IJR,{label:"General",columns:d.map(e=>e.value),enabled:r,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(n.iy7,{children:(0,t.jsx)(n.PSc,{options:d,values:r,onChange:e=>s(e)})}),u.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.IJR,{label:"Autopilot",columns:u.map(e=>e.value),enabled:r,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(n.iy7,{children:(0,t.jsx)(n.PSc,{options:u,values:r,onChange:e=>s(e)})})]}):null,x.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.IJR,{label:"V2 settings (RHPv4)",columns:x.map(e=>e.value),enabled:r,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(n.iy7,{children:(0,t.jsx)(n.PSc,{options:x,values:r,onChange:e=>s(e)})})]}):null,h.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.IJR,{label:"Price table (RHPv3)",columns:h.map(e=>e.value),enabled:r,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(n.iy7,{children:(0,t.jsx)(n.PSc,{options:h,values:r,onChange:e=>s(e)})})]}):null,m.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.IJR,{label:"Host settings (RHPv2)",columns:m.map(e=>e.value),enabled:r,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(n.iy7,{children:(0,t.jsx)(n.PSc,{options:m,values:r,onChange:e=>s(e)})})]}):null]})}function v(){let{openDialog:e}=(0,j.sp)(),{viewMode:s,setViewMode:l}=(0,o.z)(),{daemonExplorer:i,settings:c,gpu:d}=(0,r.IQ)();return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.$nd,{onClick:()=>e("hostsManageAllowBlock"),tip:"Manage host blocklist and allowlist",children:[(0,t.jsx)(a.puB,{}),"Manage lists"]}),(0,t.jsx)(n.m_M,{content:c.siascan?d.canGpuRender&&d.isGpuEnabled?"Toggle interactive map":"Enable GPU to view interactive map":"Configure an explorer to view interactive map",children:(0,t.jsx)(n.$nd,{disabled:!d.canGpuRender,onClick:()=>{if(!i.enabled)return void(0,n.el3)({title:"Explorer not configured",body:"Configure an explorer in the startup configuration to enable the interactive map."});d.isGpuEnabled?l("map"===s?"list":"map"):e("settings")},children:(0,t.jsx)(a.m8f,{})})}),(0,t.jsx)(b,{})]})}var g=l(9169),k=l(55729),y=l(944);function C(){let{filters:e,removeFilter:s,removeLastFilter:l}=(0,o.z)(),[i,c]=(0,k.useState)(!1),[r,d]=(0,k.useState)(""),[u,x]=(0,k.useState)([]),h=u[u.length-1],m=(0,k.useRef)(null),p=(0,k.useRef)(null),j=(0,k.useCallback)(e=>{x(s=>[...s,e])},[x]),f=(0,k.useCallback)(()=>{x([])},[x]);(0,k.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&c(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let b=(0,k.useCallback)(()=>{var e;null==(e=p.current)||e.focus()},[p]),v=(0,k.useCallback)(()=>{d(""),f()},[f]);return(0,t.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,t.jsxs)(n.tWD,{children:[(0,t.jsx)(n.$nd,{variant:"active",state:"waiting",children:e.label}),(0,t.jsx)(n.$nd,{variant:"active",size:"small",onClick:()=>s(e.id),children:(0,t.jsx)(a.sn9,{})})]},e.id)),(0,t.jsxs)(g.uB,{ref:m,label:"Command Menu",onFocus:()=>c(!0),onKeyDown:e=>{if(u.length>0)"Escape"!==e.key&&("Backspace"!==e.key||r)||(e.preventDefault(),x(e=>e.slice(0,-1)));else if(0===u.length&&("Backspace"!==e.key||r||l(),"Escape"===e.key&&!r)){var s;c(!1),null==(s=p.current)||s.blur()}},children:[(0,t.jsx)(g.uB.Input,{"aria-label":"filter hosts",name:"filter-hosts-menu-input",ref:p,value:r,onValueChange:d,className:(0,n.uS8)({variant:"ghost",focus:"none"}),placeholder:"Filter hosts"}),i&&(0,t.jsx)(n.Zkm,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,t.jsxs)(n.FKN,{children:[h&&(0,t.jsx)(n.JU7,{className:"px-1.5 py-1",children:h.label}),(0,t.jsx)(g.uB.List,{children:(0,t.jsx)(y.y,{currentPage:h,beforeSelect:b,afterSelect:v,pushPage:j})})]})})]})]})}function w(){let{offset:e,limit:s,datasetPageTotal:l,datasetState:a}=(0,o.z)();return(0,t.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,t.jsx)(C,{}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsx)(n.q6Y,{offset:e,limit:s,pageTotal:l,isLoading:"loading"===a})]})}var N=l(56523),z=l(32708);function A(){let e=(0,N.CU)(),{multiSelect:s}=(0,o.z)(),l=(0,k.useMemo)(()=>Object.entries(s.selection).map(e=>{let[s,l]=e;return l.publicKey}),[s.selection]),i=(0,k.useCallback)(async()=>{await (0,n.qBJ)(l.map(s=>e.post({params:{hostkey:s}})),{toastError:e=>{let{successCount:s,errorCount:l,totalCount:t}=e;return{title:"Reset lost sector count for ".concat((0,z.td)(s,"host")),body:"Error reseting lost sector count for ".concat(l,"/").concat(t," total hosts.")}},toastSuccess:e=>{let{totalCount:s}=e;return{title:"Reset lost sector count for ".concat((0,z.td)(s,"host"))}},after:()=>{s.deselectAll()}})},[s,l,e]);return(0,t.jsx)(n.$nd,{"aria-label":"reset lost sector count for hosts",tip:"Reset lost sector count for hosts",onClick:i,children:(0,t.jsx)(a.wJw,{})})}var R=l(52969);function E(e){let{multiSelect:s,hostAddresses:l}=e,{openConfirmDialog:o}=(0,j.sp)(),i=(0,R.U)(),c=(0,k.useCallback)(async()=>{i(l,[]),s.deselectAll()},[i,s,l]);return(0,t.jsxs)(n.$nd,{"aria-label":"add host addresses to blocklist",tip:"Add host addresses to blocklist",onClick:()=>{o({title:"Add ".concat((0,z.td)(s.selectionCount,"host")," to blocklist"),action:"Add to blocklist",variant:"red",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to add"," ",(0,z.td)(s.selectionCount,"host address","host addresses")," ","to the blocklist?"]})}),onConfirm:c})},children:[(0,t.jsx)(a.puB,{}),"Add hosts to blocklist"]})}function S(){let{multiSelect:e}=(0,o.z)(),s=(0,k.useMemo)(()=>Object.entries(e.selection).map(e=>{let[s,l]=e;return l.address}),[e.selection]);return(0,t.jsx)(E,{multiSelect:e,hostAddresses:s})}var P=l(64844);function H(){let{multiSelect:e}=(0,o.z)(),s=(0,k.useMemo)(()=>Object.entries(e.selection).map(e=>{let[s,l]=e;return l.publicKey}),[e.selection]);return(0,t.jsx)(P.b,{multiSelect:e,publicKeys:s})}function M(e){let{multiSelect:s,hostAddresses:l}=e,{openConfirmDialog:o}=(0,j.sp)(),i=(0,R.U)(),c=(0,k.useCallback)(async()=>{i([],l),s.deselectAll()},[i,s,l]);return(0,t.jsxs)(n.$nd,{"aria-label":"remove host addresses from blocklist",tip:"Remove host addresses from blocklist",onClick:()=>{o({title:"Remove ".concat((0,z.td)(s.selectionCount,"host")," from blocklist"),action:"Remove from blocklist",variant:"red",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to remove"," ",(0,z.td)(s.selectionCount,"host address","host addresses")," ","from the blocklist?"]})}),onConfirm:c})},children:[(0,t.jsx)(a.puB,{}),"Remove hosts from blocklist"]})}function B(){let{multiSelect:e}=(0,o.z)(),s=(0,k.useMemo)(()=>Object.entries(e.selection).map(e=>{let[s,l]=e;return l.address}),[e.selection]);return(0,t.jsx)(M,{multiSelect:e,hostAddresses:s})}var $=l(43083);function I(){let{multiSelect:e}=(0,o.z)(),s=(0,k.useMemo)(()=>Object.entries(e.selection).map(e=>{let[s,l]=e;return l.publicKey}),[e.selection]);return(0,t.jsx)($.I,{multiSelect:e,publicKeys:s})}var J=l(98497);function _(){let{multiSelect:e}=(0,o.z)(),s=(0,k.useMemo)(()=>Object.entries(e.selection).map(e=>{let[s,l]=e;return l.publicKey}),[e.selection]);return(0,t.jsx)(J.s,{multiSelect:e,publicKeys:s})}function F(){let{multiSelect:e}=(0,o.z)();return(0,t.jsxs)(n.ptQ,{multiSelect:e,entityWord:"host",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(H,{}),(0,t.jsx)(S,{})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(I,{}),(0,t.jsx)(B,{})]}),(0,t.jsx)(_,{}),(0,t.jsx)(A,{})]})}function K(){return(0,t.jsx)(m,{})}K.Layout=f.C,K.useLayoutProps=function(){let{openDialog:e}=(0,j.sp)();return{title:"Hosts",routes:i.J,sidenav:(0,t.jsx)(p.T,{}),openSettings:()=>e("settings"),size:"full",actions:(0,t.jsx)(v,{}),stats:(0,t.jsx)(w,{}),scroll:!1,dockedControls:(0,t.jsx)(F,{})}}}},e=>{var s=s=>e(e.s=s);e.O(0,[634,636,593,792],()=>s(42040)),_N_E=e.O()}]);
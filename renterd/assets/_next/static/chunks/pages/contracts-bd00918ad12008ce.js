(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{21452:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/contracts",function(){return l(55818)}])},43083:(e,t,l)=>{"use strict";l.d(t,{I:()=>d});var s=l(6029),n=l(59617),a=l(4968),c=l(55729),i=l(18449),r=l(32708),o=l(5265);function d(e){let{multiSelect:t,publicKeys:l}=e,{openConfirmDialog:d}=(0,i.sp)(),u=(0,o.k)(),x=(0,c.useCallback)(async()=>{await u([],l),t.deselectAll()},[u,t,l]);return(0,s.jsxs)(n.$nd,{"aria-label":"remove host public keys from allowlist",tip:"Remove host public keys from allowlist",onClick:()=>{d({title:"Remove ".concat((0,r.td)(t.selectionCount,"host")," from allowlist"),action:"Remove from allowlist",variant:"accent",body:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to remove"," ",(0,r.td)(t.selectionCount,"host public key")," from the allowlist?"]})}),onConfirm:x})},children:[(0,s.jsx)(a.puB,{}),"Remove hosts from allowlist"]})}},55818:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>J});var s=l(6029),n=l(59617),a=l(93871),c=l(4968);function i(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.EYj,{children:(0,s.jsx)(c.oio,{className:"scale-[200%]"})}),(0,s.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"No active contracts matching filters."})]})}function r(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.EYj,{children:(0,s.jsx)(c.ox6,{className:"scale-[200%]"})}),(0,s.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"There are currently no active contracts. Configure autopilot or manually form contracts to get started."})]})}function o(e){let{error:t}=e;return(null==t?void 0:t.message.startsWith("404"))?(0,s.jsx)(r,{}):(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.EYj,{children:(0,s.jsx)(c.YA5,{className:"scale-[200%]"})}),(0,s.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching contracts."})]})}var d=l(28811);function u(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.EYj,{children:(0,s.jsx)(c.zIn,{className:"scale-[200%]"})}),(0,s.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"No data available."})]})}function x(){let{selectedContract:e,allContractsSpendingMetrics:t,selectedContractSpendingMetrics:l,graphMode:c,setGraphMode:i}=(0,a.n)(),r=(0,s.jsxs)("div",{className:"flex gap-2",children:[!e&&(0,s.jsx)(n.$nd,{variant:"spending"===c?"accent":"gray",onClick:()=>i("spending"),children:"Funding & spending: All contracts"}),e&&(0,s.jsxs)(n.$nd,{variant:"spending"===c?"accent":"gray",onClick:()=>i("spending"),children:["Funding & spending: Contract"," ",(0,n.tky)(e.id).slice(0,6)]})]});return(0,s.jsxs)("div",{className:"w-full h-full",children:["spending"===c&&!e&&(0,s.jsx)(n.kHz,{id:"renterd/v0/contracts/graphs/fundingAndSpending",height:"100%",data:t.data,config:t.config,isLoading:t.isLoading,actionsLeft:r,emptyState:(0,s.jsx)(u,{})}),"spending"===c&&e&&(0,s.jsx)(n.kHz,{id:"renterd/v0/contracts/graphs/fundingAndSpending",height:"100%",data:l.data,config:l.config,isLoading:l.isLoading,actionsLeft:r,emptyState:(0,s.jsx)(u,{})})]})}function h(){let{visibleColumns:e,datasetPage:t,sortField:l,sortDirection:c,sortableColumns:u,toggleSort:h,limit:j,datasetState:p,cellContext:m,error:f,viewMode:g,filters:v,selectedContract:b}=(0,a.n)(),y="detail"===g&&(!v.length||b),k=y?t&&t.length?"".concat(400-Math.max((2-t.length)*100,0),"px"):"400px":"100%";return(0,s.jsxs)("div",{className:"relative flex flex-col overflow-hidden h-full w-full",children:[(0,s.jsx)("div",{className:(0,d.cx)("absolute w-full",y?"block":"invisible","transition-all","p-6"),style:{height:y?"calc(100% - ".concat(k,")"):0},children:y?(0,s.jsx)(x,{}):null}),(0,s.jsx)("div",{className:(0,d.cx)("absolute overflow-hidden transition-all w-full","duration-300","overflow-hidden"),style:{bottom:0,height:k},children:(0,s.jsx)(n.FKN,{className:"z-0",children:(0,s.jsx)("div",{className:(0,d.cx)(y?"pb-6 px-6":"p-6","min-w-fit"),children:(0,s.jsx)(n.XIK,{testId:"contractsTable",context:m,isLoading:"loading"===p,emptyState:(0,s.jsx)(n.ppr,{datasetState:p,noneMatching:(0,s.jsx)(i,{}),noneYet:(0,s.jsx)(r,{}),error:(0,s.jsx)(o,{error:f})}),sortableColumns:u,pageSize:j,data:t,columns:e,sortDirection:c,sortField:l,toggleSort:h,rowSize:"default"})})})})]})}var j=l(20820),p=l(80698),m=l(18449),f=l(30947),g=l(38003),v=l(45765);function b(){let{configurableColumns:e,toggleColumnVisibility:t,resetDefaultColumnVisibility:l,setColumnsVisible:i,setColumnsHidden:r,sortField:o,setSortField:d,sortDirection:u,setSortDirection:x,visibleColumnIds:h}=(0,a.n)(),j=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),p=e.filter(e=>"time"===e.category).map(e=>({label:e.label,value:e.id})),m=e.filter(e=>"financial"===e.category).map(e=>({label:e.label,value:e.id}));return(0,s.jsxs)(n.AMh,{trigger:(0,s.jsxs)(n.$nd,{"aria-label":"configure view",size:"small",tip:"Configure view",tipAlign:"end",children:[(0,s.jsx)(c.s7Y,{}),"View",(0,s.jsx)(c.NNJ,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,s.jsxs)(n.iy7,{children:[(0,s.jsx)(n.JU7,{children:"Order by"}),(0,s.jsx)(n.DF3,{children:(0,s.jsx)(n.l6P,{value:o,onChange:e=>{d(e.currentTarget.value)},children:Object.entries((0,v.A)(g.vP,"category")).map(e=>{let[t,l]=e;return(0,s.jsx)("optgroup",{label:t,children:l.map(e=>(0,s.jsx)(n.c$x,{value:e.id,children:e.label},e.id))},t)})})})]}),(0,s.jsxs)(n.iy7,{children:[(0,s.jsx)(n.JU7,{children:"Direction"}),(0,s.jsx)(n.DF3,{children:(0,s.jsxs)(n.l6P,{value:u,onClick:e=>{e.stopPropagation()},onChange:e=>{x(e.currentTarget.value)},children:[(0,s.jsx)(n.c$x,{value:"desc",children:"descending"},"desc"),(0,s.jsx)(n.c$x,{value:"asc",children:"ascending"},"asc")]})})]}),(0,s.jsx)(n.bXX,{}),(0,s.jsxs)(n.iy7,{children:[(0,s.jsx)(n.JU7,{children:"Display properties"}),(0,s.jsx)(n.DF3,{children:(0,s.jsx)(n.$nd,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),l()},children:(0,s.jsx)(c.ZxO,{})})})]}),(0,s.jsx)(n.IJR,{label:"General",columns:j.map(e=>e.value),enabled:h,setColumnsVisible:i,setColumnsHidden:r}),(0,s.jsx)(n.iy7,{children:(0,s.jsx)(n.PSc,{options:j,values:h,onChange:e=>t(e)})}),(0,s.jsx)(n.IJR,{label:"Time",columns:p.map(e=>e.value),enabled:h,setColumnsVisible:i,setColumnsHidden:r}),(0,s.jsx)(n.iy7,{children:(0,s.jsx)(n.PSc,{options:p,values:h,onChange:e=>t(e)})}),(0,s.jsx)(n.IJR,{label:"Financial",columns:m.map(e=>e.value),enabled:h,setColumnsVisible:i,setColumnsHidden:r}),(0,s.jsx)(n.iy7,{children:(0,s.jsx)(n.PSc,{options:m,values:h,onChange:e=>t(e)})})]})}function y(){let{setViewMode:e}=(0,a.n)();return(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n.$nd,{tip:"Toggle graphs",onClick:()=>e(e=>"detail"===e?"list":"detail"),children:(0,s.jsx)(c.F6Z,{})}),(0,s.jsx)(b,{})]})}var k=l(9169),C=l(55729),w=l(74699);function N(){let{filters:e,removeFilter:t,removeLastFilter:l}=(0,a.n)(),[i,r]=(0,C.useState)(!1),[o,d]=(0,C.useState)(""),[u,x]=(0,C.useState)([]),h=u[u.length-1],j=(u.length,(0,C.useRef)(null)),p=(0,C.useRef)(null),m=(0,C.useCallback)(e=>{x(t=>[...t,e])},[x]),f=(0,C.useCallback)(()=>{x([])},[x]);(0,C.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&r(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let g=(0,C.useCallback)(()=>{var e;null==(e=p.current)||e.focus()},[p]),v=(0,C.useCallback)(()=>{d(""),f()},[f]);return(0,s.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,s.jsxs)(n.tWD,{children:[(0,s.jsx)(n.$nd,{variant:"active",state:"waiting",children:e.label}),(0,s.jsx)(n.$nd,{variant:"active",size:"small",onClick:()=>t(e.id),children:(0,s.jsx)(c.sn9,{})})]},e.id)),(0,s.jsxs)(k.uB,{ref:j,label:"Command Menu",onFocus:()=>r(!0),onKeyDown:e=>{if(u.length>0)"Escape"!==e.key&&("Backspace"!==e.key||o)||(e.preventDefault(),x(e=>e.slice(0,-1)));else if(0===u.length&&("Backspace"!==e.key||o||l(),"Escape"===e.key&&!o)){var t;r(!1),null==(t=p.current)||t.blur()}},children:[(0,s.jsx)(k.uB.Input,{"aria-label":"filter contracts",name:"filter-contracts-menu-input",ref:p,value:o,onValueChange:d,className:(0,n.uS8)({variant:"ghost",focus:"none"}),placeholder:"Filter contracts"}),i&&(0,s.jsx)(n.Zkm,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,s.jsxs)(n.FKN,{children:[h&&(0,s.jsx)(n.JU7,{className:"px-1.5 py-1",children:h.label}),(0,s.jsx)(k.uB.List,{children:(0,s.jsx)(w.o,{currentPage:h,beforeSelect:g,afterSelect:v,pushPage:m})})]})})]})]})}function S(){let{datasetState:e,offset:t,limit:l,datasetFilteredTotal:c}=(0,a.n)();return(0,s.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,s.jsx)(N,{}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)(n.LmH,{isLoading:"loading"===e,offset:t,limit:l,total:c})]})}var E=l(56523),A=l(32708);function L(){let{multiSelect:e}=(0,a.n)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.id}),[e.selection]),{openConfirmDialog:l}=(0,m.sp)(),i=(0,E.XR)(),r=(0,C.useCallback)(async()=>{await (0,n.qBJ)(t.map(e=>i.delete({params:{id:e}})),{toastError:e=>{let{successCount:t,errorCount:l,totalCount:s}=e;return{title:"".concat((0,A.td)(t,"contract")," deleted"),body:"Error deleting ".concat(l,"/").concat(s," total contracts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"".concat((0,A.td)(t,"contract")," deleted")}},after:()=>{e.deselectAll()}})},[e,t,i]);return(0,s.jsx)(n.$nd,{"aria-label":"delete selected contracts",tip:"Delete selected contracts",onClick:()=>{l({title:"Delete contracts",action:"Delete",variant:"red",body:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to delete the"," ",(0,A.td)(e.selectionCount,"selected contract"),"?"]})}),onConfirm:async()=>{r()}})},children:(0,s.jsx)(c.$$D,{})})}var z=l(64844);function $(){let{multiSelect:e}=(0,a.n)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.hostKey}),[e.selection]);return(0,s.jsx)(z.b,{multiSelect:e,publicKeys:t})}var P=l(43083);function D(){let{multiSelect:e}=(0,a.n)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.hostKey}),[e.selection]);return(0,s.jsx)(P.I,{multiSelect:e,publicKeys:t})}var F=l(98497);function R(){let{multiSelect:e}=(0,a.n)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.hostKey}),[e.selection]);return(0,s.jsx)(F.s,{multiSelect:e,publicKeys:t})}function _(){let{multiSelect:e}=(0,a.n)();return(0,s.jsxs)(n.ptQ,{multiSelect:e,entityWord:"contract",children:[(0,s.jsx)($,{}),(0,s.jsx)(D,{}),(0,s.jsx)(R,{}),(0,s.jsx)(L,{})]})}function J(){return(0,s.jsx)(h,{})}J.Layout=f.C,J.useLayoutProps=function(){let{openDialog:e}=(0,m.sp)();return{title:"Active contracts",routes:p.J,sidenav:(0,s.jsx)(j.T,{}),openSettings:()=>e("settings"),actions:(0,s.jsx)(y,{}),stats:(0,s.jsx)(S,{}),size:"full",scroll:!1,dockedControls:(0,s.jsx)(_,{})}}},64844:(e,t,l)=>{"use strict";l.d(t,{b:()=>d});var s=l(6029),n=l(59617),a=l(4968),c=l(55729),i=l(18449),r=l(32708),o=l(5265);function d(e){let{multiSelect:t,publicKeys:l}=e,{openConfirmDialog:d}=(0,i.sp)(),u=(0,o.k)(),x=(0,c.useCallback)(async()=>{u(l,[]),t.deselectAll()},[u,t,l]);return(0,s.jsxs)(n.$nd,{"aria-label":"add host public keys to allowlist",tip:"Add host public keys to allowlist",onClick:()=>{d({title:"Add ".concat((0,r.td)(t.selectionCount,"host")," to allowlist"),action:"Add to allowlist",variant:"accent",body:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to add"," ",(0,r.td)(t.selectionCount,"host public key")," to the allowlist?"]})}),onConfirm:x})},children:[(0,s.jsx)(a.puB,{}),"Add hosts to allowlist"]})}},98497:(e,t,l)=>{"use strict";l.d(t,{s:()=>o});var s=l(6029),n=l(59617),a=l(4968),c=l(56523),i=l(55729),r=l(32708);function o(e){let{multiSelect:t,publicKeys:l}=e,o=(0,c.FF)(),d=(0,i.useCallback)(async()=>{await (0,n.qBJ)(l.map(e=>o.post({params:{hostkey:e},payload:{timeout:(0,r.DM)(30)}})),{toastError:e=>{let{successCount:t,errorCount:l,totalCount:s}=e;return{title:"Rescanning ".concat((0,r.td)(t,"host")),body:"Error starting rescan for ".concat(l,"/").concat(s," of total hosts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"Rescanning ".concat((0,r.td)(t,"host"))}},after:()=>{t.deselectAll()}})},[t,l,o]);return(0,s.jsx)(n.$nd,{"aria-label":"rescan selected hosts",tip:"Rescan selected hosts",onClick:d,children:(0,s.jsx)(a.PcB,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[634,636,593,792],()=>t(21452)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[438],{98292:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/autopilot",function(){return i(61510)}])},20508:function(e,t,i){"use strict";i.d(t,{Lo:function(){return s},Pg:function(){return c},VN:function(){return l}});var a=i(52322),n=i(66741),r=i(6391),o=i.n(r);i(2784);let s=6,c={contractSet:"",maxRpcPrice:void 0,maxStoragePrice:void 0,maxContractPrice:void 0,maxDownloadPrice:void 0,maxUploadPrice:void 0,minMaxCollateral:void 0,hostBlockHeightLeeway:void 0,minPriceTableValidity:void 0,minAccountExpiry:void 0,minMaxEphemeralAccountBalance:void 0,minShards:void 0,totalShards:void 0};function l(e){let{storageAverage:t,uploadAverage:i,downloadAverage:r,contractAverage:c}=e;return{contractSet:{category:"contractset",type:"text",title:"Default contract set",placeholder:"autopilot",suggestion:"autopilot",suggestionTip:(0,a.jsx)(a.Fragment,{children:"Autopilot users will typically want to keep this the same as the autopilot contract set."}),description:(0,a.jsx)(a.Fragment,{children:"The default contract set is where data is uploaded or migrated to by default."}),validation:{required:"required"}},maxStoragePrice:{category:"gouging",type:"siacoin",title:"Max storage price",description:(0,a.jsx)(a.Fragment,{children:"The max allowed price to store 1 TB per month."}),units:"SC/TB/month",average:t,averageTip:"Please note that the average price is adjusted based on the renter's redundancy settings. Averages provided by Sia Central.",decimalsLimitSc:s,validation:{required:"required"}},maxDownloadPrice:{category:"gouging",type:"siacoin",title:"Max download price",description:(0,a.jsx)(a.Fragment,{children:"The max allowed price to download 1 TB."}),units:"SC/TB/month",average:r,averageTip:"Please note that the average price is adjusted based on the renter's redundancy settings. Averages provided by Sia Central.",decimalsLimitSc:s,validation:{required:"required"}},maxUploadPrice:{category:"gouging",type:"siacoin",title:"Max upload price",description:(0,a.jsx)(a.Fragment,{children:"The max allowed price to upload 1 TB."}),units:"SC/TB/month",average:i,averageTip:"Please note that the average price is adjusted based on the renter's redundancy settings. Averages provided by Sia Central.",decimalsLimitSc:s,validation:{required:"required"}},maxContractPrice:{category:"gouging",type:"siacoin",title:"Max contract price",description:(0,a.jsx)(a.Fragment,{children:"The max allowed price to form a contract."}),average:c,decimalsLimitSc:s,tipsDecimalsLimitSc:3,validation:{required:"required"}},maxRpcPrice:{category:"gouging",type:"siacoin",title:"Max RPC price",description:(0,a.jsx)(a.Fragment,{children:"The max allowed base price for RPCs in siacoins per million calls."}),units:"SC/million",decimalsLimitSc:s,validation:{required:"required"}},minMaxCollateral:{category:"gouging",type:"siacoin",title:"Min max collateral",description:(0,a.jsx)(a.Fragment,{children:"The min value for max collateral in the host's price settings."}),decimalsLimitSc:s,validation:{required:"required"}},hostBlockHeightLeeway:{category:"gouging",type:"number",title:"Block height leeway",description:(0,a.jsx)(a.Fragment,{children:"The amount of blocks of leeway given to the host block height in the host's price table."}),units:"blocks",decimalsLimit:0,suggestion:new(o())(6),suggestionTip:"The recommended value is 6 blocks.",validation:{required:"required",validate:{min:e=>new(o())(e).gte(3)||"must be at least 3 blocks"}}},minPriceTableValidity:{category:"gouging",type:"number",title:"Min price table validity",units:"minutes",description:(0,a.jsx)(a.Fragment,{children:"The min accepted value for `Validity` in the host's price settings."}),validation:{required:"required",validate:{min:e=>new(o())(e).gte((0,n.GXN)(10))||"must be at least 10 seconds"}}},minAccountExpiry:{category:"gouging",type:"number",title:"Min account expiry",units:"days",description:(0,a.jsx)(a.Fragment,{children:"The min accepted value for `AccountExpiry` in the host's price settings."}),validation:{required:"required",validate:{min:e=>new(o())(e).gte((0,n.XAn)(1))||"must be at least 1 hour"}}},minMaxEphemeralAccountBalance:{category:"gouging",type:"siacoin",title:"Min max ephemeral account balance",description:(0,a.jsx)(a.Fragment,{children:"The min accepted value for `MaxEphemeralAccountBalance` in the host's price settings."}),decimalsLimitSc:s,validation:{required:"required",validate:{min:e=>new(o())(e).gte(1)||"must be at least 1 SC"}}},minShards:{type:"number",category:"redundancy",title:"Min shards",description:(0,a.jsx)(a.Fragment,{children:"The min amount of shards needed to reconstruct a slab."}),units:"shards",validation:{required:"required",validate:{min:e=>new(o())(e).gt(0)||"must be greater than 0"}},trigger:["totalShards"]},totalShards:{type:"number",category:"redundancy",title:"Total shards",description:(0,a.jsx)(a.Fragment,{children:"The total amount of shards for each slab."}),units:"shards",validation:{required:"required",validate:{gteMinShards:(e,t)=>new(o())(e).gte(t.minShards)||"must be at least equal to min shards",max:e=>new(o())(e).lt(256)||"must be less than 256"}}}}}},85246:function(e,t,i){"use strict";i.d(t,{IP:function(){return u},MN:function(){return l},Y$:function(){return d},y4:function(){return c}});var a=i(66741),n=i(2288),r=i(6391),o=i.n(r),s=i(20508);function c(e,t){return{...t,default:e.contractSet}}function l(e,t){return{...t,maxRPCPrice:(0,n.qN)(e.maxRpcPrice.div(1e6)).toString(),maxStoragePrice:(0,n.qN)(e.maxStoragePrice.div((0,a.S5V)(1)).div((0,a.xf5)(1))).toString(),maxContractPrice:(0,n.qN)(e.maxContractPrice).toString(),maxDownloadPrice:(0,n.qN)(e.maxDownloadPrice).toString(),maxUploadPrice:(0,n.qN)(e.maxUploadPrice).toString(),minMaxCollateral:(0,n.qN)(e.minMaxCollateral).toString(),hostBlockHeightLeeway:Math.round(e.hostBlockHeightLeeway.toNumber()),minPriceTableValidity:Math.round((0,a.ort)(e.minPriceTableValidity.toNumber())),minAccountExpiry:Math.round((0,a.k9c)(e.minAccountExpiry.toNumber())),minMaxEphemeralAccountBalance:(0,n.qN)(e.minMaxEphemeralAccountBalance).toString()}}function d(e,t){return{...t,minShards:e.minShards.toNumber(),totalShards:e.totalShards.toNumber()}}function u(e,t,i){return{contractSet:e.default,maxStoragePrice:(0,n.ll)(new(o())(t.maxStoragePrice).times((0,a.S5V)(1)).times((0,a.xf5)(1)),s.Lo),maxDownloadPrice:(0,n.ll)(t.maxDownloadPrice,s.Lo),maxUploadPrice:(0,n.ll)(t.maxUploadPrice,s.Lo),maxContractPrice:(0,n.ll)(t.maxContractPrice,s.Lo),maxRpcPrice:(0,n.ll)(t.maxRPCPrice,s.Lo).times(1e6),minMaxCollateral:(0,n.ll)(t.minMaxCollateral,s.Lo),hostBlockHeightLeeway:new(o())(t.hostBlockHeightLeeway),minPriceTableValidity:new(o())((0,a.AEA)(t.minPriceTableValidity)),minAccountExpiry:new(o())((0,a.okB)(t.minAccountExpiry)),minMaxEphemeralAccountBalance:(0,n.ll)(t.minMaxEphemeralAccountBalance,s.Lo),minShards:new(o())(i.minShards),totalShards:new(o())(i.totalShards)}}},16133:function(e,t,i){"use strict";i.d(t,{J:function(){return m}});var a=i(52322),n=i(66741),r=i(73621),o=i(6391),s=i.n(o),c=i(74881),l=i(41491),d=i(30650);function u(){var e,t;let{openDialog:i}=(0,d.Rh)(),o=(0,r.gM)({config:{swr:{revalidateOnFocus:!1}}}),s=(0,r.GJ)({config:{swr:{revalidateOnFocus:!1}}}),c=(0,r.cQ)(),u=(0,l.n)();return(0,a.jsxs)(n.HfT,{name:"renterd",peerCount:null===(e=c.data)||void 0===e?void 0:e.length,connectPeer:()=>i("connectPeer"),isSynced:u.isSynced,percent:u.percent,nodeBlockHeight:u.nodeBlockHeight,estimatedBlockHeight:u.estimatedBlockHeight,firstTimeSyncing:u.firstTimeSyncing,moreThan100BlocksToSync:u.moreThan100BlocksToSync,children:[(0,a.jsxs)("div",{className:"flex gap-4 justify-between items-center",children:[(0,a.jsx)(n.__J,{size:"14",color:"subtle",noWrap:!0,className:"w-[100px]",children:"Wallet address"}),(0,a.jsx)(n.xS1,{className:"overflow-hidden",size:"14",maxLength:50,value:s.data,type:"address"})]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-between items-center",children:[(0,a.jsx)(n.__J,{size:"14",color:"subtle",noWrap:!0,className:"w-[100px]",children:"Network"}),(0,a.jsx)(n.xvT,{size:"14",children:null===(t=o.data)||void 0===t?void 0:t.Name})]})]})}function m(e){let t=(0,r.tM)(),{isSynced:i}=(0,l.n)();return(0,a.jsx)(n.tU3,{appName:"renterd",profile:(0,a.jsx)(u,{}),connectivityRoute:c.h,isSynced:i,walletBalance:t.data?new(s())(t.data):void 0,...e})}},15755:function(e,t,i){"use strict";i.d(t,{e:function(){return s}});var a=i(52322),n=i(66741),r=i(74881),o=i(49227);function s(){let{autopilotMode:e}=(0,o.K)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.KJW,{title:"Files",route:r._.files.index,children:(0,a.jsx)(n.ROc,{})}),"on"===e&&(0,a.jsx)(n.KJW,{title:"Autopilot",route:r._.autopilot.index,children:(0,a.jsx)(n.aFQ,{})}),(0,a.jsx)(n.KJW,{title:"Configuration",route:r._.config.index,children:(0,a.jsx)(n.wWN,{})}),(0,a.jsx)(n.KJW,{title:"Contracts",route:r._.contracts.index,children:(0,a.jsx)(n.VBo,{})}),(0,a.jsx)(n.KJW,{title:"Hosts",route:r._.hosts.index,children:(0,a.jsx)(n.VHe,{})})]})}},40121:function(e,t,i){"use strict";i.d(t,{a:function(){return n}});var a=i(73621);function n(e){return(0,a.yu)({...e,params:{key:"contractset"}})}},41491:function(e,t,i){"use strict";i.d(t,{n:function(){return r}});var a=i(28031),n=i(73621);function r(){var e,t;let{isUnlocked:i}=(0,a.Hv)(),r=(0,n.DQ)({config:{swr:{refreshInterval:e=>(null==e?void 0:e.synced)?6e4:1e4}}}),o=(0,n.nH)(),s=r.data?null===(e=r.data)||void 0===e?void 0:e.blockHeight:0,c=i&&s&&o?Number((100*Math.min(s/o,1)).toFixed(1)):0;return{isSynced:null===(t=r.data)||void 0===t?void 0:t.synced,nodeBlockHeight:s,estimatedBlockHeight:o,percent:c,moreThan100BlocksToSync:!!s&&!!o&&o-s>100,firstTimeSyncing:!!s&&!!o&&o-s>5e4}}},61510:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return b}});var a=i(52322),n=i(66741),r=i(6391),o=i.n(r),s=i(2784),c=i(15755),l=i(74881),d=i(30650),u=i(16133),m=i(73621),h=i(2288);let g={set:"",amount:void 0,allowance:void 0,period:void 0,renewWindow:void 0,download:void 0,upload:void 0,storage:void 0,allowRedundantIPs:!1,maxDowntimeHours:void 0,defragThreshold:void 0},p={storage:{type:"number",category:"contracts",title:"Expected storage",description:(0,a.jsx)(a.Fragment,{children:"The amount of storage you would like to rent in TB."}),units:"TB",validation:{required:"required"}},upload:{type:"number",category:"contracts",title:"Expected upload",description:(0,a.jsx)(a.Fragment,{children:"The amount of upload bandwidth you plan to use each period in TB."}),units:"TB/period",validation:{required:"required"}},download:{type:"number",category:"contracts",title:"Expected download",description:(0,a.jsx)(a.Fragment,{children:"The amount of download bandwidth you plan to use each period in TB."}),units:"TB/period",validation:{required:"required"}},allowance:{type:"siacoin",category:"contracts",title:"Allowance",description:(0,a.jsx)(a.Fragment,{children:"The amount of Siacoin you would like to spend for the period."}),decimalsLimitSc:6,validation:{required:"required"}},period:{type:"number",category:"contracts",title:"Period",description:(0,a.jsx)(a.Fragment,{children:"The length of the storage contracts."}),units:"weeks",suggestion:new(o())(6),suggestionTip:"Typically 6 weeks.",validation:{required:"required"}},renewWindow:{type:"number",category:"contracts",title:"Renew window",description:(0,a.jsx)(a.Fragment,{children:"The number of weeks prior to contract expiration that Sia will attempt to renew your contracts."}),units:"weeks",decimalsLimit:6,suggestion:new(o())(2),suggestionTip:"Typically 2 weeks.",validation:{required:"required"}},amount:{type:"number",category:"contracts",title:"Hosts",description:(0,a.jsx)(a.Fragment,{children:"The number of hosts to create contracts with."}),units:"hosts",decimalsLimit:0,suggestion:new(o())(50),suggestionTip:"Typically 50 hosts.",validation:{required:"required"}},set:{type:"text",category:"contracts",title:"Contract set",description:(0,a.jsx)(a.Fragment,{children:"The contract set that autopilot should use. This should typically be the same as the default contract set."}),placeholder:"autopilot",suggestion:"autopilot",suggestionTip:(0,a.jsxs)(a.Fragment,{children:["The default contract set is ",(0,a.jsx)(n.EKh,{children:"autopilot"}),"."]}),validation:{required:"required"}},allowRedundantIPs:{type:"boolean",category:"hosts",title:"Redundant IPs",description:(0,a.jsx)(a.Fragment,{children:"Whether or not to allow forming contracts with multiple hosts in the same IP subnet. The subnets used are /16 for IPv4, and /64 for IPv6."}),suggestion:!1,suggestionTip:"Defaults to off.",validation:{}},maxDowntimeHours:{type:"number",category:"hosts",title:"Max downtime",description:(0,a.jsx)(a.Fragment,{children:"The maximum amount of host downtime that autopilot will tolerate in hours."}),units:"hours",suggestion:new(o())(1440),suggestionTip:"Defaults to 1,440 which is 60 days.",validation:{required:"required"}},defragThreshold:{type:"number",category:"wallet",title:"Defrag threshold",description:(0,a.jsx)(a.Fragment,{children:"The threshold after which autopilot will defrag outputs."}),units:"outputs",suggestion:new(o())(1e3),suggestionTip:"Defaults to 1,000.",validation:{required:"required"}}};var x=i(63955),v=i(12797),w=i(85246),f=i(40121);function y(){let{openDialog:e}=(0,d.Rh)(),t=(0,m.oe)(),i=(0,m.e$)({config:{swr:{revalidateOnFocus:!1}}}),{shouldSyncDefaultContractSet:r,setShouldSyncDefaultContractSet:y,syncDefaultContractSet:b}=function(){let[e,t]=(0,v.Z)("v0/autopilot/syncDefaultContractSet",{defaultValue:!0}),i=(0,f.a)(),r=(0,m.KJ)(),o=(0,s.useCallback)(async t=>{let o=i.data;try{e&&t!==o.default&&(await r.put({params:{key:"contractset"},payload:(0,w.y4)({contractSet:t},i.data)}),i.mutate(),(0,n.OPV)((0,a.jsxs)(n.xvT,{children:["Default contract set has been updated to:"," ",(0,a.jsx)(n.EKh,{children:t}),"."]})))}catch(s){(0,n.OHV)(s.message),console.log(s)}},[i.data,r,e]);return{shouldSyncDefaultContractSet:e,setShouldSyncDefaultContractSet:t,syncDefaultContractSet:o}}(),j=(0,x.cI)({mode:"all",defaultValues:g}),T=(0,s.useCallback)(e=>{j.reset(function(e){let t=e.contracts.set,i=(0,h.ll)(e.contracts.allowance,6),a=new(o())(e.contracts.amount),r=new(o())((0,n.x5w)(e.contracts.period)),s=new(o())((0,n.x5w)(e.contracts.renewWindow)),c=(0,n.JWi)(new(o())(e.contracts.download)),l=(0,n.JWi)(new(o())(e.contracts.upload)),d=(0,n.JWi)(new(o())(e.contracts.storage));return{set:t,allowance:i,amount:a,period:r,renewWindow:s,download:c,upload:l,storage:d,allowRedundantIPs:e.hosts.allowRedundantIPs,maxDowntimeHours:new(o())(e.hosts.maxDowntimeHours),defragThreshold:new(o())(e.wallet.defragThreshold)}}(e))},[j]),[S,P]=(0,s.useState)(!1);(0,s.useEffect)(()=>{var e;if(i.data&&!S){T(i.data),P(!0);return}if((null===(e=i.error)||void 0===e?void 0:e.status)===404&&!S){j.reset(g),P(!0);return}},[i.data,i.error]);let q=(0,s.useCallback)(async()=>{let e=await i.mutate();e?T(e):(0,n.OHV)("Error fetching config.")},[i,T]),k=(0,s.useCallback)(async e=>{try{var a;await t.put({payload:{...a=i.data,contracts:{...null==a?void 0:a.contracts,set:e.set,amount:Math.round(e.amount.toNumber()),allowance:(0,h.qN)(e.allowance).toString(),period:Math.round((0,n.mvJ)(e.period.toNumber())),renewWindow:Math.round((0,n.mvJ)(e.renewWindow.toNumber())),download:(0,n.xf5)(e.download).toNumber(),upload:(0,n.xf5)(e.upload).toNumber(),storage:(0,n.xf5)(e.storage).toNumber()},hosts:{...null==a?void 0:a.hosts,maxDowntimeHours:e.maxDowntimeHours.toNumber(),allowRedundantIPs:e.allowRedundantIPs,scoreOverrides:(null==a?void 0:a.hosts.scoreOverrides)||null},wallet:{...null==a?void 0:a.wallet,defragThreshold:e.defragThreshold.toNumber()}}}),(0,n.OPV)("Configuration has been saved."),b(e.set),q()}catch(r){(0,n.OHV)(r.message),console.log(r)}},[i.data,t,q,b]),N=(0,n.WsO)(p),C=(0,s.useMemo)(()=>j.handleSubmit(k,N),[j,k,N]),M=j.watch("storage"),B=j.watch("period"),F=j.watch("allowance"),E=(0,s.useMemo)(()=>!(!M||!B||!F||M.isZero()||B.isZero()||F.isZero()),[M,B,F]),L=(0,s.useMemo)(()=>{if(!E)return new(o())(0);let e=F.div(B),t=e.div(7).times(30);return(0,h.IZ)(t,0)},[E,B,F]),H=Object.entries(j.formState.dirtyFields).filter(e=>{let[t,i]=e;return!!i}).length,{fiat:A,currency:_}=(0,n.fb0)({sc:L});return(0,a.jsx)(u.J,{title:"Autopilot",routes:l._,sidenav:(0,a.jsx)(c.e,{}),stats:E?(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(n.xvT,{size:"12",font:"mono",weight:"medium",children:"Estimate:"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(n.YKL,{size:"12",value:(0,h.qN)(L),dynamicUnits:!1,fixed:0,variant:"value"}),A&&(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)(n.m2c,{size:"12",weight:"medium",value:A,color:"subtle",variant:"value",format:e=>"(".concat(_.prefix).concat(e.toFixed(_.fixed),")")})}),(0,a.jsxs)(n.xvT,{size:"12",font:"mono",weight:"medium",children:["per month to store ",(0,h.vW)((0,n.xf5)(M).toNumber())]})]})]}):(0,a.jsx)(n.xvT,{size:"12",font:"mono",weight:"medium",children:"Enter expected storage, period, and allowance values to estimate monthly spending."}),actions:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!!H&&(0,a.jsx)(n.xvT,{size:"12",color:"subtle",children:1===H?"1 change":"".concat(H," changes")}),(0,a.jsx)(n.zxk,{tip:"Reset all changes",icon:"contrast",disabled:!H,onClick:q,children:(0,a.jsx)(n.Wet,{})}),(0,a.jsxs)(n.eQh,{children:[(0,a.jsxs)(n.zxk,{tip:"Save all changes",variant:"accent",disabled:!j.formState.isDirty||j.formState.isSubmitting,onClick:C,children:[(0,a.jsx)(n.ZEk,{}),"Save changes"]}),(0,a.jsx)(n.J2e,{contentProps:{align:"end"},trigger:(0,a.jsx)(n.zxk,{variant:"accent",icon:"hover",children:(0,a.jsx)(n.shL,{})}),children:(0,a.jsxs)("div",{className:"px-1",children:[(0,a.jsx)(n.__J,{children:"Options"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(n.q_s,{checked:r,onCheckedChange:e=>y(e),children:"sync default contract set"}),(0,a.jsx)(n.nvN,{size:"12",children:"Automatically update the default contract set to be the same as the autopilot contract set when changes are saved."})]})]})})]})]}),openSettings:()=>e("settings"),children:(0,a.jsxs)("div",{className:"px-5 py-6 flex flex-col gap-16 max-w-screen-xl",children:[(0,a.jsx)(n.vRO,{title:"Contracts",category:"contracts",fields:p,form:j}),(0,a.jsx)(n.vRO,{title:"Hosts",category:"hosts",fields:p,form:j}),(0,a.jsx)(n.vRO,{title:"Wallet",category:"wallet",fields:p,form:j})]})})}function b(){return(0,a.jsx)(y,{})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=98292)}),_N_E=e.O()}]);
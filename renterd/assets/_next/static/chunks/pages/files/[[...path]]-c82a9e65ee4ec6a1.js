(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[958],{38345:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/files/[[...path]]",function(){return t(14278)}])},89630:function(e,s,t){"use strict";t.d(s,{J:function(){return h}});var n=t(52322),l=t(80446),i=t(9969),a=t(6391),r=t.n(a),c=t(71930),o=t(25573),d=t(86450);function x(){var e,s,t,a,r;let{openDialog:c}=(0,d.Rh)(),x=(0,i.d_)({config:{swr:{revalidateOnFocus:!1}}}),u=(0,i.Tu)({config:{swr:{revalidateOnFocus:!1}}}),h=(0,i.cQ)(),j=(0,o.n)(),f=null===(e=x.data)||void 0===e?void 0:e.version,v="?"===f?"https://github.com/SiaFoundation/renterd/commits/":(null==f?void 0:f.match(/^v\d+\.\d+\.\d+/))?"https://github.com/SiaFoundation/renterd/releases/".concat(f):"https://github.com/SiaFoundation/renterd/tree/".concat(f);return(0,n.jsxs)(l.HfT,{name:"renterd",peerCount:null===(s=h.data)||void 0===s?void 0:s.length,connectPeer:()=>c("connectPeer"),isSynced:j.isSynced,syncPercent:j.syncPercent,nodeBlockHeight:j.nodeBlockHeight,estimatedBlockHeight:j.estimatedBlockHeight,firstTimeSyncing:j.firstTimeSyncing,moreThan100BlocksToSync:j.moreThan100BlocksToSync,children:[(0,n.jsxs)("div",{className:"flex gap-4 justify-between items-center",children:[(0,n.jsx)(l.__J,{size:"14",color:"subtle",noWrap:!0,className:"w-[100px]",children:"Wallet address"}),(0,n.jsx)(l.XxW,{className:"overflow-hidden",size:"14",maxLength:50,value:null===(t=u.data)||void 0===t?void 0:t.address,type:"address"})]}),(0,n.jsxs)("div",{className:"flex gap-4 justify-between items-center",children:[(0,n.jsx)(l.__J,{size:"14",color:"subtle",noWrap:!0,className:"w-[100px]",children:"Network"}),(0,n.jsx)("div",{className:"flex-1 flex justify-end overflow-hidden",children:(0,n.jsx)(l.xvT,{size:"14",children:null===(a=x.data)||void 0===a?void 0:a.network})})]}),(0,n.jsxs)("div",{className:"flex gap-4 justify-between items-center",children:[(0,n.jsx)(l.__J,{size:"14",color:"subtle",noWrap:!0,className:"w-[100px]",children:"Version"}),(0,n.jsx)(l.rUS,{size:"14",href:v,underline:"hover",target:"_blank",ellipsis:!0,children:null===(r=x.data)||void 0===r?void 0:r.version})]})]})}function u(){let e=(0,i.d_)({config:{swr:{revalidateOnFocus:!1}}});return e.data&&"Mainnet"!==e.data.network?(0,n.jsx)(l.t6k,{testnetName:e.data.network}):null}function h(e){let s=(0,i.Tu)(),{isSynced:t}=(0,o.n)();return(0,n.jsx)(l.tU3,{appName:"renterd",profile:(0,n.jsx)(x,{}),banner:(0,n.jsx)(u,{}),connectivityRoute:c.h,isSynced:t,walletBalanceSc:s.data&&{spendable:new(r())(s.data.spendable),confirmed:new(r())(s.data.confirmed),unconfirmed:new(r())(s.data.unconfirmed)},...e})}},91930:function(e,s,t){"use strict";t.d(s,{e:function(){return d}});var n=t(52322),l=t(80446),i=t(88242),a=t(9969),r=t(82851),c=t(71930),o=t(86450);function d(){var e,s;let t=(0,a.Z7)(),{openDialog:d}=(0,o.Rh)(),x=!(null===(e=t.data)||void 0===e?void 0:e.find(e=>"info"!==e.severity)),u=(null===(s=t.data)||void 0===s?void 0:s.length)||0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.KJW,{title:"Files",route:c._.files.index,children:(0,n.jsx)(i.ROc,{})}),(0,n.jsx)(l.KJW,{title:"Configuration",route:c._.config.index,children:(0,n.jsx)(i.wWN,{})}),(0,n.jsx)(l.KJW,{title:"Contracts",route:c._.contracts.index,children:(0,n.jsx)(i.VBo,{})}),(0,n.jsx)(l.KJW,{title:"Hosts",route:c._.hosts.index,children:(0,n.jsx)(i.VHe,{})}),(0,n.jsxs)("div",{className:"relative",children:[!!u&&x&&(0,n.jsx)("div",{className:(0,r.cx)("absolute -right-[2px] top-px w-1 h-1","rounded-full","bg-gray-1000 dark:bg-white","pointer-events-none")}),!!u&&!x&&(0,n.jsx)(l.xvT,{size:"10",className:(0,r.cx)("absolute -right-[9px] -top-1 py-px px-[5px]","text-white","bg-red-500 dark:bg-red-500 rounded","pointer-events-none"),color:"none",children:u.toLocaleString()}),(0,n.jsx)(l.KJW,{title:"Alerts",onClick:()=>d("alerts"),children:(0,n.jsx)(i.Dkj,{})})]})]})}},14278:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return D}});var n=t(52322),l=t(91930),i=t(71930),a=t(86450),r=t(80446),c=t(48528),o=t(88242),d=t(9969),x=t(91641);function u(){let{autopilot:e}=(0,x.q)(),s=(0,d.e$)({config:{swr:{errorRetryCount:0}}});return{active:"on"===e.status&&!!s.error}}var h=t(4370);function j(){return(0,n.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,n.jsx)(r.xvT,{children:(0,n.jsx)(o.Ckx,{className:"scale-[200%]"})}),(0,n.jsx)(r.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching files."})]})}function f(){return(0,n.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,n.jsx)(r.xvT,{children:(0,n.jsx)(o.Hb6,{className:"scale-[200%]"})}),(0,n.jsx)(r.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No files matching filters."})]})}function v(){return(0,n.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px] cursor-pointer",children:[(0,n.jsx)(r.xvT,{children:(0,n.jsx)(o.Y9T,{className:"scale-[200%]"})}),(0,n.jsx)(r.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No files, drag and drop files or click here to start uploading."})]})}function m(){let{dataState:e,isViewingRootOfABucket:s}=(0,c.Y)(),t=u(),l=(0,h.F)();return"noneMatchingFilters"===e?(0,n.jsx)(f,{}):"error"===e?(0,n.jsx)(j,{}):s&&"noneYet"===e&&t.active?(0,n.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px] cursor-pointer",children:[(0,n.jsx)(r.xvT,{children:(0,n.jsx)(o.Y9T,{className:"scale-[200%]"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-6 justify-center items-center",children:[(0,n.jsxs)(r.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:["Before you can upload files you must configure your settings. Once configured, ",(0,n.jsx)(r.EKh,{children:"renterd"})," will find contracts with hosts based on the settings you choose. ",(0,n.jsx)(r.EKh,{children:"renterd"})," will also repair your data as hosts come and go."]}),(0,n.jsx)(r.Qjf,{variant:"accent",href:i._.config.index,children:"Configure"})]})]}):s&&"noneYet"===e&&l.active?(0,n.jsxs)("div",{className:"flex flex-col gap-12 justify-center items-center h-[400px] cursor-pointer",children:[(0,n.jsx)(r.xvT,{children:(0,n.jsx)(o.Y9T,{className:"scale-[200%]"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-4 justify-center items-center",children:[(0,n.jsxs)(r.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:["There are not enough contracts to upload data yet. Redundancy is configured to use ",l.required," shards which means at least that many contracts are required."]}),(0,n.jsxs)(r.xvT,{size:"30",className:"text-center max-w-[500px]",children:[l.count,"/",l.required]})]})]}):"noneYet"===e?(0,n.jsx)(v,{}):null}function p(){let{isViewingABucket:e}=(0,c.Y)(),s=u(),t=(0,h.F)();return e&&!s.active&&!t.active}function g(){let{uploadFiles:e,datasetPage:s,pageCount:t,dataState:l,columns:i,sortField:a,sortDirection:o,sortableColumns:d,toggleSort:x}=(0,c.Y)(),u=p();return(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(r.fhJ,{onDrop:e,noClick:!u||t>0,noDrag:!u,children:(0,n.jsx)(r.iA_,{isLoading:"loading"===l,emptyState:(0,n.jsx)(m,{}),pageSize:10,data:s,columns:i,sortableColumns:d,sortField:a,sortDirection:o,toggleSort:x,rowSize:"dense"})})})}var b=t(2784);function N(){let{activeDirectory:e,setActiveDirectory:s}=(0,c.Y)(),t=(0,b.useRef)(null);return(0,b.useEffect)(()=>{let e=setTimeout(()=>{var e;null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);return()=>{clearTimeout(e)}},[e]),(0,n.jsx)(r.xrM,{children:(0,n.jsxs)("div",{className:"flex gap-1 items-center h-full",children:[(0,n.jsx)(r.xvT,{onClick:()=>s(()=>[]),size:"18",weight:"semibold",className:"flex items-center cursor-pointer",noWrap:!0,children:"Files"}),e.length>0&&(0,n.jsx)(r.xvT,{size:"16",color:"verySubtle",className:"flex items-center",children:(0,n.jsx)(o.F3j,{})}),e.map((e,t)=>(0,n.jsxs)(b.Fragment,{children:[t>0&&(0,n.jsx)(r.xvT,{size:"16",color:"verySubtle",className:"flex items-center",children:(0,n.jsx)(o.F3j,{})}),(0,n.jsx)(r.xvT,{onClick:()=>s(e=>e.slice(0,t+1)),size:"18",weight:"semibold",className:"flex items-center cursor-pointer",noWrap:!0,children:e})]},e+t)),(0,n.jsx)("div",{ref:t})]})})}var w=t(89630),T=t(74424),z=t(81471),y=t(3440),k=t.n(y);function S(){let{configurableColumns:e,toggleColumnVisibility:s,resetDefaultColumnVisibility:t,sortField:l,setSortField:i,sortDirection:a,setSortDirection:d,enabledColumns:x}=(0,c.Y)();return(0,n.jsxs)(r.J2e,{trigger:(0,n.jsxs)(r.zxk,{size:"small",tip:"Configure view",tipAlign:"end",children:[(0,n.jsx)(o.hiv,{}),"View",(0,n.jsx)(o.EMN,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,n.jsxs)(r.WVB,{children:[(0,n.jsx)(r.__J,{children:"Order by"}),(0,n.jsx)(r.kFS,{children:(0,n.jsx)(r.PhF,{value:l,onChange:e=>{i(e.currentTarget.value)},children:Object.entries(k()(z.Fo,"category")).map(e=>{let[s,t]=e;return(0,n.jsx)("optgroup",{label:s,children:t.map(e=>(0,n.jsx)(r.Wxm,{value:e.id,children:e.label},e.id))},s)})})})]}),(0,n.jsxs)(r.WVB,{children:[(0,n.jsx)(r.__J,{children:"Direction"}),(0,n.jsx)(r.kFS,{children:(0,n.jsxs)(r.PhF,{value:a,onClick:e=>{e.stopPropagation()},onChange:e=>{d(e.currentTarget.value)},children:[(0,n.jsx)(r.Wxm,{value:"desc",children:"descending"},"desc"),(0,n.jsx)(r.Wxm,{value:"asc",children:"ascending"},"asc")]})})]}),(0,n.jsx)(r.Clw,{}),(0,n.jsxs)(r.WVB,{children:[(0,n.jsx)(r.__J,{children:"Display properties"}),(0,n.jsx)(r.kFS,{children:(0,n.jsx)(r.zxk,{onClick:e=>{e.stopPropagation(),t()},children:"Reset default"})})]}),(0,n.jsx)(r.WVB,{children:(0,n.jsx)(r.j4H,{options:e.map(e=>({label:e.label,value:e.id})),values:x,onChange:e=>s(e)})})]})}function F(){let{openDialog:e}=(0,a.Rh)(),{uploadFiles:s,isViewingBuckets:t}=(0,c.Y)(),l=p(),{getRootProps:i,getInputProps:d}=(0,T.uI)({noDrag:!0,noClick:!l,onDrop:s});return(0,n.jsxs)("div",{className:"flex gap-2",children:[t?(0,n.jsxs)(r.zxk,{onClick:()=>e("filesCreateBucket"),tip:"Create bucket",children:[(0,n.jsx)(o.aXP,{}),"Create bucket"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.zxk,{onClick:()=>e("filesSearch"),tip:"Search files",children:(0,n.jsx)(o.UBs,{})}),(0,n.jsxs)(r.zxk,{...i(),tip:"Upload files",disabled:!l,children:[(0,n.jsx)("input",{...d()}),(0,n.jsx)(o.bQp,{})]}),(0,n.jsx)(r.zxk,{disabled:!l,onClick:()=>e("filesCreateDirectory"),tip:"Create directory",children:(0,n.jsx)(o.L37,{})})]}),(0,n.jsx)(S,{})]})}var _=t(96206);function C(){let e=(0,d.Q5)({config:{swr:{refreshInterval:6e4,keepPreviousData:!0,revalidateOnFocus:!1}}});if(!e.data&&e.isValidating)return(0,n.jsx)(r.xgg,{className:"pr-1"});if(!e.data)return null;let s=e.data.totalObjectsSize?e.data.totalSectorsSize/e.data.totalObjectsSize:0;return(0,n.jsx)(r.ua7,{side:"bottom",content:(0,n.jsxs)(r.xvT,{className:"flex justify-between gap-6",children:[(0,n.jsxs)(r.xvT,{className:"flex flex-col gap-1",children:[(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"size of all files"}),(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"with redundancy"}),!!s&&(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"average redundancy factor"}),(0,n.jsx)(r.Z0O,{className:"w-full my-1"}),(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"reclaimable space"}),(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"total storage utilization"})]}),(0,n.jsxs)(r.xvT,{className:"flex flex-col gap-1 items-end",children:[(0,n.jsx)(r.xvT,{size:"12",children:(0,_.vW)(e.data.totalObjectsSize)}),(0,n.jsx)(r.xvT,{size:"12",children:(0,_.vW)(e.data.totalSectorsSize)}),!!s&&(0,n.jsxs)(r.xvT,{size:"12",font:"mono",children:[s.toFixed(1),"x"]}),(0,n.jsx)(r.Z0O,{className:"w-full my-1"}),(0,n.jsx)(r.xvT,{size:"12",children:(0,_.vW)(e.data.totalUploadedSize-e.data.totalSectorsSize)}),(0,n.jsx)(r.xvT,{size:"12",children:(0,_.vW)(e.data.totalUploadedSize)})]})]}),children:(0,n.jsx)(r.xvT,{size:"12",font:"mono",children:"".concat((0,_.vW)(e.data.totalObjectsSize)).concat(s?" @ ".concat(s.toFixed(1),"x"):"")})})}var W=t(82439);function O(){var e;let{activeBucket:s}=(0,c.Y)(),t=(0,d.Jv)({disabled:!s,params:{key:"",bucket:s},config:{swr:{dedupingInterval:5e3}}}),l=(0,b.useMemo)(()=>{var e,s,n,l;return null===(l=t.data)||void 0===l?void 0:null===(n=l.entries)||void 0===n?void 0:n.reduce((e,s)=>{let{health:t}=s;return t<e?t:e},(null===(s=t.data)||void 0===s?void 0:null===(e=s.entries[0])||void 0===e?void 0:e.health)||1)},[t.data]),{displayHealth:i,label:a}=(0,W.B)({health:l,size:1,isDirectory:!0});return s&&(null===(e=t.data)||void 0===e?void 0:e.entries)&&0!==t.data.entries.length?(0,n.jsx)(r.ua7,{align:"end",content:(0,n.jsxs)("div",{className:"flex flex-col overflow-hidden mb-1",children:[(0,n.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,n.jsx)(r.xvT,{size:"12",children:a}),(0,n.jsxs)(r.xvT,{size:"12",children:[(100*i).toFixed(0),"%"]})]}),(0,n.jsx)(r.Z0O,{className:"w-full my-1.5"}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"Health is calculated as the minimum health value from across all file slabs. For directories this is across all contained files."}),(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"Slab health is calculated as the number of shards with active contracts in the autopilot contract set above the minimum required shards and expressed as a percentage."})]}),(0,n.jsx)(r.Z0O,{className:"w-full my-1.5"}),(0,n.jsxs)("div",{className:"flex gap-3 justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"excellent health"}),(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"good health"}),(0,n.jsx)(r.xvT,{size:"12",color:"subtle",children:"poor health"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-1 items-end",children:[(0,n.jsxs)(r.xvT,{size:"12",color:"subtle",children:[100*W.V.excellent,"%"]}),(0,n.jsxs)(r.xvT,{size:"12",color:"subtle",children:[100*W.V.good,"% -"," ",100*W.V.excellent,"%"]}),(0,n.jsxs)(r.xvT,{size:"12",color:"subtle",children:[100*W.V.poor,"% - ",100*W.V.good,"%"]})]})]})]}),children:(0,n.jsx)(r.xvT,{size:"12",font:"mono",className:"flex",children:a})}):null}var V=t(80489);function B(){let e=function(){let{autopilot:e}=(0,x.q)(),s=function(){var e,s;let{autopilot:t}=(0,x.q)(),n=(0,d.e$)({disabled:"on"!==t.status}),l=(0,V.a)();return{isValidating:n.isValidating||l.isValidating,data:(null===(e=n.data)||void 0===e?void 0:e.contracts.set)===(null===(s=l.data)||void 0===s?void 0:s.default)}}(),t="on"===e.status&&!s.isValidating&&!s.data;return{active:t}}();return e.active?(0,n.jsx)(r.ua7,{align:"start",content:(0,n.jsx)(n.Fragment,{children:"The autopilot contract set does not match the default contract set. This means that by default workers will not upload data to contracts that autopilot manages. Unless these contract are being manually maintained, this will result in data loss. Continue with caution or update the autopilot contract set to match the default contract set."}),children:(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(r.xvT,{size:"12",font:"mono",weight:"medium",color:"amber",children:(0,n.jsx)(o.qdM,{})}),(0,n.jsx)(r.xvT,{size:"12",font:"mono",weight:"medium",color:"amber",children:"Uploaded data will not be managed by autopilot."})]})}):null}function J(){var e,s;let{isViewingABucket:t,pageCount:l}=(0,c.Y)(),i=(0,d.Q5)({config:{swr:{refreshInterval:6e4,keepPreviousData:!0,revalidateOnFocus:!1}}});return t?(0,n.jsx)(r.ua7,{side:"bottom",content:"Number of files in current directory",children:(0,n.jsxs)(r.xvT,{size:"12",font:"mono",children:[l.toLocaleString(),i.data?" of ".concat(null===(s=i.data)||void 0===s?void 0:s.numObjects.toLocaleString()," files"):" files"]})}):(0,n.jsx)(r.ua7,{side:"bottom",content:"Number of files across all buckets",children:i.data?(0,n.jsxs)(r.xvT,{size:"12",font:"mono",children:[null===(e=i.data)||void 0===e?void 0:e.numObjects.toLocaleString()," files"]}):(0,n.jsx)(r.xgg,{})})}function Y(){let{limit:e,offset:s,pageCount:t,dataState:l,isViewingABucket:i}=(0,c.Y)();return(0,n.jsxs)("div",{className:"flex gap-4 w-full",children:[(0,n.jsx)(B,{}),(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(r.ua7,{side:"bottom",content:"Filtered statistics",children:(0,n.jsx)(r.xvT,{size:"12",color:"verySubtle",children:(0,n.jsx)(o.q0D,{})})}),(0,n.jsx)(J,{})]}),(0,n.jsx)(r.Z0O,{variant:"vertical",className:"h-full"}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(r.ua7,{side:"bottom",content:"Global statistics",children:(0,n.jsx)(r.xvT,{size:"12",color:"verySubtle",children:(0,n.jsx)(o.RFr,{})})}),(0,n.jsx)(C,{}),(0,n.jsx)(O,{})]})]}),i&&(0,n.jsx)(r.wFK,{offset:s,limit:e,pageTotal:t,isLoading:"loading"===l})]})}function P(){let{openDialog:e}=(0,a.Rh)();return(0,n.jsx)(w.J,{title:"Files",navTitle:null,routes:i._,sidenav:(0,n.jsx)(l.e,{}),nav:(0,n.jsx)(N,{}),stats:(0,n.jsx)(Y,{}),actions:(0,n.jsx)(F,{}),openSettings:()=>e("settings"),children:(0,n.jsx)("div",{className:"p-6 min-w-fit",children:(0,n.jsx)(g,{})})})}function D(){return(0,n.jsx)(P,{})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=38345)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{10919:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>F});var l=s(6029),n=s(22695),o=s(71518),a=s(4968),i=s(80698);function c(){let{datasetState:e}=(0,o.z)();return"noneOnPage"===e?(0,l.jsx)(n.GB$,{}):"error"===e?(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(n.EYj,{children:(0,l.jsx)(a.YA5,{className:"scale-[200%]"})}),(0,l.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching hosts."})]}):"noneMatchingFilters"===e?(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(n.EYj,{children:(0,l.jsx)(a.oio,{className:"scale-[200%]"})}),(0,l.jsx)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:"No hosts matching filters."})]}):"noneYet"===e?(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(n.EYj,{children:(0,l.jsx)(a.jjT,{className:"scale-[200%]"})}),(0,l.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,l.jsxs)(n.EYj,{color:"subtle",className:"text-center max-w-[500px]",children:["There are currently no hosts in the database. Make sure"," ",(0,l.jsx)(n.CyN,{children:"renterd"})," can access the network and make sure peers are being discovered."]}),(0,l.jsx)(n.z9$,{href:i.J.node.index,children:"View peers"})]})]}):null}var r=s(55729),u=s(29698);let d={activeAndUsable:{colorHex:n.Tj4.green[600],colorName:"green"},activeAndUnusable:{colorHex:n.Tj4.amber[600],colorName:"amber"},potentialHost:{colorHex:n.Tj4.blue[600],colorName:"blue"}};function x(e){return e.activeContractsCount.gt(0)&&!e.isUsable?{status:"activeAndUnusable",...d.activeAndUnusable}:e.activeContractsCount.gt(0)?{status:"activeAndUsable",...d.activeAndUsable}:{status:"potentialHost",...d.potentialHost}}var h=s(8173),p=s(84195),m=s(50934);function f(){let{gpu:e,settings:t}=(0,u.IQ)(),{activeHost:a,onHostMapClick:i,hostsWithLocation:c}=(0,o.z)(),{currency:f,rate:j}=(0,n.sAn)(),[b,v]=(0,r.useState)(null),[g,y]=(0,r.useState)(void 0);return((0,r.useEffect)(()=>{s.e(131).then(s.t.bind(s,53131,19)).then(e=>{y(e.default)})},[]),t.siascan&&!e.shouldRender)?null:(0,l.jsxs)("div",{className:"w-full h-full relative",children:[(0,l.jsxs)(h.ComposableMap,{projectionConfig:{scale:220},style:{width:"100%",height:"100%",top:"10%",position:"relative"},children:[(0,l.jsx)(h.Geographies,{geography:g,children:e=>{let{geographies:t}=e;return t.map(e=>(0,l.jsx)(h.Geography,{geography:e,fill:"#222",stroke:"#444",tabIndex:-1,style:{default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}}},e.rsmKey))}}),null==c?void 0:c.map(e=>{let{colorHex:t}=x(e);return(0,l.jsx)(h.Marker,{coordinates:[e.location.longitude,e.location.latitude],children:(0,l.jsx)(n.m_M,{content:function(e){let{host:t,currency:s,rate:l}=e,n=t.v2Settings.prices.storagePrice,o=l?"".concat(null==s?void 0:s.prefix).concat(new m.A(n||0).times((0,p.xK)(1)).times((0,p.rl)(1)).div(1e24).times(l).toFixed(2),"/TB"):"".concat((0,p.Uj)(new m.A(n||0).times((0,p.xK)(1)).times((0,p.rl)(1)),{fixed:0}),"/TB"),a="".concat((0,p.p6)(t.activeContracts.reduce((e,t)=>e.plus(t.size),new m.A(0)).toNumber())," utilized"),i=(0,p.g9)(t.v2Settings.remainingStorage),c=(0,p.g9)(t.v2Settings.totalStorage),r="".concat((0,p.p6)(i||0)," / ").concat((0,p.p6)(c||0)," available"),u=t.location.countryCode?(0,p.y$)(t.location.countryCode):"\uD83C\uDF0D";return"".concat(u," \xb7 ").concat(o," \xb7 ").concat(a," \xb7 ").concat(r)}({host:e,currency:f,rate:j}),open:(null==b?void 0:b.publicKey)===e.publicKey,onOpenChange:t=>v(t?e:null),children:(0,l.jsx)("circle",{r:(null==a?void 0:a.publicKey)===e.publicKey?12:5,fill:t,stroke:"#fff",strokeWidth:(null==a?void 0:a.publicKey)===e.publicKey?4:1,className:"cursor-pointer transition-all duration-150",onClick:()=>i(e.publicKey,[e.location.latitude,e.location.longitude]),onMouseEnter:()=>v(e),onMouseLeave:()=>v(null)})})},e.publicKey)})]}),(0,l.jsxs)("div",{className:"absolute top-5 left-6 flex flex-col gap-1",children:[(0,l.jsx)(n.P1Q,{color:d.activeAndUsable.colorHex,label:"Active contract & usable",size:"12"}),(0,l.jsx)(n.P1Q,{color:d.activeAndUnusable.colorHex,label:"Active contract & unusable",size:"12"}),(0,l.jsx)(n.P1Q,{color:d.potentialHost.colorHex,label:"No active contract",size:"12"})]})]})}var j=s(28811);function b(){let{datasetPage:e,activeHost:t,visibleColumns:s,limit:a,datasetState:i,tableContext:r,viewMode:u}=(0,o.z)();return(0,l.jsxs)("div",{className:"relative flex flex-col overflow-hidden h-full w-full",children:[(0,l.jsx)("div",{className:(0,j.cx)("absolute h-[50%] w-full","map"===u?"block":"invisible","transition-all"),children:(0,l.jsx)(f,{})}),(0,l.jsx)("div",{className:(0,j.cx)("absolute overflow-hidden transition-all w-full","duration-300","overflow-hidden"),style:{bottom:0,height:"map"===u?e&&e.length?"calc(50% - ".concat(Math.max((2-e.length)*100,0),"px)"):"50%":"100%"},children:(0,l.jsx)(n.FKN,{className:"z-0",id:"scroll-hosts",children:(0,l.jsx)("div",{className:(0,j.cx)("map"===u?"pb-6 px-6":"p-6","min-w-fit"),children:(0,l.jsx)(n.XIK,{testId:"hostsTable",focusId:null==t?void 0:t.publicKey,focusColor:t?x(t).colorName:void 0,isLoading:"loading"===i,emptyState:(0,l.jsx)(c,{}),context:r,pageSize:a,data:e,columns:s,rowSize:"default"})})})})]})}var v=s(20820),g=s(18449),y=s(30947);function k(){let{configurableColumns:e,toggleColumnVisibility:t,setColumnsVisible:s,setColumnsHidden:i,resetDefaultColumnVisibility:c,visibleColumnIds:r}=(0,o.z)(),u=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),d=e.filter(e=>"autopilot"===e.category).map(e=>({label:e.label,value:e.id})),x=e.filter(e=>"settings"===e.category).map(e=>({label:e.label,value:e.id}));return(0,l.jsxs)(n.AMh,{trigger:(0,l.jsxs)(n.$nd,{tip:"Configure view",tipAlign:"end",children:[(0,l.jsx)(a.s7Y,{}),"View",(0,l.jsx)(a.NNJ,{})]}),contentProps:{align:"end",className:"!max-w-md !h-[400px]"},children:[(0,l.jsxs)(n.iy7,{children:[(0,l.jsx)(n.JU7,{children:"Display properties"}),(0,l.jsx)(n.DF3,{children:(0,l.jsx)(n.$nd,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),c()},children:(0,l.jsx)(a.ZxO,{})})})]}),(0,l.jsx)(n.IJR,{label:"General",columns:u.map(e=>e.value),enabled:r,setColumnsVisible:s,setColumnsHidden:i}),(0,l.jsx)(n.iy7,{children:(0,l.jsx)(n.PSc,{options:u,values:r,onChange:e=>t(e)})}),d.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.IJR,{label:"Autopilot",columns:d.map(e=>e.value),enabled:r,setColumnsVisible:s,setColumnsHidden:i}),(0,l.jsx)(n.iy7,{children:(0,l.jsx)(n.PSc,{options:d,values:r,onChange:e=>t(e)})})]}):null,x.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.IJR,{label:"Settings (RHPv4)",columns:x.map(e=>e.value),enabled:r,setColumnsVisible:s,setColumnsHidden:i}),(0,l.jsx)(n.iy7,{children:(0,l.jsx)(n.PSc,{options:x,values:r,onChange:e=>t(e)})})]}):null]})}function C(){let{openDialog:e}=(0,g.sp)(),{viewMode:t,setViewMode:s}=(0,o.z)(),{daemonExplorer:i,settings:c,gpu:r}=(0,u.IQ)();return(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(n.$nd,{onClick:()=>e("hostsManageAllowBlock"),tip:"Manage host blocklist and allowlist",children:[(0,l.jsx)(a.puB,{}),"Manage lists"]}),(0,l.jsx)(n.m_M,{content:c.siascan?r.canGpuRender&&r.isGpuEnabled?"Toggle interactive map":"Enable GPU to view interactive map":"Configure an explorer to view interactive map",children:(0,l.jsx)(n.$nd,{disabled:!r.canGpuRender,onClick:()=>{if(!i.enabled)return void(0,n.el3)({title:"Explorer not configured",body:"Configure an explorer in the startup configuration to enable the interactive map."});r.isGpuEnabled?s("map"===t?"list":"map"):e("settings")},children:(0,l.jsx)(a.m8f,{})})}),(0,l.jsx)(k,{})]})}var w=s(53185),N=s(944);function A(){let{filters:e,removeFilter:t,removeLastFilter:s}=(0,o.z)(),[i,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(""),[x,h]=(0,r.useState)([]),p=x[x.length-1],m=(0,r.useRef)(null),f=(0,r.useRef)(null),j=(0,r.useCallback)(e=>{h(t=>[...t,e])},[h]),b=(0,r.useCallback)(()=>{h([])},[h]);(0,r.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&c(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let v=(0,r.useCallback)(()=>{var e;null==(e=f.current)||e.focus()},[f]),g=(0,r.useCallback)(()=>{d(""),b()},[b]);return(0,l.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,l.jsxs)(n.tWD,{children:[(0,l.jsx)(n.$nd,{variant:"active",state:"waiting",children:e.label}),(0,l.jsx)(n.$nd,{variant:"active",size:"small",onClick:()=>t(e.id),children:(0,l.jsx)(a.sn9,{})})]},e.id)),(0,l.jsxs)(w.uB,{ref:m,label:"Command Menu",onFocus:()=>c(!0),onKeyDown:e=>{if(x.length>0)"Escape"!==e.key&&("Backspace"!==e.key||u)||(e.preventDefault(),h(e=>e.slice(0,-1)));else if(0===x.length&&("Backspace"!==e.key||u||s(),"Escape"===e.key&&!u)){var t;c(!1),null==(t=f.current)||t.blur()}},children:[(0,l.jsx)(w.uB.Input,{"aria-label":"filter hosts",name:"filter-hosts-menu-input",ref:f,value:u,onValueChange:d,className:(0,n.uS8)({variant:"ghost",focus:"none"}),placeholder:"Filter hosts"}),i&&(0,l.jsx)(n.Zkm,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,l.jsxs)(n.FKN,{children:[p&&(0,l.jsx)(n.JU7,{className:"px-1.5 py-1",children:p.label}),(0,l.jsx)(w.uB.List,{children:(0,l.jsx)(N.y,{currentPage:p,beforeSelect:v,afterSelect:g,pushPage:j})})]})})]})]})}function z(){let{offset:e,limit:t,datasetPageTotal:s,datasetState:a}=(0,o.z)();return(0,l.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,l.jsx)(A,{}),(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsx)(n.q6Y,{offset:e,limit:t,pageTotal:s,isLoading:"loading"===a})]})}var S=s(56523);function E(){let e=(0,S.CU)(),{multiSelect:t}=(0,o.z)(),s=(0,r.useMemo)(()=>Object.entries(t.selection).map(e=>{let[t,s]=e;return s.publicKey}),[t.selection]),i=(0,r.useCallback)(async()=>{await (0,n.qBJ)(s.map(t=>e.post({params:{hostkey:t}})),{toastError:e=>{let{successCount:t,errorCount:s,totalCount:l}=e;return{title:"Reset lost sector count for ".concat((0,p.td)(t,"host")),body:"Error reseting lost sector count for ".concat(s,"/").concat(l," total hosts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"Reset lost sector count for ".concat((0,p.td)(t,"host"))}},after:()=>{t.deselectAll()}})},[t,s,e]);return(0,l.jsx)(n.$nd,{"aria-label":"reset lost sector count for hosts",tip:"Reset lost sector count for hosts",onClick:i,children:(0,l.jsx)(a.wJw,{})})}var R=s(52969);function K(e){let{multiSelect:t,hostAddresses:s}=e,{openConfirmDialog:o}=(0,g.sp)(),i=(0,R.U)(),c=(0,r.useCallback)(async()=>{i(s,[]),t.deselectAll()},[i,t,s]);return(0,l.jsxs)(n.$nd,{"aria-label":"add host addresses to blocklist",tip:"Add host addresses to blocklist",onClick:()=>{o({title:"Add ".concat((0,p.td)(t.selectionCount,"host")," to blocklist"),action:"Add to blocklist",variant:"red",body:(0,l.jsx)("div",{className:"flex flex-col gap-1",children:(0,l.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to add"," ",(0,p.td)(t.selectionCount,"host address","host addresses")," ","to the blocklist?"]})}),onConfirm:c})},children:[(0,l.jsx)(a.puB,{}),"Add hosts to blocklist"]})}function M(){let{multiSelect:e}=(0,o.z)(),t=(0,r.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,s]=e;return s.address}),[e.selection]);return(0,l.jsx)(K,{multiSelect:e,hostAddresses:t})}var P=s(64844);function B(){let{multiSelect:e}=(0,o.z)(),t=(0,r.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,s]=e;return s.publicKey}),[e.selection]);return(0,l.jsx)(P.b,{multiSelect:e,publicKeys:t})}function U(e){let{multiSelect:t,hostAddresses:s}=e,{openConfirmDialog:o}=(0,g.sp)(),i=(0,R.U)(),c=(0,r.useCallback)(async()=>{i([],s),t.deselectAll()},[i,t,s]);return(0,l.jsxs)(n.$nd,{"aria-label":"remove host addresses from blocklist",tip:"Remove host addresses from blocklist",onClick:()=>{o({title:"Remove ".concat((0,p.td)(t.selectionCount,"host")," from blocklist"),action:"Remove from blocklist",variant:"red",body:(0,l.jsx)("div",{className:"flex flex-col gap-1",children:(0,l.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to remove"," ",(0,p.td)(t.selectionCount,"host address","host addresses")," ","from the blocklist?"]})}),onConfirm:c})},children:[(0,l.jsx)(a.puB,{}),"Remove hosts from blocklist"]})}function H(){let{multiSelect:e}=(0,o.z)(),t=(0,r.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,s]=e;return s.address}),[e.selection]);return(0,l.jsx)(U,{multiSelect:e,hostAddresses:t})}var $=s(43083);function _(){let{multiSelect:e}=(0,o.z)(),t=(0,r.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,s]=e;return s.publicKey}),[e.selection]);return(0,l.jsx)($.I,{multiSelect:e,publicKeys:t})}var T=s(98497);function I(){let{multiSelect:e}=(0,o.z)(),t=(0,r.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,s]=e;return s.publicKey}),[e.selection]);return(0,l.jsx)(T.s,{multiSelect:e,publicKeys:t})}function L(){let{multiSelect:e}=(0,o.z)();return(0,l.jsxs)(n.ptQ,{multiSelect:e,entityWord:"host",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)(B,{}),(0,l.jsx)(M,{})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)(_,{}),(0,l.jsx)(H,{})]}),(0,l.jsx)(I,{}),(0,l.jsx)(E,{})]})}function F(){return(0,l.jsx)(b,{})}F.Layout=y.C,F.useLayoutProps=function(){let{openDialog:e}=(0,g.sp)();return{title:"Hosts",routes:i.J,sidenav:(0,l.jsx)(v.T,{}),openSettings:()=>e("settings"),size:"full",actions:(0,l.jsx)(C,{}),stats:(0,l.jsx)(z,{}),scroll:!1,dockedControls:(0,l.jsx)(L,{})}}},42040:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/hosts",function(){return s(10919)}])},43083:(e,t,s)=>{"use strict";s.d(t,{I:()=>u});var l=s(6029),n=s(22695),o=s(4968),a=s(55729),i=s(18449),c=s(84195),r=s(5265);function u(e){let{multiSelect:t,publicKeys:s}=e,{openConfirmDialog:u}=(0,i.sp)(),d=(0,r.k)(),x=(0,a.useCallback)(async()=>{await d([],s),t.deselectAll()},[d,t,s]);return(0,l.jsxs)(n.$nd,{"aria-label":"remove host public keys from allowlist",tip:"Remove host public keys from allowlist",onClick:()=>{u({title:"Remove ".concat((0,c.td)(t.selectionCount,"host")," from allowlist"),action:"Remove from allowlist",variant:"accent",body:(0,l.jsx)("div",{className:"flex flex-col gap-1",children:(0,l.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to remove"," ",(0,c.td)(t.selectionCount,"host public key")," from the allowlist?"]})}),onConfirm:x})},children:[(0,l.jsx)(o.puB,{}),"Remove hosts from allowlist"]})}},64844:(e,t,s)=>{"use strict";s.d(t,{b:()=>u});var l=s(6029),n=s(22695),o=s(4968),a=s(55729),i=s(18449),c=s(84195),r=s(5265);function u(e){let{multiSelect:t,publicKeys:s}=e,{openConfirmDialog:u}=(0,i.sp)(),d=(0,r.k)(),x=(0,a.useCallback)(async()=>{d(s,[]),t.deselectAll()},[d,t,s]);return(0,l.jsxs)(n.$nd,{"aria-label":"add host public keys to allowlist",tip:"Add host public keys to allowlist",onClick:()=>{u({title:"Add ".concat((0,c.td)(t.selectionCount,"host")," to allowlist"),action:"Add to allowlist",variant:"accent",body:(0,l.jsx)("div",{className:"flex flex-col gap-1",children:(0,l.jsxs)(n.fzL,{size:"14",children:["Are you sure you would like to add"," ",(0,c.td)(t.selectionCount,"host public key")," to the allowlist?"]})}),onConfirm:x})},children:[(0,l.jsx)(o.puB,{}),"Add hosts to allowlist"]})}},98497:(e,t,s)=>{"use strict";s.d(t,{s:()=>r});var l=s(6029),n=s(22695),o=s(4968),a=s(56523),i=s(55729),c=s(84195);function r(e){let{multiSelect:t,publicKeys:s}=e,r=(0,a.FF)(),u=(0,i.useCallback)(async()=>{await (0,n.qBJ)(s.map(e=>r.post({params:{hostkey:e},payload:{timeout:(0,c.DM)(30)}})),{toastError:e=>{let{successCount:t,errorCount:s,totalCount:l}=e;return{title:"Rescanning ".concat((0,c.td)(t,"host")),body:"Error starting rescan for ".concat(s,"/").concat(l," of total hosts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"Rescanning ".concat((0,c.td)(t,"host"))}},after:()=>{t.deselectAll()}})},[t,s,r]);return(0,l.jsx)(n.$nd,{"aria-label":"rescan selected hosts",tip:"Rescan selected hosts",onClick:u,children:(0,l.jsx)(o.PcB,{})})}}},e=>{e.O(0,[634,636,593,792],()=>e(e.s=42040)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{77441:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contracts",function(){return l(98346)}])},53305:function(e,t,l){"use strict";l.d(t,{a:function(){return u}});var s=l(52322),n=l(12498),a=l(28420),c=l(2784),i=l(82285),r=l(60470),o=l(12295);function u(e){let{multiSelect:t,publicKeys:l}=e,{openConfirmDialog:u}=(0,i.Rh)(),d=(0,o.I)(),x=(0,c.useCallback)(async()=>{d(l,[]),t.deselectAll()},[d,t,l]);return(0,s.jsxs)(n.zxk,{"aria-label":"add host public keys to allowlist",tip:"Add host public keys to allowlist",onClick:()=>{u({title:"Add ".concat((0,r._6)(t.selectionCount,"host")," to allowlist"),action:"Add to allowlist",variant:"accent",body:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsxs)(n.nvN,{size:"14",children:["Are you sure you would like to add"," ",(0,r._6)(t.selectionCount,"host public key")," to the allowlist?"]})}),onConfirm:x})},children:[(0,s.jsx)(a.nCM,{}),"Add hosts to allowlist"]})}},1884:function(e,t,l){"use strict";l.d(t,{U:function(){return u}});var s=l(52322),n=l(12498),a=l(28420),c=l(2784),i=l(82285),r=l(60470),o=l(12295);function u(e){let{multiSelect:t,publicKeys:l}=e,{openConfirmDialog:u}=(0,i.Rh)(),d=(0,o.I)(),x=(0,c.useCallback)(async()=>{await d([],l),t.deselectAll()},[d,t,l]);return(0,s.jsxs)(n.zxk,{"aria-label":"remove host public keys from allowlist",tip:"Remove host public keys from allowlist",onClick:()=>{u({title:"Remove ".concat((0,r._6)(t.selectionCount,"host")," from allowlist"),action:"Remove from allowlist",variant:"accent",body:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsxs)(n.nvN,{size:"14",children:["Are you sure you would like to remove"," ",(0,r._6)(t.selectionCount,"host public key")," from the allowlist?"]})}),onConfirm:x})},children:[(0,s.jsx)(a.nCM,{}),"Remove hosts from allowlist"]})}},50039:function(e,t,l){"use strict";l.d(t,{c:function(){return o}});var s=l(52322),n=l(12498),a=l(28420),c=l(96250),i=l(2784),r=l(60470);function o(e){let{multiSelect:t,publicKeys:l}=e,o=(0,c.ED)(),u=(0,i.useCallback)(async()=>{await (0,n.eKZ)(l.map(e=>o.post({params:{hostkey:e},payload:{timeout:(0,r.XB)(30)}})),{toastError:e=>{let{successCount:t,errorCount:l,totalCount:s}=e;return{title:"Rescanning ".concat((0,r._6)(t,"host")),body:"Error starting rescan for ".concat(l,"/").concat(s," of total hosts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"Rescanning ".concat((0,r._6)(t,"host"))}},after:()=>{t.deselectAll()}})},[t,l,o]);return(0,s.jsx)(n.zxk,{"aria-label":"rescan selected hosts",tip:"Rescan selected hosts",onClick:u,children:(0,s.jsx)(a._Eq,{})})}},98346:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return M}});var s=l(52322),n=l(12498),a=l(74282),c=l(28420);function i(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.xvT,{children:(0,s.jsx)(c.Hb6,{className:"scale-[200%]"})}),(0,s.jsx)(n.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No active contracts matching filters."})]})}function r(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.xvT,{children:(0,s.jsx)(c.VBo,{className:"scale-[200%]"})}),(0,s.jsx)(n.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"There are currently no active contracts. Configure autopilot or manually form contracts to get started."})]})}function o(e){let{error:t}=e;return(null==t?void 0:t.message.startsWith("404"))?(0,s.jsx)(r,{}):(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.xvT,{children:(0,s.jsx)(c.Ckx,{className:"scale-[200%]"})}),(0,s.jsx)(n.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching contracts."})]})}var u=l(82851);function d(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(n.xvT,{children:(0,s.jsx)(c.uTh,{className:"scale-[200%]"})}),(0,s.jsx)(n.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No data available."})]})}function x(){let{selectedContract:e,allContractsSpendingMetrics:t,selectedContractSpendingMetrics:l,graphMode:c,setGraphMode:i}=(0,a.G)(),r=(0,s.jsxs)("div",{className:"flex gap-2",children:[!e&&(0,s.jsx)(n.zxk,{variant:"spending"===c?"accent":"gray",onClick:()=>i("spending"),children:"Funding & spending: All contracts"}),e&&(0,s.jsxs)(n.zxk,{variant:"spending"===c?"accent":"gray",onClick:()=>i("spending"),children:["Funding & spending: Contract"," ",(0,n.I13)(e.id).slice(0,6)]})]});return(0,s.jsxs)("div",{className:"w-full h-full",children:["spending"===c&&!e&&(0,s.jsx)(n.b0u,{id:"renterd/v0/contracts/graphs/fundingAndSpending",height:"100%",data:t.data,config:t.config,isLoading:t.isLoading,actionsLeft:r,emptyState:(0,s.jsx)(d,{})}),"spending"===c&&e&&(0,s.jsx)(n.b0u,{id:"renterd/v0/contracts/graphs/fundingAndSpending",height:"100%",data:l.data,config:l.config,isLoading:l.isLoading,actionsLeft:r,emptyState:(0,s.jsx)(d,{})})]})}function h(){let{visibleColumns:e,datasetPage:t,sortField:l,sortDirection:c,sortableColumns:d,toggleSort:h,limit:j,datasetState:f,cellContext:m,error:p,viewMode:g,filters:v,selectedContract:b}=(0,a.G)(),y="detail"===g&&(!v.length||b),k=y?t&&t.length?"".concat(400-Math.max((2-t.length)*100,0),"px"):"400px":"100%";return(0,s.jsxs)("div",{className:"relative flex flex-col overflow-hidden h-full w-full",children:[(0,s.jsx)("div",{className:(0,u.cx)("absolute w-full",y?"block":"invisible","transition-all","p-6"),style:{height:y?"calc(100% - ".concat(k,")"):0},children:y?(0,s.jsx)(x,{}):null}),(0,s.jsx)("div",{className:(0,u.cx)("absolute overflow-hidden transition-all w-full","duration-300","overflow-hidden"),style:{bottom:0,height:k},children:(0,s.jsx)(n.xrM,{className:"z-0",children:(0,s.jsx)("div",{className:(0,u.cx)(y?"pb-6 px-6":"p-6","min-w-fit"),children:(0,s.jsx)(n.iA_,{testId:"contractsTable",context:m,isLoading:"loading"===f,emptyState:(0,s.jsx)(n.ubH,{datasetState:f,noneMatching:(0,s.jsx)(i,{}),noneYet:(0,s.jsx)(r,{}),error:(0,s.jsx)(o,{error:p})}),sortableColumns:d,pageSize:j,data:t,columns:e,sortDirection:c,sortField:l,toggleSort:h,rowSize:"default"})})})})]})}var j=l(70825),f=l(4300),m=l(82285),p=l(94763),g=l(46850),v=l(83894);function b(){let{configurableColumns:e,toggleColumnVisibility:t,resetDefaultColumnVisibility:l,setColumnsVisible:i,setColumnsHidden:r,sortField:o,setSortField:u,sortDirection:d,setSortDirection:x,visibleColumnIds:h}=(0,a.G)(),j=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),f=e.filter(e=>"time"===e.category).map(e=>({label:e.label,value:e.id})),m=e.filter(e=>"financial"===e.category).map(e=>({label:e.label,value:e.id}));return(0,s.jsxs)(n.J2e,{trigger:(0,s.jsxs)(n.zxk,{"aria-label":"configure view",size:"small",tip:"Configure view",tipAlign:"end",children:[(0,s.jsx)(c.hiv,{}),"View",(0,s.jsx)(c.EMN,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,s.jsxs)(n.WVB,{children:[(0,s.jsx)(n.__J,{children:"Order by"}),(0,s.jsx)(n.kFS,{children:(0,s.jsx)(n.PhF,{value:o,onChange:e=>{u(e.currentTarget.value)},children:Object.entries((0,v.Z)(g.Fo,"category")).map(e=>{let[t,l]=e;return(0,s.jsx)("optgroup",{label:t,children:l.map(e=>(0,s.jsx)(n.Wxm,{value:e.id,children:e.label},e.id))},t)})})})]}),(0,s.jsxs)(n.WVB,{children:[(0,s.jsx)(n.__J,{children:"Direction"}),(0,s.jsx)(n.kFS,{children:(0,s.jsxs)(n.PhF,{value:d,onClick:e=>{e.stopPropagation()},onChange:e=>{x(e.currentTarget.value)},children:[(0,s.jsx)(n.Wxm,{value:"desc",children:"descending"},"desc"),(0,s.jsx)(n.Wxm,{value:"asc",children:"ascending"},"asc")]})})]}),(0,s.jsx)(n.Clw,{}),(0,s.jsxs)(n.WVB,{children:[(0,s.jsx)(n.__J,{children:"Display properties"}),(0,s.jsx)(n.kFS,{children:(0,s.jsx)(n.zxk,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),l()},children:(0,s.jsx)(c.Wet,{})})})]}),(0,s.jsx)(n.FzK,{label:"General",columns:j.map(e=>e.value),enabled:h,setColumnsVisible:i,setColumnsHidden:r}),(0,s.jsx)(n.WVB,{children:(0,s.jsx)(n.j4H,{options:j,values:h,onChange:e=>t(e)})}),(0,s.jsx)(n.FzK,{label:"Time",columns:f.map(e=>e.value),enabled:h,setColumnsVisible:i,setColumnsHidden:r}),(0,s.jsx)(n.WVB,{children:(0,s.jsx)(n.j4H,{options:f,values:h,onChange:e=>t(e)})}),(0,s.jsx)(n.FzK,{label:"Financial",columns:m.map(e=>e.value),enabled:h,setColumnsVisible:i,setColumnsHidden:r}),(0,s.jsx)(n.WVB,{children:(0,s.jsx)(n.j4H,{options:m,values:h,onChange:e=>t(e)})})]})}function y(){let{setViewMode:e}=(0,a.G)();return(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n.zxk,{tip:"Toggle graphs",onClick:()=>e(e=>"detail"===e?"list":"detail"),children:(0,s.jsx)(c.oce,{})}),(0,s.jsx)(b,{})]})}var k=l(65304),C=l(2784),w=l(33889);function N(){let{filters:e,removeFilter:t,removeLastFilter:l}=(0,a.G)(),[i,r]=(0,C.useState)(!1),[o,u]=(0,C.useState)(""),[d,x]=(0,C.useState)([]),h=d[d.length-1],j=(d.length,(0,C.useRef)(null)),f=(0,C.useRef)(null),m=(0,C.useCallback)(e=>{x(t=>[...t,e])},[x]),p=(0,C.useCallback)(()=>{x([])},[x]);(0,C.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&r(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let g=(0,C.useCallback)(()=>{var e;null===(e=f.current)||void 0===e||e.focus()},[f]),v=(0,C.useCallback)(()=>{u(""),p()},[p]);return(0,s.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,s.jsxs)(n.eQh,{children:[(0,s.jsx)(n.zxk,{variant:"active",state:"waiting",children:e.label}),(0,s.jsx)(n.zxk,{variant:"active",size:"small",onClick:()=>t(e.id),children:(0,s.jsx)(c.PcV,{})})]},e.id)),(0,s.jsxs)(k.mY,{ref:j,label:"Command Menu",onFocus:()=>r(!0),onKeyDown:e=>{if(d.length>0)"Escape"!==e.key&&("Backspace"!==e.key||o)||(e.preventDefault(),x(e=>e.slice(0,-1)));else if(0===d.length&&("Backspace"!==e.key||o||l(),"Escape"===e.key&&!o)){var t;r(!1),null===(t=f.current)||void 0===t||t.blur()}},children:[(0,s.jsx)(k.mY.Input,{ref:f,value:o,onValueChange:u,className:(0,n.cEb)({variant:"ghost",focus:"none"}),placeholder:"Filter contracts"}),i&&(0,s.jsx)(n.s_4,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,s.jsxs)(n.xrM,{children:[h&&(0,s.jsx)(n.__J,{className:"px-1.5 py-1",children:h.label}),(0,s.jsx)(k.mY.List,{children:(0,s.jsx)(w.F,{currentPage:h,beforeSelect:g,afterSelect:v,pushPage:m})})]})})]})]})}function _(){let{datasetState:e,offset:t,limit:l,datasetFilteredTotal:c}=(0,a.G)();return(0,s.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,s.jsx)(N,{}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)(n.uDJ,{isLoading:"loading"===e,offset:t,limit:l,total:c})]})}var z=l(96250),S=l(60470);function E(){let{multiSelect:e}=(0,a.G)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.id}),[e.selection]),{openConfirmDialog:l}=(0,m.Rh)(),i=(0,z.IK)(),r=(0,C.useCallback)(async()=>{await (0,n.eKZ)(t.map(e=>i.delete({params:{id:e}})),{toastError:e=>{let{successCount:t,errorCount:l,totalCount:s}=e;return{title:"".concat((0,S._6)(t,"contract")," deleted"),body:"Error deleting ".concat(l,"/").concat(s," total contracts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"".concat((0,S._6)(t,"contract")," deleted")}},after:()=>{e.deselectAll()}})},[e,t,i]);return(0,s.jsx)(n.zxk,{"aria-label":"delete selected contracts",tip:"Delete selected contracts",onClick:()=>{l({title:"Delete contracts",action:"Delete",variant:"red",body:(0,s.jsx)("div",{className:"flex flex-col gap-1",children:(0,s.jsxs)(n.nvN,{size:"14",children:["Are you sure you would like to delete the"," ",(0,S._6)(e.selectionCount,"selected contract"),"?"]})}),onConfirm:async()=>{r()}})},children:(0,s.jsx)(c.Jrl,{})})}var A=l(53305);function T(){let{multiSelect:e}=(0,a.G)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.hostKey}),[e.selection]);return(0,s.jsx)(A.a,{multiSelect:e,publicKeys:t})}var F=l(1884);function R(){let{multiSelect:e}=(0,a.G)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.hostKey}),[e.selection]);return(0,s.jsx)(F.U,{multiSelect:e,publicKeys:t})}var K=l(50039);function L(){let{multiSelect:e}=(0,a.G)(),t=(0,C.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,l]=e;return l.hostKey}),[e.selection]);return(0,s.jsx)(K.c,{multiSelect:e,publicKeys:t})}function V(){let{multiSelect:e}=(0,a.G)();return(0,s.jsxs)(n.hv1,{multiSelect:e,entityWord:"contract",children:[(0,s.jsx)(T,{}),(0,s.jsx)(R,{}),(0,s.jsx)(L,{}),(0,s.jsx)(E,{})]})}let G=p.J;function M(){return(0,s.jsx)(h,{})}M.Layout=G,M.useLayoutProps=function(){let{openDialog:e}=(0,m.Rh)();return{title:"Active contracts",routes:f._,sidenav:(0,s.jsx)(j.e,{}),openSettings:()=>e("settings"),actions:(0,s.jsx)(y,{}),stats:(0,s.jsx)(_,{}),size:"full",scroll:!1,dockedControls:(0,s.jsx)(V,{})}}}},function(e){e.O(0,[191,888,774,179],function(){return e(e.s=77441)}),_N_E=e.O()}]);
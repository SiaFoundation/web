(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{77441:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contracts",function(){return s(65963)}])},65963:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return z}});var l=s(52322),t=s(35105),a=s(60270),i=s(63862);function c(){return(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(t.xvT,{children:(0,l.jsx)(i.Hb6,{className:"scale-[200%]"})}),(0,l.jsx)(t.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No active contracts matching filters."})]})}function r(){return(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(t.xvT,{children:(0,l.jsx)(i.VBo,{className:"scale-[200%]"})}),(0,l.jsx)(t.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"There are currently no active contracts. Configure autopilot or manually form contracts to get started."})]})}function o(e){let{error:n}=e;return(null==n?void 0:n.message.startsWith("404"))?(0,l.jsx)(r,{}):(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(t.xvT,{children:(0,l.jsx)(i.Ckx,{className:"scale-[200%]"})}),(0,l.jsx)(t.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching contracts."})]})}var d=s(82851);function x(){return(0,l.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,l.jsx)(t.xvT,{children:(0,l.jsx)(i.uTh,{className:"scale-[200%]"})}),(0,l.jsx)(t.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No data available."})]})}function u(){let{selectedContract:e,allContractsSpendingMetrics:n,selectedContractSpendingMetrics:s,contractSetCountMetrics:i,graphMode:c,setGraphMode:r}=(0,a.G)(),o=(0,l.jsxs)("div",{className:"flex gap-2",children:[!e&&(0,l.jsx)(t.zxk,{variant:"spending"===c?"accent":"gray",onClick:()=>r("spending"),children:"Funding & spending: All contracts"}),e&&(0,l.jsxs)(t.zxk,{variant:"spending"===c?"accent":"gray",onClick:()=>r("spending"),children:["Funding & spending: Contract"," ",(0,t.I13)(e.id).slice(0,6)]}),!e&&(0,l.jsx)(t.zxk,{variant:"count"===c?"accent":"gray",onClick:()=>r("count"),children:"Count"})]});return(0,l.jsxs)("div",{className:"w-full h-full",children:["spending"===c&&!e&&(0,l.jsx)(t.b0u,{id:"renterd/v0/contracts/graphs/fundingAndSpending",height:"100%",data:n.data,config:n.config,isLoading:n.isLoading,actionsLeft:o,emptyState:(0,l.jsx)(x,{})}),"spending"===c&&e&&(0,l.jsx)(t.b0u,{id:"renterd/v0/contracts/graphs/fundingAndSpending",height:"100%",data:s.data,config:s.config,isLoading:s.isLoading,actionsLeft:o,emptyState:(0,l.jsx)(x,{})}),"count"===c&&!e&&(0,l.jsx)(t.b0u,{id:"renterd/v0/contracts/graphs/count",height:"100%",data:i.data,config:i.config,isLoading:i.isLoading,actionsLeft:o,emptyState:(0,l.jsx)(x,{})})]})}function h(){let{columns:e,datasetPage:n,sortField:s,sortDirection:i,sortableColumns:x,toggleSort:h,limit:g,dataState:j,cellContext:f,error:p,viewMode:m,filters:v,selectedContract:b}=(0,a.G)(),k="detail"===m&&(!v.length||b),N=k?n&&n.length?"".concat(400-Math.max((2-n.length)*100,0),"px"):"400px":"100%";return(0,l.jsxs)("div",{className:"relative flex flex-col overflow-hidden h-full w-full",children:[(0,l.jsx)("div",{className:(0,d.cx)("absolute w-full",k?"block":"invisible","transition-all","p-6"),style:{height:k?"calc(100% - ".concat(N,")"):0},children:k?(0,l.jsx)(u,{}):null}),(0,l.jsx)("div",{className:(0,d.cx)("absolute overflow-hidden transition-all w-full","duration-300","overflow-hidden"),style:{bottom:0,height:N},children:(0,l.jsx)(t.xrM,{className:"z-0",children:(0,l.jsx)("div",{className:(0,d.cx)(k?"pb-6 px-6":"p-6","min-w-fit"),children:(0,l.jsx)(t.iA_,{testId:"contractsTable",context:f,isLoading:"loading"===j,emptyState:"noneMatchingFilters"===j?(0,l.jsx)(c,{}):"noneYet"===j?(0,l.jsx)(r,{}):"error"===j?(0,l.jsx)(o,{error:p}):null,sortableColumns:x,pageSize:g,data:n,columns:e,sortDirection:i,sortField:s,toggleSort:h,focusId:null==b?void 0:b.id,rowSize:"default"})})})})]})}var g=s(70825),j=s(4300),f=s(82285),p=s(6637),m=s(46850),v=s(83894);function b(){let{configurableColumns:e,toggleColumnVisibility:n,resetDefaultColumnVisibility:s,setColumnsVisible:c,setColumnsHidden:r,sortField:o,setSortField:d,sortDirection:x,setSortDirection:u,enabledColumns:h}=(0,a.G)(),g=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),j=e.filter(e=>"time"===e.category).map(e=>({label:e.label,value:e.id})),f=e.filter(e=>"financial"===e.category).map(e=>({label:e.label,value:e.id}));return(0,l.jsxs)(t.J2e,{trigger:(0,l.jsxs)(t.zxk,{"aria-label":"configure view",size:"small",tip:"Configure view",tipAlign:"end",children:[(0,l.jsx)(i.hiv,{}),"View",(0,l.jsx)(i.EMN,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,l.jsxs)(t.WVB,{children:[(0,l.jsx)(t.__J,{children:"Order by"}),(0,l.jsx)(t.kFS,{children:(0,l.jsx)(t.PhF,{value:o,onChange:e=>{d(e.currentTarget.value)},children:Object.entries((0,v.Z)(m.Fo,"category")).map(e=>{let[n,s]=e;return(0,l.jsx)("optgroup",{label:n,children:s.map(e=>(0,l.jsx)(t.Wxm,{value:e.id,children:e.label},e.id))},n)})})})]}),(0,l.jsxs)(t.WVB,{children:[(0,l.jsx)(t.__J,{children:"Direction"}),(0,l.jsx)(t.kFS,{children:(0,l.jsxs)(t.PhF,{value:x,onClick:e=>{e.stopPropagation()},onChange:e=>{u(e.currentTarget.value)},children:[(0,l.jsx)(t.Wxm,{value:"desc",children:"descending"},"desc"),(0,l.jsx)(t.Wxm,{value:"asc",children:"ascending"},"asc")]})})]}),(0,l.jsx)(t.Clw,{}),(0,l.jsxs)(t.WVB,{children:[(0,l.jsx)(t.__J,{children:"Display properties"}),(0,l.jsx)(t.kFS,{children:(0,l.jsx)(t.zxk,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),s()},children:(0,l.jsx)(i.Wet,{})})})]}),(0,l.jsx)(t.FzK,{label:"General",columns:g.map(e=>e.value),enabled:h,setColumnsVisible:c,setColumnsHidden:r}),(0,l.jsx)(t.WVB,{children:(0,l.jsx)(t.j4H,{options:g,values:h,onChange:e=>n(e)})}),(0,l.jsx)(t.FzK,{label:"Time",columns:j.map(e=>e.value),enabled:h,setColumnsVisible:c,setColumnsHidden:r}),(0,l.jsx)(t.WVB,{children:(0,l.jsx)(t.j4H,{options:j,values:h,onChange:e=>n(e)})}),(0,l.jsx)(t.FzK,{label:"Financial",columns:f.map(e=>e.value),enabled:h,setColumnsVisible:c,setColumnsHidden:r}),(0,l.jsx)(t.WVB,{children:(0,l.jsx)(t.j4H,{options:f,values:h,onChange:e=>n(e)})})]})}function k(){let{setViewMode:e}=(0,a.G)();return(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(t.zxk,{tip:"Toggle graphs",onClick:()=>e(e=>"detail"===e?"list":"detail"),children:(0,l.jsx)(i.oce,{})}),(0,l.jsx)(b,{})]})}var N=s(65304),C=s(2784),w=s(61155);function y(){let{filters:e,removeFilter:n,removeLastFilter:s}=(0,a.G)(),[c,r]=(0,C.useState)(!1),[o,d]=(0,C.useState)(""),[x,u]=(0,C.useState)([]),h=x[x.length-1],g=(x.length,(0,C.useRef)(null)),j=(0,C.useRef)(null),f=(0,C.useCallback)(e=>{u(n=>[...n,e])},[u]),p=(0,C.useCallback)(()=>{u([])},[u]);(0,C.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&r(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let m=(0,C.useCallback)(()=>{var e;null===(e=j.current)||void 0===e||e.focus()},[j]),v=(0,C.useCallback)(()=>{d(""),p()},[p]);return(0,l.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,l.jsxs)(t.eQh,{children:[(0,l.jsx)(t.zxk,{variant:"active",state:"waiting",children:e.label}),(0,l.jsx)(t.zxk,{variant:"active",size:"small",onClick:()=>n(e.id),children:(0,l.jsx)(i.PcV,{})})]},e.id)),(0,l.jsxs)(N.mY,{ref:g,label:"Command Menu",onFocus:()=>r(!0),onKeyDown:e=>{if(x.length>0)"Escape"!==e.key&&("Backspace"!==e.key||o)||(e.preventDefault(),u(e=>e.slice(0,-1)));else if(0===x.length&&("Backspace"!==e.key||o||s(),"Escape"===e.key&&!o)){var n;r(!1),null===(n=j.current)||void 0===n||n.blur()}},children:[(0,l.jsx)(N.mY.Input,{ref:j,value:o,onValueChange:d,className:(0,t.cEb)({variant:"ghost",focus:"none"}),placeholder:"Filter contracts"}),c&&(0,l.jsx)(t.s_4,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,l.jsxs)(t.xrM,{children:[h&&(0,l.jsx)(t.__J,{className:"px-1.5 py-1",children:h.label}),(0,l.jsx)(N.mY.List,{children:(0,l.jsx)(w.F,{currentPage:h,beforeSelect:m,afterSelect:v,pushPage:f})})]})})]})]})}function _(){let{dataState:e,offset:n,limit:s,datasetFilteredCount:i,pageCount:c}=(0,a.G)();return(0,l.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,l.jsx)(y,{}),(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsx)(t.uDJ,{isLoading:"loading"===e,offset:n,limit:s,datasetTotal:i,pageTotal:c})]})}let T=p.J;function z(){return(0,l.jsx)(h,{})}z.Layout=T,z.useLayoutProps=function(){let{openDialog:e}=(0,f.Rh)();return{title:"Active contracts",routes:j._,sidenav:(0,l.jsx)(g.e,{}),openSettings:()=>e("settings"),actions:(0,l.jsx)(k,{}),stats:(0,l.jsx)(_,{}),size:"full",scroll:!1}}}},function(e){e.O(0,[158,888,774,179],function(){return e(e.s=77441)}),_N_E=e.O()}]);
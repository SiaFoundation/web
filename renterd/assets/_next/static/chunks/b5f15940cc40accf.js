(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10395,19386,e=>{"use strict";var t=e.i(91398);e.i(86663);var i=e.i(275),s=e.i(15222),a=e.i(50716),l=e.i(24752),r=e.i(65132),n=e.i(83571),o=e.i(91788);let c=["key","secret"],d=[{id:"key",label:"key",category:"general"},{id:"secret",label:"secret",category:"general"}];e.s(["columnsDefaultVisible",0,c,"defaultSortField",0,"key","sortOptions",0,d],19386);var u=e.i(7379),x=e.i(91952),g=e.i(57184),h=e.i(54413),p=e.i(929),j=e.i(67419),y=e.i(8854),m=e.i(50529);e.i(71487);var f=e.i(76993);e.i(86283);var v=e.i(53658);e.i(19513);var k=e.i(22536),b=e.i(84588);function S({s3Key:e,contentProps:i,buttonProps:s}){let{openConfirmDialog:a}=(0,b.useDialog)(),l=(0,v.useSettingsS3)(),r=(0,v.useSettingsS3Update)(),n=(0,o.useCallback)(async()=>{if(!l.data)return void(0,y.triggerErrorToast)({title:"Error deleting key"});let t=(0,k.omit)(l.data?.authentication.v4Keypairs,e),i=await r.put({payload:{...l.data,authentication:{...l.data.authentication,v4Keypairs:t}}});i.error?(0,y.triggerErrorToast)({title:"Error deleting key",body:i.error}):(0,y.triggerSuccessToast)({title:`Key ${e} deleted`})},[l.data,e,r]);return(0,t.jsxs)(g.DropdownMenu,{trigger:(0,t.jsx)(h.Button,{"aria-label":"key context menu",icon:"hover",size:"none",...s,children:(0,t.jsx)(f.CaretDown16,{})}),contentProps:{align:"start",...i,onClick:e=>{e.stopPropagation()}},children:[(0,t.jsx)("div",{className:"px-1.5 py-1",children:(0,t.jsxs)(p.Text,{size:"14",weight:"medium",color:"subtle",children:["Key ",e.slice(0,24),"..."]})}),(0,t.jsx)(g.DropdownMenuLabel,{children:"Actions"}),(0,t.jsxs)(g.DropdownMenuItem,{onSelect:()=>{a({title:`Delete key ${(0,m.truncate)(e,15)}`,action:"Delete",variant:"red",body:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(j.Paragraph,{size:"14",children:"Are you sure you would like to delete the following key?"}),(0,t.jsx)(j.Paragraph,{size:"14",font:"mono",children:(0,m.truncate)(e,80)})]}),onConfirm:async()=>{n()}})},children:[(0,t.jsx)(g.DropdownMenuLeftSlot,{children:(0,t.jsx)(f.Delete16,{})}),"Delete key"]})]})}let C=[{id:"actions",label:"",fixed:!0,contentClassName:"!pl-3 !pr-4",cellClassName:"w-[20px] !pl-0 !pr-0",heading:({context:{multiSelect:e}})=>(0,t.jsx)(u.Checkbox,{onClick:e.onSelectPage,checked:e.isPageAllSelected}),render:({data:{key:e}})=>(0,t.jsx)(S,{s3Key:e})},{id:"key",label:"key",category:"general",render:({data:{key:e}})=>(0,t.jsx)(x.ValueCopyable,{size:"12",value:e,label:"key",maxLength:80})},{id:"secret",label:"secret",contentClassName:"w-[120px]",category:"general",render:({data:{secret:e}})=>(0,t.jsx)(x.ValueCopyable,{size:"12",value:e,label:"key",maxLength:10,font:"mono"})}];var w=e.i(80985);let T=(0,o.createContext)({});function D({children:e}){let u=function(){let{limit:e,offset:t}=(0,n.usePaginationOffset)(50),u=(0,v.useSettingsS3)({config:{swr:{refreshInterval:w.defaultDatasetRefreshInterval}}}),x=(0,o.useMemo)(()=>{if(u.data)return Object.entries(u.data?.authentication.v4Keypairs||{}).map(([e,t])=>({id:e,key:e,secret:t}))},[u.data]),{filters:g,setFilter:h,removeFilter:p,removeLastFilter:j,resetFilters:y}=(0,a.useClientFilters)(),{configurableColumns:m,visibleColumnIds:f,visibleColumns:k,sortableColumns:b,toggleColumnVisibility:S,setColumnsVisible:T,setColumnsHidden:D,toggleSort:P,setSortDirection:N,setSortField:M,sortField:K,sortDirection:L,resetDefaultColumnVisibility:O}=(0,i.useTableState)("renterd/v0/keys",{columns:C,columnsDefaultVisible:c,sortOptions:d,defaultSortField:"key"}),{datasetFiltered:B,datasetPage:E}=(0,l.useClientFilteredDataset)({dataset:x,filters:g,sortField:K,sortDirection:L,offset:t,limit:e}),A=(0,r.useMultiSelect)(E),I=(0,o.useMemo)(()=>{if(E)return E.map(e=>({...e,onClick:t=>A.onSelect(e.id,t),isSelected:!!A.selection[e.id]}))},[E,A]),z=(0,s.useDatasetState)({datasetPage:I,isValidating:u.isValidating,error:u.error,offset:t,filters:g}),R=(0,o.useMemo)(()=>({multiSelect:A}),[A]);return{datasetState:z,limit:e,offset:t,isLoading:u.isLoading,error:u.error,datasetTotal:x?.length||0,datasetFilteredTotal:B?.length||0,datasetPageTotal:I?.length||0,visibleColumns:k,multiSelect:A,cellContext:R,dataset:x,datasetPage:I,configurableColumns:m,visibleColumnIds:f,sortableColumns:b,toggleColumnVisibility:S,setColumnsVisible:T,setColumnsHidden:D,toggleSort:P,setSortDirection:N,setSortField:M,sortField:K,filters:g,setFilter:h,removeFilter:p,removeLastFilter:j,resetFilters:y,sortDirection:L,resetDefaultColumnVisibility:O}}();return(0,t.jsx)(T.Provider,{value:u,children:e})}e.s(["KeysProvider",()=>D,"useKeys",0,()=>(0,o.useContext)(T)],10395)},18290,e=>{"use strict";var t=e.i(91398);e.i(86663);var i=e.i(4885),s=e.i(22494),a=e.i(929);e.i(71487);var l=e.i(76993);function r(){return(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(a.Text,{children:(0,t.jsx)(l.Filter32,{className:"scale-[200%]"})}),(0,t.jsx)(a.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"No keys matching filters."})]})}var n=e.i(54413),o=e.i(14731),c=e.i(84588);function d(){let{openDialog:e}=(0,c.useDialog)();return(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px] cursor-pointer",children:[(0,t.jsx)(a.Text,{children:(0,t.jsx)(o.KeyIcon,{size:64})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,t.jsx)(a.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"There are no S3 authentication keypairs yet. Create one to get started."}),(0,t.jsx)(n.Button,{onClick:()=>{e("keysCreate")},children:"Create keypair"})]})]})}function u(){return(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(a.Text,{children:(0,t.jsx)(l.MisuseOutline32,{className:"scale-[200%]"})}),(0,t.jsx)(a.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching keys."})]})}var x=e.i(10395);function g(){let{visibleColumns:e,datasetPage:a,sortField:l,sortDirection:n,sortableColumns:o,toggleSort:c,limit:g,datasetState:h,cellContext:p}=(0,x.useKeys)();return(0,t.jsx)("div",{className:"p-6 min-w-fit",children:(0,t.jsx)(s.Table,{testId:"keysTable",isLoading:"loading"===h,emptyState:(0,t.jsx)(i.EmptyState,{datasetState:h,noneMatching:(0,t.jsx)(r,{}),noneYet:(0,t.jsx)(d,{}),error:(0,t.jsx)(u,{})}),sortableColumns:o,pageSize:g,data:a,context:p,columns:e,sortDirection:n,sortField:l,toggleSort:c,rowSize:"default"})})}var h=e.i(65667),p=e.i(43652),j=e.i(7357),y=e.i(34666),m=e.i(59651),f=e.i(34530),v=e.i(33124),k=e.i(7880),b=e.i(78114),S=e.i(19386);e.i(19513);var C=e.i(36409);function w(){let{configurableColumns:e,toggleColumnVisibility:i,resetDefaultColumnVisibility:s,setColumnsVisible:a,setColumnsHidden:r,sortField:o,setSortField:c,sortDirection:d,setSortDirection:u,visibleColumnIds:g}=(0,x.useKeys)(),h=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id}));return(0,t.jsxs)(v.Popover,{trigger:(0,t.jsxs)(n.Button,{size:"small",tip:"Configure view",tipAlign:"end",children:[(0,t.jsx)(l.SettingsAdjust16,{}),"View",(0,t.jsx)(l.CaretDown16,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,t.jsxs)(k.BaseMenuItem,{children:[(0,t.jsx)(f.Label,{children:"Order by"}),(0,t.jsx)(k.MenuItemRightSlot,{children:(0,t.jsx)(y.Select,{value:o,onChange:e=>{c(e.currentTarget.value)},children:Object.entries((0,C.groupBy)(S.sortOptions,"category")).map(([e,i])=>(0,t.jsx)("optgroup",{label:e,children:i.map(e=>(0,t.jsx)(y.Option,{value:e.id,children:e.label},e.id))},e))})})]}),(0,t.jsxs)(k.BaseMenuItem,{children:[(0,t.jsx)(f.Label,{children:"Direction"}),(0,t.jsx)(k.MenuItemRightSlot,{children:(0,t.jsxs)(y.Select,{value:d,onClick:e=>{e.stopPropagation()},onChange:e=>{u(e.currentTarget.value)},children:[(0,t.jsx)(y.Option,{value:"desc",children:"descending"},"desc"),(0,t.jsx)(y.Option,{value:"asc",children:"ascending"},"asc")]})})]}),(0,t.jsx)(k.MenuSeparator,{}),(0,t.jsxs)(k.BaseMenuItem,{children:[(0,t.jsx)(f.Label,{children:"Display properties"}),(0,t.jsx)(k.MenuItemRightSlot,{children:(0,t.jsx)(n.Button,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),s()},children:(0,t.jsx)(l.Reset16,{})})})]}),(0,t.jsx)(b.MenuSectionLabelToggleAll,{label:"General",columns:h.map(e=>e.value),enabled:g,setColumnsVisible:a,setColumnsHidden:r}),(0,t.jsx)(k.BaseMenuItem,{children:(0,t.jsx)(m.PoolCombo,{options:h,values:g,onChange:e=>i(e)})})]})}function T(){let{openDialog:e}=(0,c.useDialog)();return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.Button,{onClick:()=>e("keysCreate"),children:[(0,t.jsx)(l.Add16,{}),"Create keypair"]}),(0,t.jsx)(w,{})]})}var D=e.i(20770);function P(){let{limit:e,offset:i,datasetTotal:s,datasetState:a}=(0,x.useKeys)();return(0,t.jsxs)("div",{className:"flex w-full",children:[(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsx)(D.PaginatorKnownTotal,{offset:i,limit:e,total:s,isLoading:"loading"===a})]})}var N=e.i(11895),M=e.i(67419),K=e.i(8854);e.i(86283);var L=e.i(53658),O=e.i(91788),B=e.i(22536);function E(){let{multiSelect:e}=(0,x.useKeys)(),i=(0,O.useMemo)(()=>Object.entries(e.selection).map(([e,t])=>t.key),[e.selection]),{openConfirmDialog:s}=(0,c.useDialog)(),a=(0,L.useSettingsS3)(),r=(0,L.useSettingsS3Update)(),o=(0,O.useCallback)(async()=>{if(!a.data)return void(0,K.triggerErrorToast)({title:"Error deleting key"});let t=(0,B.omit)(a.data?.authentication.v4Keypairs,i),s=await r.put({payload:{...a.data,authentication:{...a.data.authentication,v4Keypairs:t}}});e.deselectAll(),s.error?(0,K.triggerErrorToast)({title:"Error deleting keys",body:s.error}):(0,K.triggerSuccessToast)({title:"Keys deleted"})},[a.data,r,e,i]);return(0,t.jsx)(n.Button,{"aria-label":"delete selected keys",tip:"Delete selected keys",onClick:()=>{s({title:"Delete keys",action:"Delete",variant:"red",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(M.Paragraph,{size:"14",children:["Are you sure you would like to delete the"," ",e.selectionCount.toLocaleString()," selected keys?"]})}),onConfirm:async()=>{o()}})},children:(0,t.jsx)(l.Delete16,{})})}function A(){let{multiSelect:e}=(0,x.useKeys)();return(0,t.jsx)(N.MultiSelectionMenu,{multiSelect:e,entityWord:"key",children:(0,t.jsx)(E,{})})}function I(){return(0,t.jsx)(g,{})}I.Layout=j.RenterdAuthedLayout,I.useLayoutProps=function(){let{openDialog:e}=(0,c.useDialog)();return{title:"Keys",routes:p.routes,sidenav:(0,t.jsx)(h.RenterdSidenav,{}),openSettings:()=>e("settings"),actions:(0,t.jsx)(T,{}),stats:(0,t.jsx)(P,{}),dockedControls:(0,t.jsx)(A,{})}},e.s(["default",()=>I],18290)},58651,(e,t,i)=>{let s="/keys";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(18290)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([s])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/6fa0d1f0c7a6e42e.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/700022329b1c82af.js"].map(t=>e.l(t))).then(()=>t(79466)))},69796,e=>{e.v(t=>Promise.all(["static/chunks/c0a88d8f93bce614.js"].map(t=>e.l(t))).then(()=>t(41159)))}]);
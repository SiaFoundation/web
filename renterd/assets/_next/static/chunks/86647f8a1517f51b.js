(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80046,84985,71664,e=>{"use strict";var t=e.i(91398);e.i(86663);var s=e.i(54413),l=e.i(67419);e.i(71487);var o=e.i(76993),i=e.i(91788),a=e.i(84588);e.i(37869);var n=e.i(93936),r=e.i(26566);function c({multiSelect:e,publicKeys:c}){let{openConfirmDialog:u}=(0,a.useDialog)(),d=(0,r.useAllowlistUpdate)(),h=(0,i.useCallback)(async()=>{d(c,[]),e.deselectAll()},[d,e,c]);return(0,t.jsxs)(s.Button,{"aria-label":"add host public keys to allowlist",tip:"Add host public keys to allowlist",onClick:()=>{u({title:`Add ${(0,n.pluralize)(e.selectionCount,"host")} to allowlist`,action:"Add to allowlist",variant:"accent",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(l.Paragraph,{size:"14",children:["Are you sure you would like to add"," ",(0,n.pluralize)(e.selectionCount,"host public key")," to the allowlist?"]})}),onConfirm:h})},children:[(0,t.jsx)(o.ListChecked16,{}),"Add hosts to allowlist"]})}function u({multiSelect:e,publicKeys:c}){let{openConfirmDialog:u}=(0,a.useDialog)(),d=(0,r.useAllowlistUpdate)(),h=(0,i.useCallback)(async()=>{await d([],c),e.deselectAll()},[d,e,c]);return(0,t.jsxs)(s.Button,{"aria-label":"remove host public keys from allowlist",tip:"Remove host public keys from allowlist",onClick:()=>{u({title:`Remove ${(0,n.pluralize)(e.selectionCount,"host")} from allowlist`,action:"Remove from allowlist",variant:"accent",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(l.Paragraph,{size:"14",children:["Are you sure you would like to remove"," ",(0,n.pluralize)(e.selectionCount,"host public key")," from the allowlist?"]})}),onConfirm:h})},children:[(0,t.jsx)(o.ListChecked16,{}),"Remove hosts from allowlist"]})}e.s(["BulkAddAllowlist",()=>c],80046),e.s(["BulkRemoveAllowlist",()=>u],84985);var d=e.i(46193);e.i(86283);var h=e.i(53658),x=e.i(41399);function p({multiSelect:e,publicKeys:l}){let a=(0,h.useHostScan)(),r=(0,i.useCallback)(async()=>{await (0,d.handleBatchOperation)(l.map(e=>a.post({params:{hostkey:e},payload:{timeout:(0,x.secondsInMilliseconds)(30)}})),{toastError:({successCount:e,errorCount:t,totalCount:s})=>({title:`Rescanning ${(0,n.pluralize)(e,"host")}`,body:`Error starting rescan for ${t}/${s} of total hosts.`}),toastSuccess:({totalCount:e})=>({title:`Rescanning ${(0,n.pluralize)(e,"host")}`}),after:()=>{e.deselectAll()}})},[e,l,a]);return(0,t.jsx)(s.Button,{"aria-label":"rescan selected hosts",tip:"Rescan selected hosts",onClick:r,children:(0,t.jsx)(o.DataView16,{})})}e.s(["BulkRescanHosts",()=>p],71664)},33187,e=>{"use strict";var t=e.i(91398);e.i(86663);var s=e.i(40410),l=e.i(22494),o=e.i(99799),i=e.i(51281),a=e.i(70765),n=e.i(77593),r=e.i(929);e.i(71487);var c=e.i(76993),u=e.i(69055),d=e.i(43652);function h(){let{datasetState:e}=(0,o.useHosts)();return"noneOnPage"===e?(0,t.jsx)(n.StateNoneOnPage,{}):"error"===e?(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(r.Text,{children:(0,t.jsx)(c.MisuseOutline32,{className:"scale-[200%]"})}),(0,t.jsx)(r.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching hosts."})]}):"noneMatchingFilters"===e?(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(r.Text,{children:(0,t.jsx)(c.Filter32,{className:"scale-[200%]"})}),(0,t.jsx)(r.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"No hosts matching filters."})]}):"noneYet"===e?(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(r.Text,{children:(0,t.jsx)(u.HardDriveIcon,{className:"scale-[200%]"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,t.jsxs)(r.Text,{color:"subtle",className:"text-center max-w-[500px]",children:["There are currently no hosts in the database. Make sure"," ",(0,t.jsx)(i.Code,{children:"renterd"})," can access the network and make sure peers are being discovered."]}),(0,t.jsx)(a.LinkButton,{href:d.routes.node.index,children:"View peers"})]})]}):null}var x=e.i(91788);e.i(94066);var p=e.i(82156),m=e.i(26413),b=e.i(26069),f=e.i(86807);let j={activeAndUsable:{colorHex:f.colors.green[600],colorName:"green"},activeAndUnusable:{colorHex:f.colors.amber[600],colorName:"amber"},potentialHost:{colorHex:f.colors.blue[600],colorName:"blue"}};function v(e){return e.activeContractsCount.gt(0)&&!e.isUsable?{status:"activeAndUnusable",...j.activeAndUnusable}:e.activeContractsCount.gt(0)?{status:"activeAndUsable",...j.activeAndUsable}:{status:"potentialHost",...j.potentialHost}}var g=e.i(38041);e.i(37869);var k=e.i(8358),y=e.i(28787),C=e.i(59999),w=e.i(56115),A=e.i(35251),B=e.i(95976),N=e.i(63761),S=e.i(38499);function H(){let{gpu:s,settings:l}=(0,p.useAppSettings)(),{activeHost:i,onHostMapClick:a,hostsWithLocation:n}=(0,o.useHosts)(),{currency:r,rate:c}=(0,S.useActiveDaemonExplorerExchangeRate)(),[u,d]=(0,x.useState)(null),[h,f]=(0,x.useState)(void 0);return((0,x.useEffect)(()=>{e.A(91803).then(e=>{f(e.default)})},[]),l.siascan&&!s.shouldRender)?null:(0,t.jsxs)("div",{className:"w-full h-full relative",children:[(0,t.jsxs)(g.ComposableMap,{projectionConfig:{scale:220},style:{width:"100%",height:"100%",top:"10%",position:"relative"},children:[(0,t.jsx)(g.Geographies,{geography:h,children:({geographies:e})=>e.map(e=>(0,t.jsx)(g.Geography,{geography:e,fill:"#222",stroke:"#444",tabIndex:-1,style:{default:{outline:"none"},hover:{outline:"none"},pressed:{outline:"none"}}},e.rsmKey))}),n?.map(e=>{let{colorHex:s}=v(e);return(0,t.jsx)(g.Marker,{coordinates:[e.location.longitude,e.location.latitude],children:(0,t.jsx)(b.Tooltip,{content:function({host:e,currency:t,rate:s}){let l=e.v2Settings.prices.storagePrice,o=s?`${t?.prefix}${new N.default(l||0).times((0,y.TBToBytes)(1)).times((0,k.monthsToBlocks)(1)).div(1e24).times(s).toFixed(2)}/TB`:`${(0,w.humanSiacoin)(new N.default(l||0).times((0,y.TBToBytes)(1)).times((0,k.monthsToBlocks)(1)),{fixed:0})}/TB`,i=`${(0,C.humanBytes)(e.activeContracts.reduce((e,t)=>e.plus(t.size),new N.default(0)).toNumber())} utilized`,a=(0,A.sectorsToBytes)(e.v2Settings.remainingStorage),n=(0,A.sectorsToBytes)(e.v2Settings.totalStorage),r=`${(0,C.humanBytes)(a||0)} / ${(0,C.humanBytes)(n||0)} available`,c=e.location.countryCode?(0,B.countryCodeEmoji)(e.location.countryCode):"ðŸŒ";return`${c} \xb7 ${o} \xb7 ${i} \xb7 ${r}`}({host:e,currency:r,rate:c}),open:u?.publicKey===e.publicKey,onOpenChange:t=>d(t?e:null),children:(0,t.jsx)("circle",{r:i?.publicKey===e.publicKey?12:5,fill:s,stroke:"#fff",strokeWidth:i?.publicKey===e.publicKey?4:1,className:"cursor-pointer transition-all duration-150",onClick:()=>a(e.publicKey,[e.location.latitude,e.location.longitude]),onMouseEnter:()=>d(e),onMouseLeave:()=>d(null)})})},e.publicKey)})]}),(0,t.jsxs)("div",{className:"absolute top-5 left-6 flex flex-col gap-1",children:[(0,t.jsx)(m.DataLabel,{color:j.activeAndUsable.colorHex,label:"Active contract & usable",size:"12"}),(0,t.jsx)(m.DataLabel,{color:j.activeAndUnusable.colorHex,label:"Active contract & unusable",size:"12"}),(0,t.jsx)(m.DataLabel,{color:j.potentialHost.colorHex,label:"No active contract",size:"12"})]})]})}var T=e.i(48684);function R(){let{datasetPage:e,activeHost:i,visibleColumns:a,limit:n,datasetState:r,tableContext:c,viewMode:u}=(0,o.useHosts)();return(0,t.jsxs)("div",{className:"relative flex flex-col overflow-hidden h-full w-full",children:[(0,t.jsx)("div",{className:(0,T.cx)("absolute h-[50%] w-full","map"===u?"block":"invisible","transition-all"),children:(0,t.jsx)(H,{})}),(0,t.jsx)("div",{className:(0,T.cx)("absolute overflow-hidden transition-all w-full","duration-300","overflow-hidden"),style:{bottom:0,height:"map"===u?e&&e.length?`calc(50% - ${Math.max((2-e.length)*100,0)}px)`:"50%":"100%"},children:(0,t.jsx)(s.ScrollArea,{className:"z-0",id:"scroll-hosts",children:(0,t.jsx)("div",{className:(0,T.cx)("map"===u?"pb-6 px-6":"p-6","min-w-fit"),children:(0,t.jsx)(l.Table,{testId:"hostsTable",focusId:i?.publicKey,focusColor:i?v(i).colorName:void 0,isLoading:"loading"===r,emptyState:(0,t.jsx)(h,{}),context:c,pageSize:n,data:e,columns:a,rowSize:"default"})})})})]})}var M=e.i(65667),P=e.i(84588),z=e.i(7357),E=e.i(54413),L=e.i(8854),$=e.i(59651),K=e.i(33124),U=e.i(7880),D=e.i(34530),O=e.i(78114);function I(){let{configurableColumns:e,toggleColumnVisibility:s,setColumnsVisible:l,setColumnsHidden:i,resetDefaultColumnVisibility:a,visibleColumnIds:n}=(0,o.useHosts)(),r=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),u=e.filter(e=>"autopilot"===e.category).map(e=>({label:e.label,value:e.id})),d=e.filter(e=>"settings"===e.category).map(e=>({label:e.label,value:e.id}));return(0,t.jsxs)(K.Popover,{trigger:(0,t.jsxs)(E.Button,{tip:"Configure view",tipAlign:"end",children:[(0,t.jsx)(c.SettingsAdjust16,{}),"View",(0,t.jsx)(c.CaretDown16,{})]}),contentProps:{align:"end",className:"!max-w-md !h-[400px]"},children:[(0,t.jsxs)(U.BaseMenuItem,{children:[(0,t.jsx)(D.Label,{children:"Display properties"}),(0,t.jsx)(U.MenuItemRightSlot,{children:(0,t.jsx)(E.Button,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),a()},children:(0,t.jsx)(c.Reset16,{})})})]}),(0,t.jsx)(O.MenuSectionLabelToggleAll,{label:"General",columns:r.map(e=>e.value),enabled:n,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(U.BaseMenuItem,{children:(0,t.jsx)($.PoolCombo,{options:r,values:n,onChange:e=>s(e)})}),u.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.MenuSectionLabelToggleAll,{label:"Autopilot",columns:u.map(e=>e.value),enabled:n,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(U.BaseMenuItem,{children:(0,t.jsx)($.PoolCombo,{options:u,values:n,onChange:e=>s(e)})})]}):null,d.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.MenuSectionLabelToggleAll,{label:"Settings (RHPv4)",columns:d.map(e=>e.value),enabled:n,setColumnsVisible:l,setColumnsHidden:i}),(0,t.jsx)(U.BaseMenuItem,{children:(0,t.jsx)($.PoolCombo,{options:d,values:n,onChange:e=>s(e)})})]}):null]})}function F(){let{openDialog:e}=(0,P.useDialog)(),{viewMode:s,setViewMode:l}=(0,o.useHosts)(),{daemonExplorer:i,settings:a,gpu:n}=(0,p.useAppSettings)();return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(E.Button,{onClick:()=>e("hostsManageAllowBlock"),tip:"Manage host blocklist and allowlist",children:[(0,t.jsx)(c.ListChecked16,{}),"Manage lists"]}),(0,t.jsx)(b.Tooltip,{content:a.siascan?n.canGpuRender&&n.isGpuEnabled?"Toggle interactive map":"Enable GPU to view interactive map":"Configure an explorer to view interactive map",children:(0,t.jsx)(E.Button,{disabled:!n.canGpuRender,onClick:()=>{i.enabled?n.isGpuEnabled?l("map"===s?"list":"map"):e("settings"):(0,L.triggerErrorToast)({title:"Explorer not configured",body:"Configure an explorer in the startup configuration to enable the interactive map."})},children:(0,t.jsx)(c.Earth16,{})})}),(0,t.jsx)(I,{})]})}var G=e.i(80332),_=e.i(77786),V=e.i(41490),X=e.i(21324),W=e.i(10483),Y=e.i(22470);function q(){let{filters:e,removeFilter:l,removeLastFilter:i}=(0,o.useHosts)(),[a,n]=(0,x.useState)(!1),[r,u]=(0,x.useState)(""),[d,h]=(0,x.useState)([]),p=d[d.length-1],m=(0,x.useRef)(null),b=(0,x.useRef)(null),f=(0,x.useCallback)(e=>{h(t=>[...t,e])},[h]),j=(0,x.useCallback)(()=>{h([])},[h]);(0,x.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&n(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let v=(0,x.useCallback)(()=>{b.current?.focus()},[b]),g=(0,x.useCallback)(()=>{u(""),j()},[j]);return(0,t.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,t.jsxs)(X.ControlGroup,{children:[(0,t.jsx)(E.Button,{variant:"active",state:"waiting",children:e.label}),(0,t.jsx)(E.Button,{variant:"active",size:"small",onClick:()=>l(e.id),children:(0,t.jsx)(c.Close16,{})})]},e.id)),(0,t.jsxs)(W.Command,{ref:m,label:"Command Menu",onFocus:()=>n(!0),onKeyDown:e=>{d.length>0?"Escape"!==e.key&&("Backspace"!==e.key||r)||(e.preventDefault(),h(e=>e.slice(0,-1))):0===d.length&&("Backspace"!==e.key||r||i(),"Escape"!==e.key||r||(n(!1),b.current?.blur()))},children:[(0,t.jsx)(W.Command.Input,{"aria-label":"filter hosts",name:"filter-hosts-menu-input",ref:b,value:r,onValueChange:u,className:(0,_.textFieldStyles)({variant:"ghost",focus:"none"}),placeholder:"Filter hosts"}),a&&(0,t.jsx)(V.Panel,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,t.jsxs)(s.ScrollArea,{children:[p&&(0,t.jsx)(D.Label,{className:"px-1.5 py-1",children:p.label}),(0,t.jsx)(W.Command.List,{children:(0,t.jsx)(Y.HostsFilterCmd,{currentPage:p,beforeSelect:v,afterSelect:g,pushPage:f})})]})})]})]})}function J(){let{offset:e,limit:s,datasetPageTotal:l,datasetState:i}=(0,o.useHosts)();return(0,t.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,t.jsx)(q,{}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsx)(G.PaginatorUnknownTotal,{offset:e,limit:s,pageTotal:l,isLoading:"loading"===i})]})}var Q=e.i(11895),Z=e.i(46193);e.i(86283);var ee=e.i(53658),et=e.i(93936);function es(){let e=(0,ee.useHostResetLostSectorCount)(),{multiSelect:s}=(0,o.useHosts)(),l=(0,x.useMemo)(()=>Object.entries(s.selection).map(([e,t])=>t.publicKey),[s.selection]),i=(0,x.useCallback)(async()=>{await (0,Z.handleBatchOperation)(l.map(t=>e.post({params:{hostkey:t}})),{toastError:({successCount:e,errorCount:t,totalCount:s})=>({title:`Reset lost sector count for ${(0,et.pluralize)(e,"host")}`,body:`Error reseting lost sector count for ${t}/${s} total hosts.`}),toastSuccess:({totalCount:e})=>({title:`Reset lost sector count for ${(0,et.pluralize)(e,"host")}`}),after:()=>{s.deselectAll()}})},[s,l,e]);return(0,t.jsx)(E.Button,{"aria-label":"reset lost sector count for hosts",tip:"Reset lost sector count for hosts",onClick:i,children:(0,t.jsx)(c.ResetAlt16,{})})}var el=e.i(67419),eo=e.i(83081);function ei({multiSelect:e,hostAddresses:s}){let{openConfirmDialog:l}=(0,P.useDialog)(),o=(0,eo.useBlocklistUpdate)(),i=(0,x.useCallback)(async()=>{o(s,[]),e.deselectAll()},[o,e,s]);return(0,t.jsxs)(E.Button,{"aria-label":"add host addresses to blocklist",tip:"Add host addresses to blocklist",onClick:()=>{l({title:`Add ${(0,et.pluralize)(e.selectionCount,"host")} to blocklist`,action:"Add to blocklist",variant:"red",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(el.Paragraph,{size:"14",children:["Are you sure you would like to add"," ",(0,et.pluralize)(e.selectionCount,"host address","host addresses")," ","to the blocklist?"]})}),onConfirm:i})},children:[(0,t.jsx)(c.ListChecked16,{}),"Add hosts to blocklist"]})}function ea(){let{multiSelect:e}=(0,o.useHosts)(),s=(0,x.useMemo)(()=>Object.entries(e.selection).map(([e,t])=>t.address),[e.selection]);return(0,t.jsx)(ei,{multiSelect:e,hostAddresses:s})}var en=e.i(80046);function er(){let{multiSelect:e}=(0,o.useHosts)(),s=(0,x.useMemo)(()=>Object.entries(e.selection).map(([e,t])=>t.publicKey),[e.selection]);return(0,t.jsx)(en.BulkAddAllowlist,{multiSelect:e,publicKeys:s})}function ec({multiSelect:e,hostAddresses:s}){let{openConfirmDialog:l}=(0,P.useDialog)(),o=(0,eo.useBlocklistUpdate)(),i=(0,x.useCallback)(async()=>{o([],s),e.deselectAll()},[o,e,s]);return(0,t.jsxs)(E.Button,{"aria-label":"remove host addresses from blocklist",tip:"Remove host addresses from blocklist",onClick:()=>{l({title:`Remove ${(0,et.pluralize)(e.selectionCount,"host")} from blocklist`,action:"Remove from blocklist",variant:"red",body:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)(el.Paragraph,{size:"14",children:["Are you sure you would like to remove"," ",(0,et.pluralize)(e.selectionCount,"host address","host addresses")," ","from the blocklist?"]})}),onConfirm:i})},children:[(0,t.jsx)(c.ListChecked16,{}),"Remove hosts from blocklist"]})}function eu(){let{multiSelect:e}=(0,o.useHosts)(),s=(0,x.useMemo)(()=>Object.entries(e.selection).map(([e,t])=>t.address),[e.selection]);return(0,t.jsx)(ec,{multiSelect:e,hostAddresses:s})}var ed=e.i(84985);function eh(){let{multiSelect:e}=(0,o.useHosts)(),s=(0,x.useMemo)(()=>Object.entries(e.selection).map(([e,t])=>t.publicKey),[e.selection]);return(0,t.jsx)(ed.BulkRemoveAllowlist,{multiSelect:e,publicKeys:s})}var ex=e.i(71664);function ep(){let{multiSelect:e}=(0,o.useHosts)(),s=(0,x.useMemo)(()=>Object.entries(e.selection).map(([e,t])=>t.publicKey),[e.selection]);return(0,t.jsx)(ex.BulkRescanHosts,{multiSelect:e,publicKeys:s})}function em(){let{multiSelect:e}=(0,o.useHosts)();return(0,t.jsxs)(Q.MultiSelectionMenu,{multiSelect:e,entityWord:"host",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(er,{}),(0,t.jsx)(ea,{})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(eh,{}),(0,t.jsx)(eu,{})]}),(0,t.jsx)(ep,{}),(0,t.jsx)(es,{})]})}function eb(){return(0,t.jsx)(R,{})}eb.Layout=z.RenterdAuthedLayout,eb.useLayoutProps=function(){let{openDialog:e}=(0,P.useDialog)();return{title:"Hosts",routes:d.routes,sidenav:(0,t.jsx)(M.RenterdSidenav,{}),openSettings:()=>e("settings"),size:"full",actions:(0,t.jsx)(F,{}),stats:(0,t.jsx)(J,{}),scroll:!1,dockedControls:(0,t.jsx)(em,{})}},e.s(["default",()=>eb],33187)},42235,(e,t,s)=>{let l="/hosts";(window.__NEXT_P=window.__NEXT_P||[]).push([l,()=>e.r(33187)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([l])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/54f26a8bf797519f.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/700022329b1c82af.js"].map(t=>e.l(t))).then(()=>t(79466)))},69796,e=>{e.v(t=>Promise.all(["static/chunks/c0a88d8f93bce614.js"].map(t=>e.l(t))).then(()=>t(41159)))},91803,e=>{e.v(t=>Promise.all(["static/chunks/a1943f081b853039.js"].map(t=>e.l(t))).then(()=>t(85462)))}]);
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3084,e=>{"use strict";var t=e.i(91398);e.i(86663);var a=e.i(54413),s=e.i(26069);e.i(71487);var l=e.i(47438),i=e.i(69509),r=e.i(57184),o=e.i(76993);function n(){let{activeExplorerMode:e,setExplorerModeDirectory:s,setExplorerModeFlat:l,isViewingUploads:n,navigateToActiveBucketUploads:d}=(0,i.useFilesManager)();return(0,t.jsxs)(r.DropdownMenu,{trigger:(0,t.jsx)(a.Button,{"aria-label":"change explorer mode",tipSide:"bottom",tip:n?"Viewing uploads":"directory"===e?"Viewing directory explorer":"Viewing all bucket files",children:n?(0,t.jsx)(o.CloudUpload16,{}):"directory"===e?(0,t.jsx)(o.Folder16,{}):(0,t.jsx)(o.Earth16,{})}),contentProps:{align:"start",side:"bottom",className:"max-w-[300px]"},children:[(0,t.jsxs)(r.DropdownMenuItem,{onSelect:s,children:[(0,t.jsx)(r.DropdownMenuLeftSlot,{children:(0,t.jsx)(o.Folder16,{})}),"Directory"]}),(0,t.jsxs)(r.DropdownMenuItem,{onSelect:l,children:[(0,t.jsx)(r.DropdownMenuLeftSlot,{children:(0,t.jsx)(o.Earth16,{})}),"All files"]}),(0,t.jsxs)(r.DropdownMenuItem,{onSelect:d,children:[(0,t.jsx)(r.DropdownMenuLeftSlot,{children:(0,t.jsx)(o.CloudUpload16,{})}),"Uploads"]})]})}function d(){let{isViewingBuckets:e}=(0,i.useFilesManager)();return e?(0,t.jsx)(s.Tooltip,{content:"Viewing all buckets",children:(0,t.jsx)("div",{children:(0,t.jsx)(a.Button,{state:"waiting",children:(0,t.jsx)(l.BucketIcon,{size:16})})})}):(0,t.jsx)(n,{})}e.s(["FilesExplorerModeButton",()=>d],3084)},16290,e=>{"use strict";var t=e.i(91398),a=e.i(91788),s=e.i(69509);e.i(86663);var l=e.i(15222),i=e.i(60662),r=e.i(275);e.i(86283);var o=e.i(53658);let n=["path","status","size","createdAt"],d="path",c=[];var u=e.i(929),x=e.i(91952),p=e.i(73338),h=e.i(38921),m=e.i(83873);e.i(19513);var g=e.i(22522);function j({loaded:e,size:s,status:l}){let i=(0,a.useMemo)(()=>{var t;return void 0!==(t={loaded:e,size:s}).loaded&&t.size?t.loaded/t.size:1},[e,s]);return(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsx)(m.ProgressBar,{variant:"accent",value:e,max:s,className:1===i?"animate-pulse":""}),(0,t.jsxs)("div",{className:"flex gap-2 justify-between",children:[(0,t.jsx)(u.Text,{size:"12",color:"subtle",children:(0,g.upperFirst)(l)}),"uploading to hosts"===l?(0,t.jsx)(h.LoadingDots,{}):(0,t.jsxs)(u.Text,{size:"12",color:"subtle",children:[(100*i).toFixed(0),"%"]})]})]})}e.i(37869);var f=e.i(59999),v=e.i(36183),b=e.i(57184),k=e.i(54413);e.i(71487);var M=e.i(76993);function w({abort:e}){return(0,t.jsxs)(b.DropdownMenu,{trigger:(0,t.jsx)(k.Button,{variant:"ghost",icon:"hover",children:(0,t.jsx)(M.CloudUpload16,{})}),contentProps:{align:"start"},children:[(0,t.jsx)(b.DropdownMenuLabel,{children:"Actions"}),(0,t.jsxs)(b.DropdownMenuItem,{onSelect:e,children:[(0,t.jsx)(b.DropdownMenuLeftSlot,{children:(0,t.jsx)(M.Error16,{})}),"Cancel upload"]})]})}let T=[{id:"actions",label:"",fixed:!0,cellClassName:"w-[50px] !pl-2 !pr-2 [&+*]:!pl-0",render:function({data:{uploadAbort:e}}){return(0,t.jsx)(w,{abort:e})}},{id:"path",label:"path",contentClassName:"max-w-[600px]",category:"general",render:function({data:{path:e,id:a}}){let s=(0,p.getKeyFromPath)(e).slice(1);return(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,t.jsx)(u.Text,{ellipsis:!0,weight:"semibold",size:"14",children:s}),(0,t.jsx)(x.ValueCopyable,{value:a,label:"upload ID",size:"10"})]})}},{id:"status",label:"status",category:"general",contentClassName:"w-[200px]",render:function({data:{loaded:e,size:a,uploadStatus:s,remote:l}}){return l?(0,t.jsx)(u.Text,{size:"12",color:"subtle",children:"Uploading from a different session"}):(0,t.jsx)(j,{loaded:e||0,size:a,status:s})}},{id:"size",label:"size",category:"general",render:function({data:{remote:e,size:a}}){return e?null:(0,t.jsx)(u.Text,{size:"12",color:"subtle",children:(0,f.humanBytes)(a)})}},{id:"createdAt",label:"started at",category:"general",render:function({data:{createdAt:e}}){return(0,t.jsx)(u.Text,{size:"12",color:"subtle",children:e?(0,v.formatRelative)(new Date(e).getTime(),new Date):"-"})}}];e.i(94066);var y=e.i(73799),S=e.i(5024),D=e.i(83571),U=e.i(54759);let N=(0,a.createContext)({});function P({children:e}){let u=function(){let{activeBucket:e}=(0,s.useFilesManager)(),[t,u]=(0,a.useState)("localUploads"),x=(0,U.useResetPagination)(),h=(0,a.useCallback)(e=>{x(),u(e)},[x]),m=function(){var e;let{activeBucket:t}=(0,s.useFilesManager)(),{uploadsMap:u}=(0,S.useUploadsManager)(),{limit:x,marker:h}=(0,i.usePaginationMarker)(50),m=(e=h,(0,a.useMemo)(()=>{if(e){let[t,a]=e.split("<keyMarker>");if(t&&a)return{keyMarker:a,uploadIDMarker:t}}},[e])),g=(0,o.useMultipartUploadAbort)(),j=(0,a.useMemo)(()=>{if(t?.name)return{bucket:t?.name,uploadIDMarker:m?.uploadIDMarker||void 0,keyMarker:m?.keyMarker||void 0,limit:x}},[t,x,m]),f=(0,o.useMultipartUploadListUploads)({disabled:!j,payload:j,config:{swr:{keepPreviousData:!0}}}),v=function({uploadIDMarker:e,keyMarker:t}){return(0,a.useMemo)(()=>e&&t?`${e}<keyMarker>${t}`:null,[e,t])}({uploadIDMarker:f.data?.nextUploadIDMarker||"",keyMarker:f.data?.nextMarker||""}),b=(0,a.useMemo)(()=>{let e=(0,y.maybeFromNullishArrayResponse)(f.data?.uploads);if(e&&t?.name)return e.map(e=>{let a=e.uploadID,s=e.key,l=(0,p.getFilename)(s),i=(0,p.join)(t.name,e.key),r=u[(0,S.getUploadId)(i)];return r||{id:a,path:i,key:s,bucket:t,name:l,size:1,loaded:1,multipartId:e.uploadID,isUploading:!0,uploadStatus:"uploading to hosts",createdAt:e.createdAt,remote:!0,type:"file",uploadAbort:async()=>{await g.post({payload:{bucket:t?.name,key:e.key,uploadID:e.uploadID}})}}})},[u,t,f,g]),k=(0,l.useDatasetState)({datasetPage:b,isValidating:f.isValidating,error:f.error,marker:h}),M=(0,r.useTableState)("renterd/v0/uploads",{columns:T,columnsDefaultVisible:n,sortOptions:c,defaultSortField:d});return{datasetState:k,limit:x,marker:h,nextMarker:v,hasMore:!!f.data?.hasMore,isLoading:f.isLoading,error:f.error,datasetPageTotal:b?.length||0,datasetPage:b,tableState:M}}(),g=function(){let{uploadsList:e}=(0,S.useUploadsManager)(),{limit:t,offset:i}=(0,D.usePaginationOffset)(50),{activeBucket:o}=(0,s.useFilesManager)(),u=(0,a.useMemo)(()=>e.filter(e=>e.bucket.name===o?.name).slice(i,i+t),[e,i,t,o?.name]),x=(0,l.useDatasetState)({datasetPage:u,isValidating:!1,offset:i,error:void 0}),p=(0,r.useTableState)("renterd/v0/uploads",{columns:T,columnsDefaultVisible:n,sortOptions:c,defaultSortField:d});return{datasetState:x,limit:t,offset:i,hasMore:e.length>i+t,isLoading:!1,error:void 0,datasetTotal:e.length,datasetPageTotal:u?.length||0,datasetPage:u,tableState:p}}(),j="localUploads"===t?g.datasetPage:m.datasetPage,f=(0,a.useCallback)(async()=>{if(j&&e?.name)return Promise.all(j.map(e=>e.uploadAbort?.()))},[j,e]);return{activeView:t,setActiveView:h,activeData:"localUploads"===t?g:m,remoteUploads:m,localUploads:g,activeDatasetState:"localUploads"===t?g.datasetState:m.datasetState,activeTableState:"localUploads"===t?g.tableState:m.tableState,abortAll:f}}();return(0,t.jsx)(N.Provider,{value:u,children:e})}e.s(["UploadsProvider",()=>P,"useUploads",0,()=>(0,a.useContext)(N)],16290)},39051,e=>{"use strict";var t=e.i(91398);e.i(86663);var a=e.i(4885),s=e.i(22494),l=e.i(16290),i=e.i(51281),r=e.i(70765),o=e.i(929);e.i(71487);var n=e.i(76993),d=e.i(43652),c=e.i(69509);function u(){let{activeView:e}=(0,l.useUploads)(),{activeBucketName:a}=(0,c.useFilesManager)(),s=a?d.routes.buckets.files.replace("[bucket]",a).replace("[path]",""):d.routes.buckets.index;return(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(o.Text,{children:(0,t.jsx)(n.CloudUpload32,{className:"scale-[200%]"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[(0,t.jsx)(o.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"localUploads"===e?(0,t.jsxs)(t.Fragment,{children:["The ",(0,t.jsx)(i.Code,{children:a})," bucket does not have any active uploads from this session."]}):(0,t.jsxs)(t.Fragment,{children:["The ",(0,t.jsx)(i.Code,{children:a})," bucket does not have any active uploads."]})}),(0,t.jsx)(r.LinkButton,{href:s,onClick:e=>{e.stopPropagation()},children:a?"View files":"View buckets list"})]})]})}function x(){return(0,t.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,t.jsx)(o.Text,{children:(0,t.jsx)(n.MisuseOutline32,{className:"scale-[200%]"})}),(0,t.jsx)(o.Text,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching uploads."})]})}function p(){let{activeData:{datasetPage:e},activeTableState:{visibleColumns:i,sortableColumns:r,toggleSort:o,sortField:n,sortDirection:d},activeDatasetState:c}=(0,l.useUploads)();return(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(s.Table,{testId:"uploadsTable",isLoading:"loading"===c,emptyState:(0,t.jsx)(a.EmptyState,{datasetState:c,noneYet:(0,t.jsx)(u,{}),error:(0,t.jsx)(x,{})}),pageSize:10,data:e,columns:i,sortableColumns:r,sortField:n,sortDirection:d,toggleSort:o,rowSize:"dense"})})}function h(){return(0,t.jsx)("div",{className:"p-6 min-w-fit",children:(0,t.jsx)(p,{})})}var m=e.i(65667),g=e.i(84588),j=e.i(7357),f=e.i(54413),v=e.i(59651),b=e.i(34530),k=e.i(33124),M=e.i(7880);function w(){let{activeTableState:{configurableColumns:e,toggleColumnVisibility:a,resetDefaultColumnVisibility:s,visibleColumnIds:i}}=(0,l.useUploads)();return(0,t.jsxs)(k.Popover,{trigger:(0,t.jsxs)(f.Button,{size:"small",tip:"Configure view",tipAlign:"end",children:[(0,t.jsx)(n.SettingsAdjust16,{}),"View",(0,t.jsx)(n.CaretDown16,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,t.jsxs)(M.BaseMenuItem,{children:[(0,t.jsx)(b.Label,{children:"Display properties"}),(0,t.jsx)(M.MenuItemRightSlot,{children:(0,t.jsx)(f.Button,{onClick:e=>{e.stopPropagation(),s()},children:"Reset default"})})]}),(0,t.jsx)(M.BaseMenuItem,{children:(0,t.jsx)(v.PoolCombo,{options:e.map(e=>({label:e.label,value:e.id})),values:i,onChange:e=>a(e)})})]})}function T(){return(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(w,{})})}var y=e.i(20770),S=e.i(55737);function D(){let{activeData:e,abortAll:a,activeView:s,remoteUploads:i,localUploads:r,setActiveView:o}=(0,l.useUploads)(),n="globalUploads"===s?(0,t.jsx)(S.PaginatorMarker,{marker:i.marker,nextMarker:i.nextMarker,isMore:i.hasMore,limit:i.limit,pageTotal:i.datasetPageTotal,isLoading:"loading"===i.datasetState}):(0,t.jsx)(y.PaginatorKnownTotal,{offset:r.offset,limit:r.limit,total:r.datasetTotal,isLoading:"loading"===r.datasetState});return(0,t.jsxs)("div",{className:"flex gap-3 w-full",children:[(0,t.jsx)(f.Button,{onClick:()=>o("localUploads"),variant:"localUploads"===s?"active":"inactive",children:"Local uploads"}),(0,t.jsx)(f.Button,{onClick:()=>o("globalUploads"),variant:"globalUploads"===s?"active":"inactive",children:"All uploads"}),(0,t.jsx)("div",{className:"flex-1"}),e.datasetPageTotal>0&&(0,t.jsxs)(f.Button,{onClick:a,children:["Abort (",e.datasetPageTotal,")"]}),n]})}var U=e.i(40410),N=e.i(3084);function P(){let{activeBucketName:e,setActiveDirectory:a}=(0,c.useFilesManager)();return(0,t.jsxs)("div",{className:"flex gap-2 items-center h-full",children:[(0,t.jsx)(N.FilesExplorerModeButton,{}),(0,t.jsx)(U.ScrollArea,{children:(0,t.jsxs)("div",{className:"flex gap-1 items-center h-full",children:[(0,t.jsx)(o.Text,{onClick:()=>a(()=>[]),size:"18",weight:"semibold",className:"flex items-center cursor-pointer",noWrap:!0,children:"Buckets"}),(0,t.jsx)(o.Text,{size:"16",color:"verySubtle",className:"flex items-center",children:(0,t.jsx)(n.ChevronRight16,{})}),(0,t.jsx)(o.Text,{onClick:()=>{e&&a(()=>[e])},size:"18",weight:"semibold",className:"flex items-center cursor-pointer",noWrap:!0,children:e}),(0,t.jsx)(o.Text,{size:"16",color:"verySubtle",className:"flex items-center",children:(0,t.jsx)(n.ChevronRight16,{})}),(0,t.jsx)(o.Text,{size:"18",weight:"semibold",className:"flex items-center cursor-pointer",noWrap:!0,children:"Uploads"})]})})]})}function C(){return(0,t.jsx)(h,{})}C.Layout=j.RenterdAuthedLayout,C.useLayoutProps=function(){let{openDialog:e}=(0,g.useDialog)();return{title:"Uploads",navTitle:null,routes:d.routes,sidenav:(0,t.jsx)(m.RenterdSidenav,{}),openSettings:()=>e("settings"),actions:(0,t.jsx)(T,{}),stats:(0,t.jsx)(D,{}),nav:(0,t.jsx)(P,{})}},e.s(["default",()=>C],39051)},83478,(e,t,a)=>{let s="/buckets/[bucket]/uploads";(window.__NEXT_P=window.__NEXT_P||[]).push([s,()=>e.r(39051)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([s])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/54f26a8bf797519f.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/700022329b1c82af.js"].map(t=>e.l(t))).then(()=>t(79466)))},69796,e=>{e.v(t=>Promise.all(["static/chunks/c0a88d8f93bce614.js"].map(t=>e.l(t))).then(()=>t(41159)))}]);
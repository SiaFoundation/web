(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[438],{8292:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/autopilot",function(){return o(9555)}])},362:function(e,t,o){"use strict";o.d(t,{J:function(){return d}});var n=o(2322),s=o(1387),a=o(3621),i=o(6391),r=o.n(i),l=o(4881);function d(e){let t=(0,a.tM)();return(0,n.jsx)(s.tU3,{appName:"renterd",connectivityRoute:l.h,walletBalance:t.data?new(r())(t.data):void 0,...e})}},5755:function(e,t,o){"use strict";o.d(t,{e:function(){return r}});var n=o(2322),s=o(1387),a=o(4881),i=o(3121);function r(){let{autopilotMode:e}=(0,i.K)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.KJW,{title:"Files",route:a._.files.index,children:(0,n.jsx)(s.ROc,{})}),"on"===e&&(0,n.jsx)(s.KJW,{title:"Autopilot",route:a._.autopilot.index,children:(0,n.jsx)(s.aFQ,{})}),(0,n.jsx)(s.KJW,{title:"Contracts",route:a._.contracts.index,children:(0,n.jsx)(s.VBo,{})}),(0,n.jsx)(s.KJW,{title:"Hosts",route:a._.hosts.index,children:(0,n.jsx)(s.VHe,{})}),(0,n.jsx)(s.KJW,{title:"Configuration",route:a._.config.index,children:(0,n.jsx)(s.wWN,{})})]})}},9555:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return v}});var n=o(2322),s=o(1387),a=o(6391),i=o.n(a),r=o(2784),l=o(5755),d=o(4881),u=o(650),c=o(362),m=o(3621),h=o(3397),x=o(2288),w=o(4511);let g=w.Ry().shape({set:w.Z_().required("required"),amount:w.nK().required("required"),allowance:w.nK().required("required"),period:w.nK().required("required"),renewWindow:w.nK().required("required"),download:w.nK().required("required"),upload:w.nK().required("required"),storage:w.Rx().required("required"),allowRedundantIPs:w.Xg().required("required"),maxDowntimeHours:w.Rx().required("required"),defragThreshold:w.Rx().required("required")}),f={set:"",amount:void 0,allowance:void 0,period:void 0,renewWindow:void 0,download:void 0,upload:void 0,storage:void 0,allowRedundantIPs:!1,maxDowntimeHours:void 0,defragThreshold:void 0},p=["targetPrice"];function j(){let{openDialog:e}=(0,u.Rh)(),t=(0,m.oe)(),o=(0,m.e$)({config:{swr:{revalidateOnFocus:!1}}}),a=(0,h.TA)({initialValues:f,validationSchema:g,onSubmit:async e=>{if(o.data)try{await t.put({payload:{contracts:{set:e.set,amount:e.amount.toNumber(),allowance:(0,x.qN)(e.allowance).toString(),period:(0,s.mvJ)(e.period.toNumber()),renewWindow:(0,s.mvJ)(e.renewWindow.toNumber()),download:(0,s.xf5)(e.download).toNumber(),upload:(0,s.xf5)(e.upload).toNumber(),storage:(0,s.xf5)(e.storage).toNumber()},hosts:{maxDowntimeHours:e.maxDowntimeHours.toNumber(),allowRedundantIPs:e.allowRedundantIPs,scoreOverrides:o.data.hosts.scoreOverrides},wallet:{defragThreshold:e.defragThreshold.toNumber()}}}),(0,s.OPV)("Configuration has been saved.")}catch(n){a.setErrors(n)}}}),w=(0,r.useCallback)(()=>{a.resetForm(),o.mutate()},[a,o]);(0,r.useEffect)(()=>{let e=async()=>{var e,t,n,r,l,d,u,c;if(!o.data)return;let m=null===(e=o.data)||void 0===e?void 0:e.contracts.set,h=(0,x.ll)(null===(t=o.data)||void 0===t?void 0:t.contracts.allowance,6),w=new(i())(null===(n=o.data)||void 0===n?void 0:n.contracts.amount),g=new(i())((0,s.x5w)(null===(r=o.data)||void 0===r?void 0:r.contracts.period)),f=new(i())((0,s.x5w)(null===(l=o.data)||void 0===l?void 0:l.contracts.renewWindow)),p=(0,s.JWi)(new(i())(null===(d=o.data)||void 0===d?void 0:d.contracts.download)),j=(0,s.JWi)(new(i())(null===(u=o.data)||void 0===u?void 0:u.contracts.upload)),v=(0,s.JWi)(new(i())(null===(c=o.data)||void 0===c?void 0:c.contracts.storage));try{await a.resetForm({values:{set:m,allowance:h,amount:w,period:g,renewWindow:f,download:p,upload:j,storage:v,allowRedundantIPs:o.data.hosts.allowRedundantIPs,maxDowntimeHours:new(i())(o.data.hosts.maxDowntimeHours),defragThreshold:new(i())(o.data.wallet.defragThreshold)}})}catch(T){console.log(T)}};e()},[o.data]);let j=(0,r.useMemo)(()=>!(!a.values.storage||!a.values.period||!a.values.allowance||a.values.storage.isZero()||a.values.period.isZero()||a.values.allowance.isZero()),[a.values.storage,a.values.period,a.values.allowance]),v=(0,r.useMemo)(()=>{if(!j)return new(i())(0);let{period:e,allowance:t}=a.values,o=t.div(e),n=o.div(7).times(30);return(0,x.IZ)(n,0)},[j,a.values]),{changed:T,changeCount:k}=(0,s.VyY)(a,p),{fiat:y,currency:N}=(0,s.fb0)({sc:v});return(0,n.jsx)(c.J,{title:"Autopilot",routes:d._,sidenav:(0,n.jsx)(l.e,{}),stats:j?(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(s.xvT,{size:"12",font:"mono",weight:"medium",children:"Estimate:"}),(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)(s.YKL,{size:"12",value:(0,x.qN)(v),dynamicUnits:!1,fixed:0,variant:"value"}),y&&(0,n.jsx)("div",{className:"flex",children:(0,n.jsx)(s.m2c,{size:"12",weight:"medium",value:y,color:"subtle",variant:"value",format:e=>"(".concat(N.prefix).concat(e.toFixed(N.fixed),")")})}),(0,n.jsxs)(s.xvT,{size:"12",font:"mono",weight:"medium",children:["per month to store"," ",(0,x.vW)((0,s.xf5)(a.values.storage).toNumber())]})]})]}):(0,n.jsx)(s.xvT,{size:"12",font:"mono",weight:"medium",children:"Enter expected storage, period, and allowance values to estimate monthly spending."}),actions:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!!k&&(0,n.jsx)(s.xvT,{size:"12",color:"subtle",children:1===k?"1 change":"".concat(k," changes")}),(0,n.jsx)(s.zxk,{tip:"Reset all changes",icon:"contrast",disabled:!k,onClick:()=>w(),children:(0,n.jsx)(s.Wet,{})}),(0,n.jsxs)(s.zxk,{tip:"Save all changes",variant:"accent",disabled:!k,onClick:()=>a.submitForm(),children:[(0,n.jsx)(s.ZEk,{}),"Save changes"]})]}),openSettings:()=>e("settings"),children:(0,n.jsxs)("div",{className:"px-5 py-6 flex flex-col gap-16 max-w-screen-xl",children:[(0,n.jsxs)(s.M9k,{title:"Contracts",children:[(0,n.jsx)(s.VXA,{title:"Expected storage",description:(0,n.jsx)(n.Fragment,{children:"The amount of storage you would like to rent in TB."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"storage",units:"TB"})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Expected upload",description:(0,n.jsx)(n.Fragment,{children:"The amount of upload bandwidth you plan to use each period in TB."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"upload",units:"TB"})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Expected download",description:(0,n.jsx)(n.Fragment,{children:"The amount of download bandwidth you plan to use each period in TB."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"download",units:"TB"})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Allowance",description:(0,n.jsx)(n.Fragment,{children:"The amount of Siacoin you would like to spend for the period."}),control:(0,n.jsx)(s.ckm,{formik:a,changed:T,name:"allowance",decimalsLimitSc:6})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Period",description:(0,n.jsx)(n.Fragment,{children:"The length of the storage contracts."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"period",units:"weeks",suggestion:new(i())(6),suggestionTip:"Typically 6 weeks."})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Renew window",description:(0,n.jsx)(n.Fragment,{children:"The number of weeks prior to contract expiration that Sia will attempt to renew your contracts."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"renewWindow",units:"weeks",suggestion:new(i())(2),suggestionTip:"Typically 2 weeks."})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Hosts",description:(0,n.jsx)(n.Fragment,{children:"The number of hosts to create contracts with."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"amount",units:"hosts",suggestion:new(i())(50),suggestionTip:"Typically 50 hosts."})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Contract set",description:(0,n.jsx)(n.Fragment,{children:"The contract set that autopilot should use."}),control:(0,n.jsx)(s.LLj,{formik:a,changed:T,name:"set",placeholder:"autopilot",suggestion:"autopilot",suggestionTip:(0,n.jsxs)(n.Fragment,{children:["The default contract set is ",(0,n.jsx)(s.EKh,{children:"autopilot"}),", only change this if you understand the implications."]})})})]}),(0,n.jsxs)(s.M9k,{title:"Hosts",children:[(0,n.jsx)(s.VXA,{title:"Redundant IPs",description:(0,n.jsx)(n.Fragment,{children:"Whether or not to allow forming contracts with multiple hosts in the same IP subnet. The subnets used are /16 for IPv4, and /64 for IPv6."}),control:(0,n.jsx)(s.hGk,{formik:a,changed:T,name:"allowRedundantIPs",suggestion:!1,suggestionTip:"Defaults to off."})}),(0,n.jsx)(s.Z0O,{className:"w-full my-3"}),(0,n.jsx)(s.VXA,{title:"Max downtime",description:(0,n.jsx)(n.Fragment,{children:"The maximum amount of host downtime that autopilot will tolerate in hours."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"maxDowntimeHours",units:"hours",suggestion:new(i())(1440),suggestionTip:"Defaults to 1,440 which is 60 days."})})]}),(0,n.jsx)(s.M9k,{title:"Wallet",children:(0,n.jsx)(s.VXA,{title:"Defrag threshold",description:(0,n.jsx)(n.Fragment,{children:"The threshold after which autopilot will defrag outputs."}),control:(0,n.jsx)(s.wmY,{formik:a,changed:T,name:"defragThreshold",units:"outputs",suggestion:new(i())(1e3),suggestionTip:"Defaults to 1,000."})})})]})})}function v(){return(0,n.jsx)(j,{})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8292)}),_N_E=e.O()}]);
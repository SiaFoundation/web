(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{57344:function(e,i,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config",function(){return t(69127)}])},95628:function(e,i,t){"use strict";t.d(i,{q:function(){return c}});var r=t(52322),n=t(78604),s=t(13369),a=t(6391),o=t.n(a),d=t(74881);function c(e){let i=(0,s.Os)();return(0,r.jsx)(n.tU3,{appName:"hostd",connectivityRoute:d.h,walletBalance:i.data?new(o())(i.data.spendable):void 0,...e})}},39031:function(e,i,t){"use strict";t.d(i,{N:function(){return a}});var r=t(52322),n=t(78604),s=t(74881);function a(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.KJW,{title:"Dashboard",route:s._.home,children:(0,r.jsx)(n.K2o,{})}),(0,r.jsx)(n.KJW,{title:"Volumes",route:s._.volumes.index,children:(0,r.jsx)(n.zvn,{})}),(0,r.jsx)(n.KJW,{title:"Contracts",route:s._.contracts.index,children:(0,r.jsx)(n.VBo,{})}),(0,r.jsx)(n.KJW,{title:"Configuration",route:s._.config.index,children:(0,r.jsx)(n.wWN,{})})]})}},69127:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return P}});var r=t(52322),n=t(78604),s=t(2784),a=t(39031),o=t(74881),d=t(34679),c=t(95628),l=t(13369),m=t(6391),u=t.n(m);let p=[{value:"",label:"Off"},{value:"route53",label:"Route 53"},{value:"noip",label:"No-IP"},{value:"duckdns",label:"Duck DNS"},{value:"cloudflare",label:"Cloudflare"}],g={acceptingContracts:!1,netAddress:"",maxContractDuration:void 0,contractPrice:void 0,baseRPCPrice:void 0,sectorAccessPrice:void 0,collateral:void 0,maxCollateral:void 0,minStoragePrice:void 0,minEgressPrice:void 0,minIngressPrice:void 0,priceTableValidity:void 0,maxRegistryEntries:void 0,accountExpiry:void 0,maxAccountBalance:void 0,ingressLimit:void 0,egressLimit:void 0,dnsProvider:"",dnsIpv4:!1,dnsIpv6:!1,dnsDuckDnsToken:"",dnsNoIpEmail:"",dnsNoIpPassword:"",dnsAwsId:"",dnsAwsSecret:"",dnsAwsZoneId:"",dnsCloudflareToken:"",dnsCloudflareZoneId:""},v={acceptingContracts:{type:"boolean",category:"host",title:"Accepting contracts",description:(0,r.jsx)(r.Fragment,{children:"Whether or not the host is accepting contracts."}),validation:{required:"required"}},netAddress:{type:"text",category:"host",title:"Address",description:(0,r.jsx)(r.Fragment,{children:"The network address of the host."}),placeholder:"my.host.com:9882",validation:{required:"required"}},maxContractDuration:{type:"number",category:"host",title:"Maximum contract duration",units:"months",decimalsLimit:2,suggestion:new(u())(6),suggestionTip:"The default maximum duration is 6 months.",description:(0,r.jsx)(r.Fragment,{children:"The maximum contract duration that the host will accept."}),validation:{required:"required",validate:{min:e=>new(u())(e).gte((0,n.E6f)(4320))||"must be at least 1 month"}}},minStoragePrice:{title:"Minimum storage price",type:"siacoin",category:"pricing",units:"SC/TB/month",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's minimum storage price in siacoins per TB per month."}),validation:{required:"required"}},minEgressPrice:{title:"Minimum egress price",type:"siacoin",category:"pricing",units:"SC/TB",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's minimum egress price in siacoins per TB."}),validation:{required:"required"}},minIngressPrice:{title:"Minimum ingress price",type:"siacoin",category:"pricing",units:"SC/TB",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's minimum ingress price in siacoins per TB."}),validation:{required:"required"}},collateral:{title:"Collateral",type:"siacoin",category:"pricing",units:"SC/month",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's target collateral in siacoins per month."}),validation:{required:"required"}},maxCollateral:{title:"Maximum collateral",type:"siacoin",category:"pricing",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's maximum collateral in siacoins."}),validation:{required:"required"}},contractPrice:{title:"Contract price",type:"siacoin",category:"pricing",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's contract price in siacoins."}),validation:{required:"required"}},baseRPCPrice:{title:"Base RPC price",type:"siacoin",category:"pricing",units:"SC/million",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's base RPC price in siacoins per million calls."}),validation:{required:"required"}},sectorAccessPrice:{title:"Sector access price",type:"siacoin",category:"pricing",units:"SC/million",decimalsLimitSc:6,description:(0,r.jsx)(r.Fragment,{children:"The host's sector access price in siacoins million sectors."}),validation:{required:"required"}},priceTableValidity:{title:"Price table validity",type:"number",category:"pricing",units:"minutes",description:(0,r.jsx)(r.Fragment,{children:"How long a renter's registered price table remains valid."}),validation:{required:"required"}},maxRegistryEntries:{title:"Maximum registry size",type:"number",category:"registry",units:"entries",decimalsLimit:0,description:(0,r.jsx)(r.Fragment,{children:"The maximum number of registry entries that the host will store. Each registry entry is up to 113 bytes."}),validation:{required:"required"}},accountExpiry:{title:"Expiry",type:"number",category:"RHP3",units:"days",description:(0,r.jsx)(r.Fragment,{children:"How long a renter's ephemeral accounts are inactive before the host prunes them and recovers the remaining funds."}),validation:{required:"required",validate:{min:e=>new(u())(e).gte(7)||"must be at least 1 week"}}},maxAccountBalance:{title:"Maximum balance",type:"siacoin",category:"RHP3",description:(0,r.jsx)(r.Fragment,{children:"Maximum balance a renter's ephemeral account can have. When the limit is reached, deposits are rejected until some of the funds have been spent."}),validation:{required:"required",validate:{min:e=>new(u())(e).gte(1)||"must be at least 1 SC"}}},ingressLimit:{title:"Ingress limit",type:"number",category:"bandwidth",units:"MB/second",description:(0,r.jsx)(r.Fragment,{children:"The maximum amount of ingress bandwidth traffic in MB per second."}),validation:{required:"required"}},egressLimit:{title:"Egress limit",type:"number",category:"bandwidth",units:"MB/second",description:(0,r.jsx)(r.Fragment,{children:"The maximum amount of egress bandwidth traffic in MB per second."}),validation:{required:"required"}},dnsProvider:{title:"Dynamic DNS Provider",type:"select",category:"DNS",options:p,description:(0,r.jsx)(r.Fragment,{children:"Enable dynamic DNS with one of the supported providers."}),validation:{validate:e=>!!p.find(i=>i.value===e)||"must be one of supported providers"}},dnsIpv4:{title:"IPv4",type:"boolean",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"Whether IPv4 is enabled."}),show:e=>!!e.dnsProvider,validation:{validate:(e,i)=>!i.dnsProvider||!!(e||i.dnsIpv6)||"at least one of IPv4 and IPv6 must be enabled"},trigger:["dnsIpv6"]},dnsIpv6:{type:"boolean",title:"IPv6",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"Whether IPv6 is enabled."}),show:e=>!!e.dnsProvider,validation:{validate:(e,i)=>!i.dnsProvider||!!(e||i.dnsIpv4)||"at least one of IPv4 and IPv6 must be enabled"},trigger:["dnsIpv4"]},dnsDuckDnsToken:{type:"text",title:"Token",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"DuckDNS token."}),show:e=>"duckdns"===e.dnsProvider,validation:{validate:(e,i)=>"duckdns"!==i.dnsProvider||!!e||"required"}},dnsNoIpEmail:{type:"text",title:"Email",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"No-IP email."}),show:e=>"noip"===e.dnsProvider,validation:{validate:(e,i)=>"noip"!==i.dnsProvider||!!e||"required"}},dnsNoIpPassword:{type:"text",title:"password",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"No-IP password."}),show:e=>"noip"===e.dnsProvider,validation:{validate:(e,i)=>"noip"!==i.dnsProvider||!!e||"required"}},dnsAwsId:{type:"text",title:"ID",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"AWS Route53 ID."}),show:e=>"route53"===e.dnsProvider,validation:{validate:(e,i)=>"route53"!==i.dnsProvider||!!e||"required"}},dnsAwsSecret:{type:"secret",title:"Secret",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"AWS Route53 secret."}),show:e=>"route53"===e.dnsProvider,validation:{validate:(e,i)=>"route53"!==i.dnsProvider||!!e||"required"}},dnsAwsZoneId:{type:"text",title:"Zone ID",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"AWS Route53 zone ID."}),show:e=>"route53"===e.dnsProvider,validation:{validate:(e,i)=>"route53"!==i.dnsProvider||!!e||"required"}},dnsCloudflareToken:{type:"text",title:"Token",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"Cloudflare token."}),show:e=>"cloudflare"===e.dnsProvider,validation:{validate:(e,i)=>"cloudflare"!==i.dnsProvider||!!e||"required"}},dnsCloudflareZoneId:{type:"text",title:"Zone ID",category:"DNS",description:(0,r.jsx)(r.Fragment,{children:"Cloudflare zone ID."}),show:e=>"cloudflare"===e.dnsProvider,validation:{validate:(e,i)=>"cloudflare"!==i.dnsProvider||!!e||"required"}}};var h=t(2288),x=t(63955);function y(){let{openConfirmDialog:e}=(0,d.Rh)(),i=(0,l.hV)(),t=(0,l.Az)(),a=(0,s.useCallback)(()=>e({title:"Announce",action:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.cfm,{}),"Announce"]}),variant:"accent",body:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(n.nvN,{size:"14",children:"Confirm to broadcast host announcement."}),i.data&&(0,r.jsxs)(n.nvN,{size:"14",children:["Announcing will cost ",(0,h.Vz)(i.data),"."]})]}),onConfirm:async()=>{let e=await t.post({});e.error&&(0,n.OHV)("Error announcing host."),(0,n.OPV)("Successfully broadcast host announcement.")}}),[e,t,i]);return(0,r.jsxs)(n.zxk,{variant:"accent",tip:"Announce host address",onClick:a,children:[(0,r.jsx)(n.cfm,{}),"Announce"]})}function f(){var e;let{openDialog:i}=(0,d.Rh)(),t=(0,l.rV)({config:{swr:{revalidateOnFocus:!1}}}),m=(0,l.Te)(),p=(0,l.go)({disabled:!t.data||!t.data.dynDNS.provider,config:{swr:{revalidateOnFocus:!1,errorRetryCount:0}}}),f=(0,x.cI)({mode:"all",defaultValues:g}),P=(0,s.useCallback)(async e=>{if(t.data)try{var i;let r;let s=await m.post({payload:(i=t.data,r=null,"duckdns"===e.dnsProvider&&(r={token:e.dnsDuckDnsToken}),"noip"===e.dnsProvider&&(r={email:e.dnsNoIpEmail,password:e.dnsNoIpPassword}),"route53"===e.dnsProvider&&(r={ID:e.dnsAwsId,secret:e.dnsAwsSecret,zoneID:e.dnsAwsZoneId}),"cloudflare"===e.dnsProvider&&(r={token:e.dnsCloudflareToken,zoneID:e.dnsCloudflareZoneId}),{...i,acceptingContracts:e.acceptingContracts,netAddress:e.netAddress,maxContractDuration:Number(e.maxContractDuration.times((0,n.S5V)(1)).toFixed(0)),contractPrice:(0,h.qN)(e.contractPrice).toString(),baseRPCPrice:(0,h.qN)(e.baseRPCPrice).div(1e7).toString(),sectorAccessPrice:(0,h.qN)(e.sectorAccessPrice).div(1e7).toString(),collateral:(0,h.qN)(e.collateral.div((0,n.xf5)(1)).div((0,n.S5V)(1))).toString(),maxCollateral:(0,h.qN)(e.maxCollateral).toString(),minStoragePrice:(0,h.qN)(e.minStoragePrice.div((0,n.xf5)(1)).div((0,n.S5V)(1))).toString(),minEgressPrice:(0,h.qN)(e.minEgressPrice.div((0,n.xf5)(1))).toString(),minIngressPrice:(0,h.qN)(e.minIngressPrice.div((0,n.xf5)(1))).toString(),priceTableValidity:Number(e.priceTableValidity.times(60).times(1e9).toFixed(0)),maxRegistryEntries:Number(e.maxRegistryEntries.toFixed(0)),accountExpiry:Number(e.accountExpiry.times(86400).times(1e9).toFixed(0)),maxAccountBalance:(0,h.qN)(e.maxAccountBalance).toString(),ingressLimit:Number((0,n.YaL)(e.ingressLimit).toFixed(0)),egressLimit:Number((0,n.YaL)(e.egressLimit).toFixed(0)),dynDNS:{...null==i?void 0:i.dynDNS,provider:e.dnsProvider,ipv4:e.dnsIpv4,ipv6:e.dnsIpv6,options:r}})});if(s.error)throw Error(s.error);f.formState.dirtyFields.netAddress?(0,n.OPV)("Settings have been saved. Address has changed, make sure to re-announce the host.",{duration:2e4}):(0,n.OPV)("Settings have been saved."),p.mutate()}catch(a){(0,n.OHV)(a.message),console.log(a)}},[f,t,m,p]),S=(0,n.WsO)(v),b=(0,s.useMemo)(()=>f.handleSubmit(P,S),[f,P,S]),w=Object.entries(f.formState.dirtyFields).filter(e=>{let[i,t]=e;return!!t}).length,N=(0,s.useCallback)(()=>{let e;if(!t.data)return;let i=t.data;f.reset((e=null,"duckdns"===i.dynDNS.provider&&(e={dnsDuckDnsToken:i.dynDNS.options.token}),"noip"===i.dynDNS.provider&&(e={dnsNoIpEmail:i.dynDNS.options.email,dnsNoIpPassword:i.dynDNS.options.password}),"route53"===i.dynDNS.provider&&(e={dnsAwsId:i.dynDNS.options.ID,dnsAwsSecret:i.dynDNS.options.secret,dnsAwsZoneId:i.dynDNS.options.zoneID}),"cloudflare"===i.dynDNS.provider&&(e={dnsCloudflareToken:i.dynDNS.options.token,dnsCloudflareZoneId:i.dynDNS.options.zoneID}),{acceptingContracts:i.acceptingContracts,netAddress:i.netAddress,maxContractDuration:new(u())(i.maxContractDuration).div((0,n.S5V)(1)),contractPrice:(0,h.ll)(i.contractPrice,6),baseRPCPrice:(0,h.ll)(new(u())(i.baseRPCPrice).times(1e7),6),sectorAccessPrice:(0,h.ll)(new(u())(i.sectorAccessPrice).times(1e7),6),collateral:(0,h.ll)(new(u())(i.collateral).times((0,n.xf5)(1)).times((0,n.S5V)(1)),6),maxCollateral:(0,h.ll)(i.maxCollateral,6),minStoragePrice:(0,h.ll)(new(u())(i.minStoragePrice).times((0,n.xf5)(1)).times((0,n.S5V)(1)),6),minEgressPrice:(0,h.ll)(new(u())(i.minEgressPrice).times((0,n.xf5)(1)),6),minIngressPrice:(0,h.ll)(new(u())(i.minIngressPrice).times((0,n.xf5)(1)),6),priceTableValidity:new(u())(i.priceTableValidity).div(1e9).div(60),maxRegistryEntries:new(u())(i.maxRegistryEntries),accountExpiry:new(u())(i.accountExpiry).div(1e9).div(86400),maxAccountBalance:(0,h.ll)(i.maxAccountBalance,6),ingressLimit:(0,n.BTR)(new(u())(i.ingressLimit)),egressLimit:(0,n.BTR)(new(u())(i.egressLimit)),dnsProvider:i.dynDNS.provider,dnsIpv4:i.dynDNS.ipv4,dnsIpv6:i.dynDNS.ipv6,...e}))},[f,t]),j=(0,s.useCallback)(async()=>{await t.mutate(),N(),await p.mutate()},[N,t,p]);return(0,s.useEffect)(()=>{N()},[t.data]),(0,r.jsx)(c.q,{title:"Configuration",routes:o._,sidenav:(0,r.jsx)(a.N,{}),stats:(null===(e=t.data)||void 0===e?void 0:e.dynDNS.provider)&&!p.isValidating?p.error?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.xvT,{color:"amber",children:(0,r.jsx)(n.qdM,{})}),(0,r.jsx)(n.xvT,{children:"Error with dynamic DNS configuration"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.xvT,{color:"green",children:(0,r.jsx)(n.Y3p,{})}),(0,r.jsx)(n.xvT,{children:"Dynamic DNS enabled"})]}):null,actions:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[!!w&&(0,r.jsx)(n.xvT,{size:"12",color:"subtle",children:1===w?"1 change":"".concat(w," changes")}),(0,r.jsx)(n.zxk,{tip:"Reset all changes",icon:"contrast",disabled:!w,onClick:j,children:(0,r.jsx)(n.Wet,{})}),(0,r.jsxs)(n.zxk,{tip:"Save all changes",variant:"accent",disabled:!f.formState.isDirty||f.formState.isSubmitting,onClick:b,children:[(0,r.jsx)(n.ZEk,{}),"Save changes"]}),(0,r.jsx)(y,{})]}),openSettings:()=>i("settings"),children:(0,r.jsxs)("div",{className:"p-6 flex flex-col gap-16 max-w-screen-xl",children:[(0,r.jsx)(n.vRO,{title:"Host",category:"host",fields:v,form:f}),(0,r.jsx)(n.vRO,{title:"Pricing",category:"pricing",fields:v,form:f}),(0,r.jsx)(n.vRO,{title:"DNS",category:"DNS",fields:v,form:f}),(0,r.jsx)(n.vRO,{title:"Bandwidth",category:"bandwidth",fields:v,form:f}),(0,r.jsx)(n.vRO,{title:"Registry",category:"registry",fields:v,form:f}),(0,r.jsx)(n.vRO,{title:"Accounts",category:"RHP3",fields:v,form:f})]})})}function P(){return(0,r.jsx)(f,{})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=57344)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{77441:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/contracts",function(){return n(73986)}])},73986:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var s=n(52322),l=n(22203),a=n(65717),r=n(63862);function c(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(l.xvT,{children:(0,s.jsx)(r.Hb6,{className:"scale-[200%]"})}),(0,s.jsx)(l.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"No active contracts matching filters."})]})}function i(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(l.xvT,{children:(0,s.jsx)(r.VBo,{className:"scale-[200%]"})}),(0,s.jsx)(l.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"There are currently no active contracts. Configure and announce host to start forming contracts."})]})}function o(){return(0,s.jsxs)("div",{className:"flex flex-col gap-10 justify-center items-center h-[400px]",children:[(0,s.jsx)(l.xvT,{children:(0,s.jsx)(r.Ckx,{className:"scale-[200%]"})}),(0,s.jsx)(l.xvT,{color:"subtle",className:"text-center max-w-[500px]",children:"Error fetching contracts."})]})}function u(){let{visibleColumns:e,datasetPage:t,sortField:n,sortDirection:r,sortableColumns:u,toggleSort:x,limit:d,datasetState:h,cellContext:j}=(0,a.G)();return(0,s.jsx)("div",{className:"p-6 min-w-fit",children:(0,s.jsx)(l.iA_,{testId:"contractsTable",context:j,isLoading:"loading"===h,emptyState:(0,s.jsx)(l.ubH,{datasetState:h,noneMatching:(0,s.jsx)(c,{}),noneYet:(0,s.jsx)(i,{}),error:(0,s.jsx)(o,{})}),pageSize:d,data:t,columns:e,sortableColumns:u,sortDirection:r,sortField:n,toggleSort:x})})}var x=n(13779),d=n(4300),h=n(7451),j=n(41941),m=n(46850),v=n(83894);function f(){let{configurableColumns:e,toggleColumnVisibility:t,resetDefaultColumnVisibility:n,setColumnsVisible:c,setColumnsHidden:i,sortField:o,setSortField:u,sortDirection:x,setSortDirection:d,visibleColumnIds:h}=(0,a.G)(),j=e.filter(e=>"general"===e.category).map(e=>({label:e.label,value:e.id})),f=e.filter(e=>"time"===e.category).map(e=>({label:e.label,value:e.id})),p=e.filter(e=>"financial"===e.category).map(e=>({label:e.label,value:e.id}));return(0,s.jsxs)(l.J2e,{trigger:(0,s.jsxs)(l.zxk,{"aria-label":"Configure view",size:"small",tip:"Configure view",tipAlign:"end",children:[(0,s.jsx)(r.hiv,{}),"View",(0,s.jsx)(r.EMN,{})]}),contentProps:{align:"end",className:"max-w-[300px]"},children:[(0,s.jsxs)(l.WVB,{children:[(0,s.jsx)(l.__J,{children:"Order by"}),(0,s.jsx)(l.kFS,{children:(0,s.jsx)(l.PhF,{value:o,onChange:e=>{u(e.currentTarget.value)},children:Object.entries((0,v.Z)(m.Fo,"category")).map(e=>{let[t,n]=e;return(0,s.jsx)("optgroup",{label:t,children:n.map(e=>(0,s.jsx)(l.Wxm,{value:e.id,children:e.label},e.id))},t)})})})]}),(0,s.jsxs)(l.WVB,{children:[(0,s.jsx)(l.__J,{children:"Direction"}),(0,s.jsx)(l.kFS,{children:(0,s.jsxs)(l.PhF,{value:x,onClick:e=>{e.stopPropagation()},onChange:e=>{d(e.currentTarget.value)},children:[(0,s.jsx)(l.Wxm,{value:"desc",children:"descending"},"desc"),(0,s.jsx)(l.Wxm,{value:"asc",children:"ascending"},"asc")]})})]}),(0,s.jsx)(l.Clw,{}),(0,s.jsxs)(l.WVB,{children:[(0,s.jsx)(l.__J,{children:"Display properties"}),(0,s.jsx)(l.kFS,{children:(0,s.jsx)(l.zxk,{tip:"Reset all to defaults",variant:"ghost",onClick:e=>{e.stopPropagation(),n()},children:(0,s.jsx)(r.Wet,{})})})]}),(0,s.jsx)(l.FzK,{label:"General",columns:j.map(e=>e.value),enabled:h,setColumnsVisible:c,setColumnsHidden:i}),(0,s.jsx)(l.WVB,{children:(0,s.jsx)(l.j4H,{options:j,values:h,onChange:e=>t(e)})}),(0,s.jsx)(l.FzK,{label:"Time",columns:f.map(e=>e.value),enabled:h,setColumnsVisible:c,setColumnsHidden:i}),(0,s.jsx)(l.WVB,{children:(0,s.jsx)(l.j4H,{options:f,values:h,onChange:e=>t(e)})}),(0,s.jsx)(l.FzK,{label:"Usage",columns:p.map(e=>e.value),enabled:h,setColumnsVisible:c,setColumnsHidden:i}),(0,s.jsx)(l.WVB,{children:(0,s.jsx)(l.j4H,{options:p,values:h,onChange:e=>t(e)})})]})}function p(){return(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(f,{})})}var g=n(65304),b=n(2784),k=n(63328);function C(){let{filters:e,removeFilter:t,removeLastFilter:n}=(0,a.G)(),[c,i]=(0,b.useState)(!1),[o,u]=(0,b.useState)(""),[x,d]=(0,b.useState)([]),h=x[x.length-1],j=(x.length,(0,b.useRef)(null)),m=(0,b.useRef)(null),v=(0,b.useCallback)(e=>{d(t=>[...t,e])},[d]),f=(0,b.useCallback)(()=>{d([])},[d]);(0,b.useEffect)(()=>{let e=e=>{j.current&&!j.current.contains(e.target)&&i(!1)};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}},[]);let p=(0,b.useCallback)(()=>{var e;null===(e=m.current)||void 0===e||e.focus()},[m]),C=(0,b.useCallback)(()=>{u(""),f()},[f]);return(0,s.jsxs)("div",{className:"flex gap-1",children:[e.map(e=>(0,s.jsxs)(l.eQh,{children:[(0,s.jsx)(l.zxk,{variant:"active",state:"waiting",children:(0,l.$Gg)(e.label,30)}),(0,s.jsx)(l.zxk,{variant:"active",size:"small",onClick:()=>t(e.id),children:(0,s.jsx)(r.PcV,{})})]},e.id)),(0,s.jsxs)(g.mY,{ref:j,label:"Command Menu",onFocus:()=>i(!0),onKeyDown:e=>{if(x.length>0)"Escape"!==e.key&&("Backspace"!==e.key||o)||(e.preventDefault(),d(e=>e.slice(0,-1)));else if(0===x.length&&("Backspace"!==e.key||o||n(),"Escape"===e.key&&!o)){var t;i(!1),null===(t=m.current)||void 0===t||t.blur()}},children:[(0,s.jsx)(g.mY.Input,{ref:m,value:o,onValueChange:u,className:(0,l.cEb)({variant:"ghost",focus:"none"}),placeholder:"Filter contracts"}),c&&(0,s.jsx)(l.s_4,{className:"absolute z-20 min-w-[200px] max-h-[400px] overflow-auto p-1",children:(0,s.jsxs)(l.xrM,{children:[h&&(0,s.jsx)(l.__J,{className:"px-1.5 py-1",children:h.label}),(0,s.jsx)(g.mY.List,{children:(0,s.jsx)(k.F,{currentPage:h,beforeSelect:p,afterSelect:C,pushPage:v})})]})})]})]})}function y(){let{offset:e,limit:t,datasetFilteredTotal:n,datasetState:r,versionMode:c,setVersionMode:i}=(0,a.G)();return(0,s.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,s.jsx)("div",{children:(0,s.jsxs)(l.h_2,{contentProps:{side:"bottom",align:"start"},trigger:(0,s.jsx)(l.zxk,{"aria-label":"contracts version mode",tip:"v2"===c?"Currently viewing v2 contracts":"Currently viewing v1 contracts",variant:"active",children:"v2"===c?"v2":"v1"}),children:[(0,s.jsx)(l.Xiv,{onSelect:()=>i("v2"),children:"View v2 contracts"}),(0,s.jsx)(l.Xiv,{onSelect:()=>i("v1"),children:"View v1 contracts"})]})}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(C,{})}),(0,s.jsx)(l.uDJ,{offset:e,limit:t,isLoading:"loading"===r,total:n})]})}var _=n(60470),w=n(63694);function N(){let{multiSelect:e}=(0,a.G)(),t=(0,w.kr)(),n=(0,b.useMemo)(()=>Object.entries(e.selection).map(e=>{let[t,n]=e;return n.id}),[e.selection]),c=(0,b.useCallback)(async()=>{await (0,l.eKZ)(n.map(e=>t.put({params:{id:e}})),{toastError:e=>{let{successCount:t,errorCount:n,totalCount:s}=e;return{title:"Integrity checks started for ".concat((0,_._6)(t,"contract")),body:"Error starting integrity checks for ".concat(n,"/").concat(s," total contracts.")}},toastSuccess:e=>{let{totalCount:t}=e;return{title:"Integrity checks started for ".concat((0,_._6)(t,"contract")),body:(0,s.jsxs)(s.Fragment,{children:["Depending on contract data size this operation can take a while. Check ",(0,s.jsx)(l.EKh,{children:"hostd"})," ",(0,s.jsx)(l.rUS,{href:d._.alerts.index,children:"alerts"})," for status updates."]})}},after:()=>{e.deselectAll()}})},[e,n,t]);return(0,s.jsx)(l.zxk,{"aria-label":"run integrity check for each contract",tip:"Run integrity check for each contract",onClick:c,children:(0,s.jsx)(r.dDl,{})})}function S(){let{multiSelect:e}=(0,a.G)();return(0,s.jsx)(l.hv1,{multiSelect:e,entityWord:"contract",children:(0,s.jsx)(N,{})})}let E=j.q;function z(){return(0,s.jsx)(u,{})}z.Layout=E,z.useLayoutProps=function(){let{openDialog:e}=(0,h.Rh)();return{title:"Contracts",routes:d._,sidenav:(0,s.jsx)(x.N,{}),openSettings:()=>e("settings"),actions:(0,s.jsx)(p,{}),stats:(0,s.jsx)(y,{}),size:"full",dockedControls:(0,s.jsx)(S,{})}}}},function(e){e.O(0,[546,888,774,179],function(){return e(e.s=77441)}),_N_E=e.O()}]);
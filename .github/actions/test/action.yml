name: Test

description: Test

inputs:
  github_token:
    description: GitHub token
    required: true
  content:
    description: Content directory path
    required: true

runs:
  using: composite

  steps:
    - name: Commit lint
      shell: bash
      run: npx commitlint
    - name: Workspace lint
      shell: bash
      run: npx nx workspace-lint
    - name: Lint
      shell: bash
      run: npx nx affected --target=lint --parallel=5
    - name: Build
      shell: bash
      run: npx nx affected --target=build --parallel=5
      env:
        GITHUB_TOKEN: ${{ inputs.GITHUB_TOKEN }}
        CONTENT: ${{ github.workspace }}/content/example
    - name: Test
      shell: bash
      run: npx nx affected --target=test --parallel=5

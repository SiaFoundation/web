name: Test

description: Test

inputs:
  github_token:
    description: GitHub token
    required: true

runs:
  using: composite

  steps:
    - name: Commit lint
      shell: bash
      run: npx commitlint --from=last-release
    - name: Workspace lint
      shell: bash
      run: npx nx workspace-lint
    - name: Lint
      shell: bash
      run: npx nx affected --target=lint --base=last-release --parallel=5
    - name: Build
      shell: bash
      run: npx nx affected --target=build --base=last-release --parallel=5
      env:
        GITHUB_TOKEN: ${{ inputs.GITHUB_TOKEN }}
    - name: Test
      shell: bash
      run: npx nx affected --target=test --base=last-release --parallel=5
